<!doctype html>
<html class="">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
		<meta name="description" content="Weâ€™re on a journey to advance and democratize artificial intelligence through open source and open science." />
		<meta property="fb:app_id" content="1321688464574422" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:site" content="@huggingface" />
		<meta name="twitter:image" content="https://cdn-thumbnails.huggingface.co/social-thumbnails/datasets/huggingface-course/codeparrot-ds-valid.png" />
		<meta property="og:title" content="huggingface-course/codeparrot-ds-valid Â· Datasets at Hugging Face" />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://huggingface.co/datasets/huggingface-course/codeparrot-ds-valid" />
		<meta property="og:image" content="https://cdn-thumbnails.huggingface.co/social-thumbnails/datasets/huggingface-course/codeparrot-ds-valid.png" />

		<link rel="stylesheet" href="/front/build/kube-68d7aa0/style.css" />

		<link rel="preconnect" href="https://fonts.gstatic.com" />
		<link
			href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&display=swap"
			rel="stylesheet"
		/>

		<link
			rel="preload"
			href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css"
			as="style"
			onload="this.onload=null;this.rel='stylesheet'"
		/>
		<noscript>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" />
		</noscript>

		<script>const guestTheme = document.cookie.match(/theme=(\w+)/)?.[1]; document.documentElement.classList.toggle('dark', guestTheme === 'dark' || ( (!guestTheme || guestTheme === 'system') && window.matchMedia('(prefers-color-scheme: dark)').matches));</script>
<link rel="canonical" href="https://huggingface.co/datasets/huggingface-course/codeparrot-ds-valid"> <script type="application/ld+json">{
  "@context": {
    "@language": "en",
    "@vocab": "https:\/\/schema.org\/",
    "citeAs": "cr:citeAs",
    "column": "cr:column",
    "conformsTo": "dct:conformsTo",
    "cr": "http:\/\/mlcommons.org\/croissant\/",
    "data": {
      "@id": "cr:data",
      "@type": "@json"
    },
    "dataBiases": "cr:dataBiases",
    "dataCollection": "cr:dataCollection",
    "dataType": {
      "@id": "cr:dataType",
      "@type": "@vocab"
    },
    "dct": "http:\/\/purl.org\/dc\/terms\/",
    "extract": "cr:extract",
    "field": "cr:field",
    "fileProperty": "cr:fileProperty",
    "fileObject": "cr:fileObject",
    "fileSet": "cr:fileSet",
    "format": "cr:format",
    "includes": "cr:includes",
    "isLiveDataset": "cr:isLiveDataset",
    "jsonPath": "cr:jsonPath",
    "key": "cr:key",
    "md5": "cr:md5",
    "parentField": "cr:parentField",
    "path": "cr:path",
    "personalSensitiveInformation": "cr:personalSensitiveInformation",
    "recordSet": "cr:recordSet",
    "references": "cr:references",
    "regex": "cr:regex",
    "repeated": "cr:repeated",
    "replace": "cr:replace",
    "sc": "https:\/\/schema.org\/",
    "separator": "cr:separator",
    "source": "cr:source",
    "subField": "cr:subField",
    "transform": "cr:transform"
  },
  "@type": "sc:Dataset",
  "distribution": [
    {
      "@type": "cr:FileObject",
      "@id": "repo",
      "name": "repo",
      "description": "The Hugging Face git repository.",
      "contentUrl": "https:\/\/huggingface.co\/datasets\/huggingface-course\/codeparrot-ds-valid\/tree\/refs%2Fconvert%2Fparquet",
      "encodingFormat": "git+https",
      "sha256": "https:\/\/github.com\/mlcommons\/croissant\/issues\/80"
    },
    {
      "@type": "cr:FileSet",
      "@id": "parquet-files-for-config-default",
      "name": "parquet-files-for-config-default",
      "description": "The underlying Parquet files as converted by Hugging Face (see: https:\/\/huggingface.co\/docs\/dataset-viewer\/parquet).",
      "containedIn": {
        "@id": "repo"
      },
      "encodingFormat": "application\/x-parquet",
      "includes": "default\/*\/*.parquet"
    }
  ],
  "recordSet": [
    {
      "@type": "cr:RecordSet",
      "dataType": "cr:Split",
      "key": {
        "@id": "default_splits\/split_name"
      },
      "@id": "default_splits",
      "name": "default_splits",
      "description": "Splits for the default config.",
      "field": [
        {
          "@type": "cr:Field",
          "@id": "default_splits\/split_name",
          "name": "split_name",
          "description": "The name of the split.",
          "dataType": "sc:Text"
        }
      ],
      "data": [
        {
          "default_splits\/split_name": "validation"
        }
      ]
    },
    {
      "@type": "cr:RecordSet",
      "@id": "default",
      "name": "default",
      "description": "huggingface-course\/codeparrot-ds-valid - 'default' subset",
      "field": [
        {
          "@type": "cr:Field",
          "@id": "default\/split",
          "name": "default\/split",
          "description": "Split to which the example belongs to.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "fileProperty": "fullpath"
            },
            "transform": {
              "regex": "default\/(?:partial-)?(validation)\/.+parquet$"
            }
          },
          "references": {
            "field": {
              "@id": "default_splits\/split_name"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/repo_name",
          "name": "default\/repo_name",
          "description": "Column 'repo_name' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "repo_name"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/path",
          "name": "default\/path",
          "description": "Column 'path' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "path"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/copies",
          "name": "default\/copies",
          "description": "Column 'copies' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "copies"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/size",
          "name": "default\/size",
          "description": "Column 'size' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "size"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/content",
          "name": "default\/content",
          "description": "Column 'content' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "content"
            }
          }
        },
        {
          "@type": "cr:Field",
          "@id": "default\/license",
          "name": "default\/license",
          "description": "Column 'license' from the Hugging Face parquet file.",
          "dataType": "sc:Text",
          "source": {
            "fileSet": {
              "@id": "parquet-files-for-config-default"
            },
            "extract": {
              "column": "license"
            }
          }
        }
      ]
    }
  ],
  "conformsTo": "http:\/\/mlcommons.org\/croissant\/1.0",
  "name": "codeparrot-ds-valid",
  "description": "huggingface-course\/codeparrot-ds-valid dataset hosted on Hugging Face and contributed by the HF Datasets community",
  "alternateName": [
    "huggingface-course\/codeparrot-ds-valid"
  ],
  "creator": {
    "@type": "Organization",
    "name": "Hugging Face Course",
    "url": "https:\/\/huggingface.co\/huggingface-course"
  },
  "keywords": [
    "1K - 10K",
    "json",
    "Text",
    "Datasets",
    "pandas",
    "Croissant",
    "Polars",
    "ðŸ‡ºðŸ‡¸ Region: US"
  ],
  "url": "https:\/\/huggingface.co\/datasets\/huggingface-course\/codeparrot-ds-valid"
}</script> 

		<title>huggingface-course/codeparrot-ds-valid Â· Datasets at Hugging Face</title>

		<script
			defer
			data-domain="huggingface.co"
			event-loggedIn="false"
			src="/js/script.pageview-props.js"
		></script>
		<script>
			window.plausible =
				window.plausible ||
				function () {
					(window.plausible.q = window.plausible.q || []).push(arguments);
				};
		</script>
		<script>
			window.hubConfig = {"features":{"signupDisabled":false},"sshGitUrl":"git@hf.co","moonHttpUrl":"https:\/\/huggingface.co","captchaApiKey":"bd5f2066-93dc-4bdd-a64b-a24646ca3859","captchaDisabledOnSignup":true,"datasetViewerPublicUrl":"https:\/\/datasets-server.huggingface.co","stripePublicKey":"pk_live_x2tdjFXBCvXo2FFmMybezpeM00J6gPCAAc","environment":"production","userAgent":"HuggingFace (production)","spacesIframeDomain":"hf.space","spacesApiUrl":"https:\/\/api.hf.space","docSearchKey":"ece5e02e57300e17d152c08056145326e90c4bff3dd07d7d1ae40cf1c8d39cb6","logoDev":{"apiUrl":"https:\/\/img.logo.dev\/","apiKey":"pk_UHS2HZOeRnaSOdDp7jbd5w"}};
		</script>
		<script type="text/javascript" src="https://de5282c3ca0c.edge.sdk.awswaf.com/de5282c3ca0c/526cf06acb0d/challenge.js" defer></script>
	</head>
	<body class="flex flex-col min-h-dvh bg-white dark:bg-gray-950 text-black DatasetPage">
		<div class="flex min-h-dvh flex-col"><div class="SVELTE_HYDRATER contents" data-target="SystemThemeMonitor" data-props="{&quot;isLoggedIn&quot;:false}"></div>

	<div class="SVELTE_HYDRATER contents" data-target="MainHeader" data-props="{&quot;classNames&quot;:&quot;&quot;,&quot;isWide&quot;:false,&quot;isZh&quot;:false,&quot;isPro&quot;:false}"><header class="border-b border-gray-100 "><div class="w-full px-4 container flex h-16 items-center"><div class="flex flex-1 items-center"><a class="mr-5 flex flex-none items-center lg:mr-6" href="/"><img alt="Hugging Face's logo" class="w-7 md:mr-2" src="/front/assets/huggingface_logo-noborder.svg">
				<span class="hidden whitespace-nowrap text-lg font-bold md:block">Hugging Face</span></a>
			<div class="relative flex-1 lg:max-w-sm mr-2 sm:mr-4 md:mr-3 xl:mr-6"><input autocomplete="off" class="w-full dark:bg-gray-950 pl-8 form-input-alt h-9 pr-3 focus:shadow-xl " name="" placeholder="Search models, datasets, users..."   spellcheck="false" type="text" value="">
	<svg class="absolute left-2.5 text-gray-400 top-1/2 transform -translate-y-1/2" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M30 28.59L22.45 21A11 11 0 1 0 21 22.45L28.59 30zM5 14a9 9 0 1 1 9 9a9 9 0 0 1-9-9z" fill="currentColor"></path></svg>
	</div>
			<div class="flex flex-none items-center justify-center p-0.5 place-self-stretch lg:hidden"><button class="relative z-40 flex h-6 w-8 items-center justify-center" type="button"><svg width="1em" height="1em" viewBox="0 0 10 10" class="text-xl" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" preserveAspectRatio="xMidYMid meet" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.65039 2.9999C1.65039 2.8066 1.80709 2.6499 2.00039 2.6499H8.00039C8.19369 2.6499 8.35039 2.8066 8.35039 2.9999C8.35039 3.1932 8.19369 3.3499 8.00039 3.3499H2.00039C1.80709 3.3499 1.65039 3.1932 1.65039 2.9999ZM1.65039 4.9999C1.65039 4.8066 1.80709 4.6499 2.00039 4.6499H8.00039C8.19369 4.6499 8.35039 4.8066 8.35039 4.9999C8.35039 5.1932 8.19369 5.3499 8.00039 5.3499H2.00039C1.80709 5.3499 1.65039 5.1932 1.65039 4.9999ZM2.00039 6.6499C1.80709 6.6499 1.65039 6.8066 1.65039 6.9999C1.65039 7.1932 1.80709 7.3499 2.00039 7.3499H8.00039C8.19369 7.3499 8.35039 7.1932 8.35039 6.9999C8.35039 6.8066 8.19369 6.6499 8.00039 6.6499H2.00039Z"></path></svg>
		</button>

	</div></div>
		<nav aria-label="Main" class="ml-auto hidden lg:block"><ul class="flex items-center space-x-1.5 2xl:space-x-2"><li class="hover:text-indigo-700"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/models"><svg class="mr-1.5 text-gray-400 group-hover:text-indigo-500" style="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path class="uim-quaternary" d="M20.23 7.24L12 12L3.77 7.24a1.98 1.98 0 0 1 .7-.71L11 2.76c.62-.35 1.38-.35 2 0l6.53 3.77c.29.173.531.418.7.71z" opacity=".25" fill="currentColor"></path><path class="uim-tertiary" d="M12 12v9.5a2.09 2.09 0 0 1-.91-.21L4.5 17.48a2.003 2.003 0 0 1-1-1.73v-7.5a2.06 2.06 0 0 1 .27-1.01L12 12z" opacity=".5" fill="currentColor"></path><path class="uim-primary" d="M20.5 8.25v7.5a2.003 2.003 0 0 1-1 1.73l-6.62 3.82c-.275.13-.576.198-.88.2V12l8.23-4.76c.175.308.268.656.27 1.01z" fill="currentColor"></path></svg>
					Models</a>
			</li><li class="hover:text-red-700"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/datasets"><svg class="mr-1.5 text-gray-400 group-hover:text-red-500" style="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 25 25"><ellipse cx="12.5" cy="5" fill="currentColor" fill-opacity="0.25" rx="7.5" ry="2"></ellipse><path d="M12.5 15C16.6421 15 20 14.1046 20 13V20C20 21.1046 16.6421 22 12.5 22C8.35786 22 5 21.1046 5 20V13C5 14.1046 8.35786 15 12.5 15Z" fill="currentColor" opacity="0.5"></path><path d="M12.5 7C16.6421 7 20 6.10457 20 5V11.5C20 12.6046 16.6421 13.5 12.5 13.5C8.35786 13.5 5 12.6046 5 11.5V5C5 6.10457 8.35786 7 12.5 7Z" fill="currentColor" opacity="0.5"></path><path d="M5.23628 12C5.08204 12.1598 5 12.8273 5 13C5 14.1046 8.35786 15 12.5 15C16.6421 15 20 14.1046 20 13C20 12.8273 19.918 12.1598 19.7637 12C18.9311 12.8626 15.9947 13.5 12.5 13.5C9.0053 13.5 6.06886 12.8626 5.23628 12Z" fill="currentColor"></path></svg>
					Datasets</a>
			</li><li class="hover:text-blue-700"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/spaces"><svg class="mr-1.5 text-gray-400 group-hover:text-blue-500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" viewBox="0 0 25 25"><path opacity=".5" d="M6.016 14.674v4.31h4.31v-4.31h-4.31ZM14.674 14.674v4.31h4.31v-4.31h-4.31ZM6.016 6.016v4.31h4.31v-4.31h-4.31Z" fill="currentColor"></path><path opacity=".75" fill-rule="evenodd" clip-rule="evenodd" d="M3 4.914C3 3.857 3.857 3 4.914 3h6.514c.884 0 1.628.6 1.848 1.414a5.171 5.171 0 0 1 7.31 7.31c.815.22 1.414.964 1.414 1.848v6.514A1.914 1.914 0 0 1 20.086 22H4.914A1.914 1.914 0 0 1 3 20.086V4.914Zm3.016 1.102v4.31h4.31v-4.31h-4.31Zm0 12.968v-4.31h4.31v4.31h-4.31Zm8.658 0v-4.31h4.31v4.31h-4.31Zm0-10.813a2.155 2.155 0 1 1 4.31 0 2.155 2.155 0 0 1-4.31 0Z" fill="currentColor"></path><path opacity=".25" d="M16.829 6.016a2.155 2.155 0 1 0 0 4.31 2.155 2.155 0 0 0 0-4.31Z" fill="currentColor"></path></svg>
					Spaces</a>
			</li><li class="hover:text-yellow-700 max-xl:hidden"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/posts"><svg class="mr-1.5 text-gray-400 group-hover:text-yellow-500 text-yellow-500!" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" viewBox="0 0 12 12" preserveAspectRatio="xMidYMid meet"><path fill="currentColor" fill-rule="evenodd" d="M3.73 2.4A4.25 4.25 0 1 1 6 10.26H2.17l-.13-.02a.43.43 0 0 1-.3-.43l.01-.06a.43.43 0 0 1 .12-.22l.84-.84A4.26 4.26 0 0 1 3.73 2.4Z" clip-rule="evenodd"></path></svg>
					Posts</a>
			</li><li class="hover:text-yellow-700"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/docs"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="mr-1.5 text-gray-400 group-hover:text-yellow-500" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path d="m2.28 3.7-.3.16a.67.67 0 0 0-.34.58v8.73l.01.04.02.07.01.04.03.06.02.04.02.03.04.06.05.05.04.04.06.04.06.04.08.04.08.02h.05l.07.02h.11l.04-.01.07-.02.03-.01.07-.03.22-.12a5.33 5.33 0 0 1 5.15.1.67.67 0 0 0 .66 0 5.33 5.33 0 0 1 5.33 0 .67.67 0 0 0 1-.58V4.36a.67.67 0 0 0-.34-.5l-.3-.17v7.78a.63.63 0 0 1-.87.59 4.9 4.9 0 0 0-4.35.35l-.65.39a.29.29 0 0 1-.15.04.29.29 0 0 1-.16-.04l-.65-.4a4.9 4.9 0 0 0-4.34-.34.63.63 0 0 1-.87-.59V3.7Z" fill="currentColor" class="dark:opacity-40"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8 3.1a5.99 5.99 0 0 0-5.3-.43.66.66 0 0 0-.42.62v8.18c0 .45.46.76.87.59a4.9 4.9 0 0 1 4.34.35l.65.39c.05.03.1.04.16.04.05 0 .1-.01.15-.04l.65-.4a4.9 4.9 0 0 1 4.35-.34.63.63 0 0 0 .86-.59V3.3a.67.67 0 0 0-.41-.62 5.99 5.99 0 0 0-5.3.43l-.3.17L8 3.1Zm.73 1.87a.43.43 0 1 0-.86 0v5.48a.43.43 0 0 0 .86 0V4.97Z" fill="currentColor" class="opacity-40 dark:opacity-100"></path><path d="M8.73 4.97a.43.43 0 1 0-.86 0v5.48a.43.43 0 1 0 .86 0V4.96Z" fill="currentColor" class="dark:opacity-40"></path></svg>
					Docs</a>
			</li><li class="hover:text-black dark:hover:text-white"><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/enterprise"><svg class="mr-1.5 text-gray-400 group-hover:text-black dark:group-hover:text-white" xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 33 27"><path fill="currentColor" fill-rule="evenodd" d="M13.5.7a8.7 8.7 0 0 0-7.7 5.7L1 20.6c-1 3.1.9 5.7 4.1 5.7h15c3.3 0 6.8-2.6 7.8-5.7l4.6-14.2c1-3.1-.8-5.7-4-5.7h-15Zm1.1 5.7L9.8 20.3h9.8l1-3.1h-5.8l.8-2.5h4.8l1.1-3h-4.8l.8-2.3H23l1-3h-9.5Z" clip-rule="evenodd"></path></svg>
					Enterprise</a>
			</li>

		<li><a class="group flex items-center px-2 py-0.5 dark:text-gray-300 dark:hover:text-gray-100" href="/pricing">Pricing
			</a></li>

		<li><div class="relative group">
	<button class="px-2 py-0.5 hover:text-gray-500 dark:hover:text-gray-600 flex items-center " type="button">
		<svg class=" text-gray-500 w-5 group-hover:text-gray-400 dark:text-gray-300 dark:group-hover:text-gray-100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" viewBox="0 0 32 18" preserveAspectRatio="xMidYMid meet"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4504 3.30221C14.4504 2.836 14.8284 2.45807 15.2946 2.45807H28.4933C28.9595 2.45807 29.3374 2.836 29.3374 3.30221C29.3374 3.76842 28.9595 4.14635 28.4933 4.14635H15.2946C14.8284 4.14635 14.4504 3.76842 14.4504 3.30221Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4504 9.00002C14.4504 8.53382 14.8284 8.15588 15.2946 8.15588H28.4933C28.9595 8.15588 29.3374 8.53382 29.3374 9.00002C29.3374 9.46623 28.9595 9.84417 28.4933 9.84417H15.2946C14.8284 9.84417 14.4504 9.46623 14.4504 9.00002Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4504 14.6978C14.4504 14.2316 14.8284 13.8537 15.2946 13.8537H28.4933C28.9595 13.8537 29.3374 14.2316 29.3374 14.6978C29.3374 15.164 28.9595 15.542 28.4933 15.542H15.2946C14.8284 15.542 14.4504 15.164 14.4504 14.6978Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M1.94549 6.87377C2.27514 6.54411 2.80962 6.54411 3.13928 6.87377L6.23458 9.96907L9.32988 6.87377C9.65954 6.54411 10.194 6.54411 10.5237 6.87377C10.8533 7.20343 10.8533 7.73791 10.5237 8.06756L6.23458 12.3567L1.94549 8.06756C1.61583 7.73791 1.61583 7.20343 1.94549 6.87377Z" fill="currentColor"></path></svg>
			
		</button>
	
	
	</div></li>
		<li><hr class="h-5 w-0.5 border-none bg-gray-100 dark:bg-gray-800"></li>
		<li><a class="block cursor-pointer whitespace-nowrap px-2 py-0.5 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-100" href="/login">Log In
				</a></li>
			<li><a class="whitespace-nowrap rounded-full border border-transparent bg-gray-900 px-3 py-1 leading-none text-white hover:border-black hover:bg-white hover:text-black" href="/join">Sign Up
					</a></li></ul></nav></div></header></div>
	
	
	
	<div class="SVELTE_HYDRATER contents" data-target="SSOBanner" data-props="{}"></div>
	
	

	<main class="flex flex-1 flex-col">
	<div class="SVELTE_HYDRATER contents" data-target="DatasetHeader" data-props="{&quot;activeTab&quot;:&quot;datasetCard&quot;,&quot;author&quot;:{&quot;avatarUrl&quot;:&quot;https://cdn-avatars.huggingface.co/v1/production/uploads/1631524479623-5e48005437cb5b49818287a5.png&quot;,&quot;fullname&quot;:&quot;Hugging Face Course&quot;,&quot;name&quot;:&quot;huggingface-course&quot;,&quot;type&quot;:&quot;org&quot;,&quot;isHf&quot;:false,&quot;isHfAdmin&quot;:false,&quot;isMod&quot;:false,&quot;isEnterprise&quot;:false,&quot;followerCount&quot;:95},&quot;canReadRepoSettings&quot;:false,&quot;dataset&quot;:{&quot;author&quot;:&quot;huggingface-course&quot;,&quot;createdAt&quot;:&quot;2022-03-02T23:29:22.000Z&quot;,&quot;downloads&quot;:1404,&quot;downloadsAllTime&quot;:58353,&quot;id&quot;:&quot;huggingface-course/codeparrot-ds-valid&quot;,&quot;isLikedByUser&quot;:false,&quot;lastModified&quot;:&quot;2021-09-13T14:24:27.000Z&quot;,&quot;likes&quot;:3,&quot;datasetsServerInfo&quot;:{&quot;viewer&quot;:&quot;viewer&quot;,&quot;numRows&quot;:3322,&quot;libraries&quot;:[&quot;datasets&quot;,&quot;pandas&quot;,&quot;mlcroissant&quot;,&quot;polars&quot;],&quot;formats&quot;:[&quot;json&quot;],&quot;modalities&quot;:[&quot;text&quot;]},&quot;discussionsDisabled&quot;:false,&quot;repoType&quot;:&quot;dataset&quot;,&quot;private&quot;:false,&quot;gated&quot;:false,&quot;tags&quot;:[&quot;size_categories:1K<n<10K&quot;,&quot;format:json&quot;,&quot;modality:text&quot;,&quot;library:datasets&quot;,&quot;library:pandas&quot;,&quot;library:mlcroissant&quot;,&quot;library:polars&quot;,&quot;region:us&quot;],&quot;tag_objs&quot;:[{&quot;id&quot;:&quot;size_categories:1K<n<10K&quot;,&quot;label&quot;:&quot;1K - 10K&quot;,&quot;type&quot;:&quot;size_categories&quot;},{&quot;id&quot;:&quot;format:json&quot;,&quot;label&quot;:&quot;json&quot;,&quot;type&quot;:&quot;format&quot;},{&quot;id&quot;:&quot;modality:text&quot;,&quot;label&quot;:&quot;Text&quot;,&quot;type&quot;:&quot;modality&quot;},{&quot;id&quot;:&quot;library:datasets&quot;,&quot;label&quot;:&quot;Datasets&quot;,&quot;type&quot;:&quot;library&quot;},{&quot;id&quot;:&quot;library:pandas&quot;,&quot;label&quot;:&quot;pandas&quot;,&quot;type&quot;:&quot;library&quot;},{&quot;id&quot;:&quot;library:mlcroissant&quot;,&quot;label&quot;:&quot;Croissant&quot;,&quot;type&quot;:&quot;library&quot;},{&quot;id&quot;:&quot;library:polars&quot;,&quot;label&quot;:&quot;Polars&quot;,&quot;type&quot;:&quot;library&quot;},{&quot;type&quot;:&quot;region&quot;,&quot;label&quot;:&quot;ðŸ‡ºðŸ‡¸ Region: US&quot;,&quot;id&quot;:&quot;region:us&quot;}],&quot;hasBlockedOids&quot;:false,&quot;region&quot;:&quot;us&quot;,&quot;xetEnabled&quot;:false},&quot;discussionsStats&quot;:{&quot;closed&quot;:0,&quot;open&quot;:0,&quot;total&quot;:0}}"><header class="bg-linear-to-t border-b border-gray-100 pt-6 sm:pt-9 from-gray-50-to-white via-white dark:via-gray-950"><div class="container relative "><h1 class="flex flex-wrap items-center max-md:leading-tight mb-3 text-lg max-sm:gap-y-1.5 md:text-xl"><a href="/datasets" class="group flex items-center"><svg class="sm:mr-1.5 -mr-1 text-gray-400" style="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 25 25"><ellipse cx="12.5" cy="5" fill="currentColor" fill-opacity="0.25" rx="7.5" ry="2"></ellipse><path d="M12.5 15C16.6421 15 20 14.1046 20 13V20C20 21.1046 16.6421 22 12.5 22C8.35786 22 5 21.1046 5 20V13C5 14.1046 8.35786 15 12.5 15Z" fill="currentColor" opacity="0.5"></path><path d="M12.5 7C16.6421 7 20 6.10457 20 5V11.5C20 12.6046 16.6421 13.5 12.5 13.5C8.35786 13.5 5 12.6046 5 11.5V5C5 6.10457 8.35786 7 12.5 7Z" fill="currentColor" opacity="0.5"></path><path d="M5.23628 12C5.08204 12.1598 5 12.8273 5 13C5 14.1046 8.35786 15 12.5 15C16.6421 15 20 14.1046 20 13C20 12.8273 19.918 12.1598 19.7637 12C18.9311 12.8626 15.9947 13.5 12.5 13.5C9.0053 13.5 6.06886 12.8626 5.23628 12Z" fill="currentColor"></path></svg>
					<span class="mr-2.5 font-semibold text-gray-400 group-hover:text-gray-500 max-sm:hidden">Datasets:</span></a>
				<hr class="mx-1.5 h-2 translate-y-px rounded-sm border-r dark:border-gray-600 sm:hidden">
			<div class="group flex flex-none items-center"><div class="relative mr-1 flex items-center">

			

<span class="inline-block "><span class="contents"><a href="/huggingface-course" class="text-gray-400 hover:text-blue-600"><img alt="" class="w-3.5 h-3.5 rounded-sm  flex-none" src="https://cdn-avatars.huggingface.co/v1/production/uploads/1631524479623-5e48005437cb5b49818287a5.png" crossorigin="anonymous"></a></span>
	</span></div>
		

<span class="inline-block "><span class="contents"><a href="/huggingface-course" class="text-gray-400 hover:text-blue-600">huggingface-course</a></span>
	</span>
		<div class="mx-0.5 text-gray-300">/</div></div>

<div class="max-w-full "><a class="break-words font-mono font-semibold hover:text-blue-600 " href="/datasets/huggingface-course/codeparrot-ds-valid">codeparrot-ds-valid</a>
	<button class="relative text-sm mr-4 focus:outline-hidden inline-flex cursor-pointer items-center text-sm  mx-0.5   text-gray-600 " title="Copy dataset name to clipboard" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	
	</button></div>
			<div class="inline-flex items-center overflow-hidden whitespace-nowrap rounded-md border bg-white text-sm leading-none text-gray-500  mr-2"><button class="relative flex items-center overflow-hidden from-red-50 to-transparent dark:from-red-900 px-1.5 py-1 hover:bg-linear-to-t focus:outline-hidden"  title="Like"><svg class="left-1.5 absolute" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" fill="currentColor"><path d="M22.45,6a5.47,5.47,0,0,1,3.91,1.64,5.7,5.7,0,0,1,0,8L16,26.13,5.64,15.64a5.7,5.7,0,0,1,0-8,5.48,5.48,0,0,1,7.82,0L16,10.24l2.53-2.58A5.44,5.44,0,0,1,22.45,6m0-2a7.47,7.47,0,0,0-5.34,2.24L16,7.36,14.89,6.24a7.49,7.49,0,0,0-10.68,0,7.72,7.72,0,0,0,0,10.82L16,29,27.79,17.06a7.72,7.72,0,0,0,0-10.82A7.49,7.49,0,0,0,22.45,4Z"></path></svg>

		
		<span class="ml-4 pl-0.5 ">like</span></button>
	<button class="focus:outline-hidden flex items-center border-l px-1.5 py-1 text-gray-400 hover:bg-gray-50 focus:bg-gray-100 dark:hover:bg-gray-900 dark:focus:bg-gray-800" title="See users who liked this repository">3</button></div>




			<div class="relative flex items-center gap-1.5  "><div class="mr-2 inline-flex h-6 items-center overflow-hidden whitespace-nowrap rounded-md border text-sm text-gray-500"><button class="focus:outline-hidden relative flex h-full max-w-56 items-center gap-1.5 overflow-hidden px-1.5 hover:bg-gray-50 focus:bg-gray-100 dark:hover:bg-gray-900 dark:focus:bg-gray-800" type="button" ><div class="flex h-full flex-1 items-center justify-center ">Follow</div>
		<img alt="" class="rounded-xs size-3 flex-none" src="https://cdn-avatars.huggingface.co/v1/production/uploads/1631524479623-5e48005437cb5b49818287a5.png">
		<span class="truncate">Hugging Face Course</span></button>
	<button class="focus:outline-hidden flex h-full items-center border-l pl-1.5 pr-1.5 text-gray-400 hover:bg-gray-50 focus:bg-gray-100 dark:hover:bg-gray-900 dark:focus:bg-gray-800" title="Show Hugging Face Course's followers" type="button">95</button></div>

		</div>
			
	</h1>
		<div class="mb-3 flex flex-wrap md:mb-4"><div class="mr-1 flex flex-wrap items-center"><span class="mb-1 mr-1 p-1 text-sm leading-tight text-gray-400 md:mb-1.5">Modalities:
	</span>
	<a class="mb-1 mr-1 md:mb-1.5 md:mr-1.5 rounded-lg" href="/datasets?modality=modality%3Atext"><div class="tag tag-white   ">
		<svg class="text-red-700 dark:text-red-600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.619 4.619C2.667 6.573 2.667 9.715 2.667 16s0 9.428 1.952 11.38C6.573 29.333 9.715 29.333 16 29.333s9.428 0 11.38-1.953c1.953-1.95 1.953-5.095 1.953-11.38s0-9.428-1.953-11.381C25.43 2.667 22.285 2.667 16 2.667s-9.428 0-11.381 1.952m8.65 3.714c-.573 0-1.109 0-1.546.066-.495.073-1.003.248-1.41.7-.392.436-.53.956-.59 1.452-.056.464-.056 1.04-.056 1.689V13a1 1 0 1 0 2 0v-.704c0-.724.001-1.176.041-1.505q.015-.15.061-.294a.2.2 0 0 1 .031-.061q0-.003.016-.01a.8.8 0 0 1 .203-.05c.272-.04.654-.043 1.314-.043H15v11.334h-2.333a1 1 0 1 0 0 2H20a1 1 0 0 0 0-2h-3V10.333h1.667c.66 0 1.042.003 1.314.043.123.019.18.04.203.05l.015.009a.2.2 0 0 1 .032.061c.018.05.042.14.061.295.04.329.041.781.041 1.506V13a1 1 0 1 0 2 0v-.76c0-.65 0-1.225-.056-1.69-.06-.495-.198-1.015-.59-1.453-.407-.45-.915-.625-1.41-.698-.437-.067-.973-.067-1.546-.066z" fill="currentColor"></path></svg>

	

	<span>Text</span>
	

	</div></a>

	</div><div class="mr-1 flex flex-wrap items-center"><span class="mb-1 mr-1 p-1 text-sm leading-tight text-gray-400 md:mb-1.5">Formats:
	</span>
	<a class="mb-1 mr-1 md:mb-1.5 md:mr-1.5 rounded-lg" href="/datasets?format=format%3Ajson"><div class="tag tag-white   ">
		<svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.917 2.25h-.834v.833h.834v2.084A.833.833 0 0 0 9.75 6a.833.833 0 0 0-.833.833v2.084h-.834v.833h.834c.446-.113.833-.375.833-.833V7.25a.833.833 0 0 1 .833-.833H11v-.834h-.417a.833.833 0 0 1-.833-.833V3.083a.833.833 0 0 0-.833-.833Zm-5.834 0a.833.833 0 0 0-.833.833V4.75a.833.833 0 0 1-.833.833H1v.834h.417a.833.833 0 0 1 .833.833v1.667a.833.833 0 0 0 .833.833h.834v-.833h-.834V6.833A.833.833 0 0 0 2.25 6a.833.833 0 0 0 .833-.833V3.083h.834V2.25h-.834ZM6 7.25a.417.417 0 1 0 0 .833.417.417 0 0 0 0-.833Zm1.667 0a.417.417 0 1 0 0 .833.417.417 0 0 0 0-.833Zm-3.334 0a.417.417 0 1 0 0 .833.417.417 0 0 0 0-.833Z" fill="currentColor"></path></svg>

	

	<span>json</span>
	

	</div></a>

	</div><div class="mr-1 flex flex-wrap items-center"><span class="mb-1 mr-1 p-1 text-sm leading-tight text-gray-400 md:mb-1.5">Size:
	</span>
	<a class="mb-1 mr-1 md:mb-1.5 md:mr-1.5 rounded-lg" href="/datasets?size_categories=size_categories%3A1K%3Cn%3C10K"><div class="tag tag-white   ">

	

	<span>1K - 10K</span>
	

	</div></a>

	</div><div class="mr-1 flex flex-wrap items-center"><span class="mb-1 mr-1 p-1 text-sm leading-tight text-gray-400 md:mb-1.5">Libraries:
	</span>
	<a class="mb-1 mr-1 md:mb-1.5 md:mr-1.5 rounded-lg" href="/datasets?library=library%3Adatasets"><div class="tag tag-white   "><svg class="text-black inline-block text-sm" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" preserveAspectRatio="xMidYMid meet" width="1em" height="1em" viewBox="0 0 95 88"><path fill="#fff" d="M94.25 70.08a8.28 8.28 0 0 1-.43 6.46 10.57 10.57 0 0 1-3 3.6 25.18 25.18 0 0 1-5.7 3.2 65.74 65.74 0 0 1-7.56 2.65 46.67 46.67 0 0 1-11.42 1.68c-5.42.05-10.09-1.23-13.4-4.5a40.4 40.4 0 0 1-10.14.03c-3.34 3.25-7.99 4.52-13.39 4.47a46.82 46.82 0 0 1-11.43-1.68 66.37 66.37 0 0 1-7.55-2.65c-2.28-.98-4.17-2-5.68-3.2a10.5 10.5 0 0 1-3.02-3.6c-.99-2-1.18-4.3-.42-6.46a8.54 8.54 0 0 1-.33-5.63c.25-.95.66-1.83 1.18-2.61a8.67 8.67 0 0 1 2.1-8.47 8.23 8.23 0 0 1 2.82-2.07 41.75 41.75 0 1 1 81.3-.12 8.27 8.27 0 0 1 3.11 2.19 8.7 8.7 0 0 1 2.1 8.47c.52.78.93 1.66 1.18 2.61a8.61 8.61 0 0 1-.32 5.63Z"></path><path fill="#FFD21E" d="M47.21 76.5a34.75 34.75 0 1 0 0-69.5 34.75 34.75 0 0 0 0 69.5Z"></path><path fill="#FF9D0B" d="M81.96 41.75a34.75 34.75 0 1 0-69.5 0 34.75 34.75 0 0 0 69.5 0Zm-73.5 0a38.75 38.75 0 1 1 77.5 0 38.75 38.75 0 0 1-77.5 0Z"></path><path fill="#3A3B45" d="M58.5 32.3c1.28.44 1.78 3.06 3.07 2.38a5 5 0 1 0-6.76-2.07c.61 1.15 2.55-.72 3.7-.32ZM34.95 32.3c-1.28.44-1.79 3.06-3.07 2.38a5 5 0 1 1 6.76-2.07c-.61 1.15-2.56-.72-3.7-.32Z"></path><path fill="#FF323D" d="M46.96 56.29c9.83 0 13-8.76 13-13.26 0-2.34-1.57-1.6-4.09-.36-2.33 1.15-5.46 2.74-8.9 2.74-7.19 0-13-6.88-13-2.38s3.16 13.26 13 13.26Z"></path><path fill="#3A3B45" fill-rule="evenodd" d="M39.43 54a8.7 8.7 0 0 1 5.3-4.49c.4-.12.81.57 1.24 1.28.4.68.82 1.37 1.24 1.37.45 0 .9-.68 1.33-1.35.45-.7.89-1.38 1.32-1.25a8.61 8.61 0 0 1 5 4.17c3.73-2.94 5.1-7.74 5.1-10.7 0-2.34-1.57-1.6-4.09-.36l-.14.07c-2.31 1.15-5.39 2.67-8.77 2.67s-6.45-1.52-8.77-2.67c-2.6-1.29-4.23-2.1-4.23.29 0 3.05 1.46 8.06 5.47 10.97Z" clip-rule="evenodd"></path><path fill="#FF9D0B" d="M70.71 37a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5ZM24.21 37a3.25 3.25 0 1 0 0-6.5 3.25 3.25 0 0 0 0 6.5ZM17.52 48c-1.62 0-3.06.66-4.07 1.87a5.97 5.97 0 0 0-1.33 3.76 7.1 7.1 0 0 0-1.94-.3c-1.55 0-2.95.59-3.94 1.66a5.8 5.8 0 0 0-.8 7 5.3 5.3 0 0 0-1.79 2.82c-.24.9-.48 2.8.8 4.74a5.22 5.22 0 0 0-.37 5.02c1.02 2.32 3.57 4.14 8.52 6.1 3.07 1.22 5.89 2 5.91 2.01a44.33 44.33 0 0 0 10.93 1.6c5.86 0 10.05-1.8 12.46-5.34 3.88-5.69 3.33-10.9-1.7-15.92-2.77-2.78-4.62-6.87-5-7.77-.78-2.66-2.84-5.62-6.25-5.62a5.7 5.7 0 0 0-4.6 2.46c-1-1.26-1.98-2.25-2.86-2.82A7.4 7.4 0 0 0 17.52 48Zm0 4c.51 0 1.14.22 1.82.65 2.14 1.36 6.25 8.43 7.76 11.18.5.92 1.37 1.31 2.14 1.31 1.55 0 2.75-1.53.15-3.48-3.92-2.93-2.55-7.72-.68-8.01.08-.02.17-.02.24-.02 1.7 0 2.45 2.93 2.45 2.93s2.2 5.52 5.98 9.3c3.77 3.77 3.97 6.8 1.22 10.83-1.88 2.75-5.47 3.58-9.16 3.58-3.81 0-7.73-.9-9.92-1.46-.11-.03-13.45-3.8-11.76-7 .28-.54.75-.76 1.34-.76 2.38 0 6.7 3.54 8.57 3.54.41 0 .7-.17.83-.6.79-2.85-12.06-4.05-10.98-8.17.2-.73.71-1.02 1.44-1.02 3.14 0 10.2 5.53 11.68 5.53.11 0 .2-.03.24-.1.74-1.2.33-2.04-4.9-5.2-5.21-3.16-8.88-5.06-6.8-7.33.24-.26.58-.38 1-.38 3.17 0 10.66 6.82 10.66 6.82s2.02 2.1 3.25 2.1c.28 0 .52-.1.68-.38.86-1.46-8.06-8.22-8.56-11.01-.34-1.9.24-2.85 1.31-2.85Z"></path><path fill="#FFD21E" d="M38.6 76.69c2.75-4.04 2.55-7.07-1.22-10.84-3.78-3.77-5.98-9.3-5.98-9.3s-.82-3.2-2.69-2.9c-1.87.3-3.24 5.08.68 8.01 3.91 2.93-.78 4.92-2.29 2.17-1.5-2.75-5.62-9.82-7.76-11.18-2.13-1.35-3.63-.6-3.13 2.2.5 2.79 9.43 9.55 8.56 11-.87 1.47-3.93-1.71-3.93-1.71s-9.57-8.71-11.66-6.44c-2.08 2.27 1.59 4.17 6.8 7.33 5.23 3.16 5.64 4 4.9 5.2-.75 1.2-12.28-8.53-13.36-4.4-1.08 4.11 11.77 5.3 10.98 8.15-.8 2.85-9.06-5.38-10.74-2.18-1.7 3.21 11.65 6.98 11.76 7.01 4.3 1.12 15.25 3.49 19.08-2.12Z"></path><path fill="#FF9D0B" d="M77.4 48c1.62 0 3.07.66 4.07 1.87a5.97 5.97 0 0 1 1.33 3.76 7.1 7.1 0 0 1 1.95-.3c1.55 0 2.95.59 3.94 1.66a5.8 5.8 0 0 1 .8 7 5.3 5.3 0 0 1 1.78 2.82c.24.9.48 2.8-.8 4.74a5.22 5.22 0 0 1 .37 5.02c-1.02 2.32-3.57 4.14-8.51 6.1-3.08 1.22-5.9 2-5.92 2.01a44.33 44.33 0 0 1-10.93 1.6c-5.86 0-10.05-1.8-12.46-5.34-3.88-5.69-3.33-10.9 1.7-15.92 2.78-2.78 4.63-6.87 5.01-7.77.78-2.66 2.83-5.62 6.24-5.62a5.7 5.7 0 0 1 4.6 2.46c1-1.26 1.98-2.25 2.87-2.82A7.4 7.4 0 0 1 77.4 48Zm0 4c-.51 0-1.13.22-1.82.65-2.13 1.36-6.25 8.43-7.76 11.18a2.43 2.43 0 0 1-2.14 1.31c-1.54 0-2.75-1.53-.14-3.48 3.91-2.93 2.54-7.72.67-8.01a1.54 1.54 0 0 0-.24-.02c-1.7 0-2.45 2.93-2.45 2.93s-2.2 5.52-5.97 9.3c-3.78 3.77-3.98 6.8-1.22 10.83 1.87 2.75 5.47 3.58 9.15 3.58 3.82 0 7.73-.9 9.93-1.46.1-.03 13.45-3.8 11.76-7-.29-.54-.75-.76-1.34-.76-2.38 0-6.71 3.54-8.57 3.54-.42 0-.71-.17-.83-.6-.8-2.85 12.05-4.05 10.97-8.17-.19-.73-.7-1.02-1.44-1.02-3.14 0-10.2 5.53-11.68 5.53-.1 0-.19-.03-.23-.1-.74-1.2-.34-2.04 4.88-5.2 5.23-3.16 8.9-5.06 6.8-7.33-.23-.26-.57-.38-.98-.38-3.18 0-10.67 6.82-10.67 6.82s-2.02 2.1-3.24 2.1a.74.74 0 0 1-.68-.38c-.87-1.46 8.05-8.22 8.55-11.01.34-1.9-.24-2.85-1.31-2.85Z"></path><path fill="#FFD21E" d="M56.33 76.69c-2.75-4.04-2.56-7.07 1.22-10.84 3.77-3.77 5.97-9.3 5.97-9.3s.82-3.2 2.7-2.9c1.86.3 3.23 5.08-.68 8.01-3.92 2.93.78 4.92 2.28 2.17 1.51-2.75 5.63-9.82 7.76-11.18 2.13-1.35 3.64-.6 3.13 2.2-.5 2.79-9.42 9.55-8.55 11 .86 1.47 3.92-1.71 3.92-1.71s9.58-8.71 11.66-6.44c2.08 2.27-1.58 4.17-6.8 7.33-5.23 3.16-5.63 4-4.9 5.2.75 1.2 12.28-8.53 13.36-4.4 1.08 4.11-11.76 5.3-10.97 8.15.8 2.85 9.05-5.38 10.74-2.18 1.69 3.21-11.65 6.98-11.76 7.01-4.31 1.12-15.26 3.49-19.08-2.12Z"></path></svg>

	

	<span>Datasets</span>
	

	</div></a><a class="mb-1 mr-1 md:mb-1.5 md:mr-1.5 rounded-lg" href="/datasets?library=library%3Apandas"><div class="tag tag-white   "><svg class="text-black inline-block text-sm text-[#130754] dark:text-gray-200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid slice" viewBox="0 0 210.21 280.43"><rect fill="currentColor" x="74.51" y="43.03" width="24.09" height="50.02"></rect><rect fill="currentColor" x="74.51" y="145.78" width="24.09" height="50.02"></rect><rect fill="#ffca00" x="74.51" y="107.65" width="24.09" height="23.6"></rect><rect fill="currentColor" x="35.81" y="84.15" width="24.09" height="166.27"></rect><rect fill="currentColor" x="112.41" y="187.05" width="24.09" height="50.02"></rect><rect fill="currentColor" x="112.41" y="84.21" width="24.09" height="50.02"></rect><rect fill="#e70488" x="112.41" y="148.84" width="24.09" height="23.6"></rect><rect fill="currentColor" x="150.3" y="30" width="24.09" height="166.27"></rect></svg>

	

	<span>pandas</span>
	

	</div></a><div class="relative inline-block ">
	<button class="group mr-1 mb-1 md:mr-1.5 md:mb-1.5  rounded-lg rounded-br-none " type="button">
		<div class="tag tag-white   relative rounded-br-none pr-2.5"><svg class="text-black inline-block text-sm" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" fill="none" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M22.2812 12.2656L25.9532 15.7187C26.8932 16.6587 28.0913 17.3931 29.0313 16.4531C29.8594 15.7812 29.9332 14.1 29.9532 13.5C29.9532 11.5625 28.9219 8.375 27.25 6.71875C25.5604 5.04493 23.3782 3.91692 22.7032 3.78125L22.2812 12.2656Z" fill="#F5AB6A"></path><path d="M22.2812 12.2656L25.9532 15.7187C26.8932 16.6587 28.0913 17.3931 29.0313 16.4531C29.8594 15.7812 29.9332 14.1 29.9532 13.5C29.9532 11.5625 28.9219 8.375 27.25 6.71875C25.5604 5.04493 23.3782 3.91692 22.7032 3.78125L22.2812 12.2656Z" fill="url(#paint0_radial_18_31665)"></path><g filter="url(#filter0_f_18_31665)"><path d="M22.2849 12.1817L23.4375 13.2656L24.4375 4.70312C23.5121 4.1242 23.0198 3.96369 22.6563 3.89062L22.2849 12.1817Z" fill="url(#paint1_linear_18_31665)"></path></g><path d="M22.7969 3.05741L21.8437 2.65269C19.6421 1.96765 17.2344 1.81208 14.6719 2.23236C12.1094 2.65264 11.5156 3.2442 11.5156 3.2442C10.896 3.3674 10.8671 3.88898 11.1718 4.45363C13.0797 6.72576 15.176 13.4043 18.0469 14.2506C18.89 14.4662 21.3791 14.4776 22.2019 14.1593L22.3238 14.108C22.6692 13.9745 23.1672 13.2814 23.1875 12.9118L23.4219 4.03043C23.4523 3.59924 23.1484 3.25204 22.7969 3.05741Z" fill="url(#paint2_radial_18_31665)"></path><path d="M22.7969 3.05741L21.8437 2.65269C19.6421 1.96765 17.2344 1.81208 14.6719 2.23236C12.1094 2.65264 11.5156 3.2442 11.5156 3.2442C10.896 3.3674 10.8671 3.88898 11.1718 4.45363C13.0797 6.72576 15.176 13.4043 18.0469 14.2506C18.89 14.4662 21.3791 14.4776 22.2019 14.1593L22.3238 14.108C22.6692 13.9745 23.1672 13.2814 23.1875 12.9118L23.4219 4.03043C23.4523 3.59924 23.1484 3.25204 22.7969 3.05741Z" fill="url(#paint3_radial_18_31665)"></path><path d="M22.7969 3.05741L21.8437 2.65269C19.6421 1.96765 17.2344 1.81208 14.6719 2.23236C12.1094 2.65264 11.5156 3.2442 11.5156 3.2442C10.896 3.3674 10.8671 3.88898 11.1718 4.45363C13.0797 6.72576 15.176 13.4043 18.0469 14.2506C18.89 14.4662 21.3791 14.4776 22.2019 14.1593L22.3238 14.108C22.6692 13.9745 23.1672 13.2814 23.1875 12.9118L23.4219 4.03043C23.4523 3.59924 23.1484 3.25204 22.7969 3.05741Z" fill="url(#paint4_radial_18_31665)"></path><path d="M22.7969 3.05741L21.8437 2.65269C19.6421 1.96765 17.2344 1.81208 14.6719 2.23236C12.1094 2.65264 11.5156 3.2442 11.5156 3.2442C10.896 3.3674 10.8671 3.88898 11.1718 4.45363C13.0797 6.72576 15.176 13.4043 18.0469 14.2506C18.89 14.4662 21.3791 14.4776 22.2019 14.1593L22.3238 14.108C22.6692 13.9745 23.1672 13.2814 23.1875 12.9118L23.4219 4.03043C23.4523 3.59924 23.1484 3.25204 22.7969 3.05741Z" fill="url(#paint5_radial_18_31665)"></path><path d="M22.7969 3.05741L21.8437 2.65269C19.6421 1.96765 17.2344 1.81208 14.6719 2.23236C12.1094 2.65264 11.5156 3.2442 11.5156 3.2442C10.896 3.3674 10.8671 3.88898 11.1718 4.45363C13.0797 6.72576 15.176 13.4043 18.0469 14.2506C18.89 14.4662 21.3791 14.4776 22.2019 14.1593L22.3238 14.108C22.6692 13.9745 23.1672 13.2814 23.1875 12.9118L23.4219 4.03043C23.4523 3.59924 23.1484 3.25204 22.7969 3.05741Z" fill="url(#paint6_linear_18_31665)"></path><g filter="url(#filter1_f_18_31665)"><path d="M13.1016 2.72656C11.862 3.06924 11.5298 3.40016 11.5298 3.40016C10.9102 3.52335 10.936 4.11525 11.2408 4.6799C13.1487 6.95202 15.1361 13.2496 18.007 14.0958C18.2707 14.1633 18.6953 14.2107 19.1797 14.2344L13.1016 2.72656Z" fill="url(#paint7_linear_18_31665)"></path></g><path d="M12.2187 22.7187L15.7656 26.2031C16.7332 27.1171 17.3334 28.2487 16.4219 29.2188C15.7749 30.0687 14.2241 29.9933 13.625 30.0313C11.6883 30.0891 9.09014 29.5622 6.84373 27.5313C5.07737 25.9343 4.09321 23.688 3.93751 23.0156L12.2187 22.7187Z" fill="url(#paint8_radial_18_31665)"></path><path d="M12.2187 22.7187L15.7656 26.2031C16.7332 27.1171 17.3334 28.2487 16.4219 29.2188C15.7749 30.0687 14.2241 29.9933 13.625 30.0313C11.6883 30.0891 9.09014 29.5622 6.84373 27.5313C5.07737 25.9343 4.09321 23.688 3.93751 23.0156L12.2187 22.7187Z" fill="url(#paint9_radial_18_31665)"></path><g filter="url(#filter2_f_18_31665)"><path d="M12.0523 22.7916L13.2187 23.9375L4.81018 24.5721C4.4328 23.8671 4.20835 23.2768 4.14062 22.9844L12.0523 22.7916Z" fill="url(#paint10_linear_18_31665)"></path><path d="M12.0523 22.7916L13.2187 23.9375L4.81018 24.5721C4.4328 23.8671 4.20835 23.2768 4.14062 22.9844L12.0523 22.7916Z" fill="url(#paint11_radial_18_31665)"></path></g><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="#EC9F6A"></path><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="url(#paint12_radial_18_31665)"></path><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="url(#paint13_linear_18_31665)"></path><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="url(#paint14_radial_18_31665)"></path><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="url(#paint15_radial_18_31665)"></path><path d="M2.99219 22.6484C2.07068 20.538 1.78913 17.4452 2.21096 15.0703C2.63279 12.6953 3.20759 11.951 3.20759 11.951C3.31231 11.3264 3.83281 11.2818 4.40626 11.5703C6.73409 13.4144 13.3119 15.2264 14.2432 18.0781C14.5947 19.3034 14.6279 21.3125 14.1641 22.5156C14.0409 22.8657 13.5 23.3516 13.0625 23.4141C12.625 23.4765 9.47656 23.3516 8.61719 23.3516C7.75781 23.3516 4.64844 23.6719 4.14062 23.6172C3.63281 23.5625 3.23437 23.2031 2.99219 22.6484Z" fill="url(#paint16_radial_18_31665)"></path><g filter="url(#filter3_f_18_31665)"><path d="M2.70313 13.6719C3.04135 12.4711 3.36224 12.0555 3.36224 12.0555C3.46697 11.4309 3.98746 11.3864 4.56092 11.6749C6.88874 13.5189 13.0809 15.1104 14.0121 17.9622C14.1731 18.5231 14.2766 19.0394 14.3287 19.5128L2.70313 13.6719Z" fill="url(#paint17_linear_18_31665)"></path><path d="M2.70313 13.6719C3.04135 12.4711 3.36224 12.0555 3.36224 12.0555C3.46697 11.4309 3.98746 11.3864 4.56092 11.6749C6.88874 13.5189 13.0809 15.1104 14.0121 17.9622C14.1731 18.5231 14.2766 19.0394 14.3287 19.5128L2.70313 13.6719Z" fill="url(#paint18_linear_18_31665)"></path></g><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="#D79453"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint19_radial_18_31665)"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint20_radial_18_31665)"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint21_radial_18_31665)"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint22_linear_18_31665)"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint23_radial_18_31665)"></path><path d="M9.83184 2.82184C6.62184 4.07184 4.07184 6.62184 2.82184 9.83184C2.48184 10.7118 2.82184 11.7018 3.62184 12.1918L14.0418 18.5418C14.6618 18.9218 15.4418 18.9218 16.0618 18.5418C17.0718 17.9218 17.9318 17.0718 18.5418 16.0618C18.9218 15.4418 18.9218 14.6618 18.5418 14.0418L12.1918 3.62184C11.7018 2.82184 10.7118 2.48184 9.83184 2.82184Z" fill="url(#paint24_radial_18_31665)"></path><defs><filter id="filter0_f_18_31665" x="22.0349" y="3.64062" width="2.65265" height="9.875" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="0.125" result="effect1_foregroundBlur_18_31665"></feGaussianBlur></filter><filter id="filter1_f_18_31665" x="10.7815" y="2.47656" width="8.64819" height="12.0078" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="0.125" result="effect1_foregroundBlur_18_31665"></feGaussianBlur></filter><filter id="filter2_f_18_31665" x="3.89062" y="22.5416" width="9.57812" height="2.2804" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="0.125" result="effect1_foregroundBlur_18_31665"></feGaussianBlur></filter><filter id="filter3_f_18_31665" x="2.45312" y="11.2538" width="12.1255" height="8.50903" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur stdDeviation="0.125" result="effect1_foregroundBlur_18_31665"></feGaussianBlur></filter><radialGradient id="paint0_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(22.8125 12.9375) rotate(42.7741) scale(12.5164 7.08839)"><stop offset="0.0937591" stop-color="#C05159"></stop><stop offset="0.553697" stop-color="#F6AC6A"></stop><stop offset="0.832916" stop-color="#FFD186"></stop><stop offset="0.916927" stop-color="#FFDC87"></stop></radialGradient><linearGradient id="paint1_linear_18_31665" x1="24.7344" y1="4.67187" x2="20.8594" y2="12.8906" gradientUnits="userSpaceOnUse"><stop stop-color="#EBD67C"></stop><stop offset="0.0655686" stop-color="#FFFFA6"></stop><stop offset="0.530552" stop-color="#F8C281"></stop><stop offset="0.937338" stop-color="#E99E6B"></stop></linearGradient><radialGradient id="paint2_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(22.9009 13.1847) rotate(-127.648) scale(14.3438 11.7966)"><stop stop-color="#FFBE66"></stop><stop offset="1" stop-color="#E2AE5B"></stop></radialGradient><radialGradient id="paint3_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(18 11.4375) rotate(53.9726) scale(11.9013 4.84018)"><stop stop-color="#D67C63"></stop><stop offset="1" stop-color="#D97D67" stop-opacity="0"></stop></radialGradient><radialGradient id="paint4_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(23 4.1875) rotate(45.7639) scale(3.31486 5.75622)"><stop stop-color="#FFE4A6"></stop><stop offset="0.711285" stop-color="#F8B76F"></stop><stop offset="1" stop-color="#F9B870" stop-opacity="0"></stop></radialGradient><radialGradient id="paint5_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(22.875 12.4375) rotate(88.9391) scale(3.37558 1.29066)"><stop stop-color="#FFBC67"></stop><stop offset="1" stop-color="#FFBC67" stop-opacity="0"></stop></radialGradient><linearGradient id="paint6_linear_18_31665" x1="20.375" y1="15.6875" x2="20.125" y2="12.7813" gradientUnits="userSpaceOnUse"><stop offset="0.461609" stop-color="#B45077"></stop><stop offset="0.855389" stop-color="#B75077" stop-opacity="0"></stop></linearGradient><linearGradient id="paint7_linear_18_31665" x1="12.9375" y1="2.57056" x2="18.5625" y2="14.3891" gradientUnits="userSpaceOnUse"><stop stop-color="#DDC173"></stop><stop offset="0.485173" stop-color="#D59F65"></stop><stop offset="1" stop-color="#E49966"></stop></linearGradient><radialGradient id="paint8_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(13.5625 23.5) rotate(109.113) scale(6.68078 10.2578)"><stop offset="0.165756" stop-color="#FFBF7E"></stop><stop offset="0.827674" stop-color="#DF8C6D"></stop><stop offset="1" stop-color="#B05A66"></stop></radialGradient><radialGradient id="paint9_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.1875 26) rotate(41.0652) scale(8.37243 2.03649)"><stop stop-color="#FFD483"></stop><stop offset="1" stop-color="#FFD688" stop-opacity="0"></stop></radialGradient><linearGradient id="paint10_linear_18_31665" x1="3.96063" y1="23.794" x2="13.3748" y2="23.5143" gradientUnits="userSpaceOnUse"><stop stop-color="#A8716F"></stop><stop offset="0.103615" stop-color="#B37173"></stop><stop offset="0.225484" stop-color="#DB9F84"></stop><stop offset="0.799889" stop-color="#F1BB8A"></stop><stop offset="1" stop-color="#FFD780"></stop></linearGradient><radialGradient id="paint11_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(11.4219 23.1719) rotate(-178.616) scale(3.23532 0.569081)"><stop offset="0.621498" stop-color="#AF5A3E"></stop><stop offset="1" stop-color="#B35445" stop-opacity="0"></stop></radialGradient><radialGradient id="paint12_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(13.625 19.125) rotate(-171.737) scale(15.2205 15.0767)"><stop offset="0.138435" stop-color="#FFB974"></stop><stop offset="0.403618" stop-color="#F2A56D"></stop><stop offset="0.925938" stop-color="#A16948"></stop></radialGradient><linearGradient id="paint13_linear_18_31665" x1="8.22184" y1="13.125" x2="6.81191" y2="15.4996" gradientUnits="userSpaceOnUse"><stop offset="0.610751" stop-color="#984847"></stop><stop offset="0.850075" stop-color="#9A4947" stop-opacity="0"></stop></linearGradient><radialGradient id="paint14_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(7.25 23.7461) scale(11.25 5.68361)"><stop stop-color="#C66364"></stop><stop offset="1" stop-color="#D4766B" stop-opacity="0"></stop></radialGradient><radialGradient id="paint15_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(7.875 23.5313) scale(10.0937 1.29657)"><stop stop-color="#B64B4B"></stop><stop offset="1" stop-color="#C56158" stop-opacity="0"></stop></radialGradient><radialGradient id="paint16_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(11.4375 19.875) rotate(-46.8882) scale(4.02385 7.51767)"><stop stop-color="#FFC083"></stop><stop offset="0.620218" stop-color="#FFBD7D" stop-opacity="0"></stop></radialGradient><linearGradient id="paint17_linear_18_31665" x1="2.8125" y1="13.0312" x2="14.5582" y2="18.9404" gradientUnits="userSpaceOnUse"><stop stop-color="#B89367"></stop><stop offset="1" stop-color="#C5835E"></stop></linearGradient><linearGradient id="paint18_linear_18_31665" x1="8.21875" y1="14.6406" x2="7.59349" y2="15.6717" gradientUnits="userSpaceOnUse"><stop offset="0.351552" stop-color="#A74746"></stop><stop offset="0.845198" stop-color="#A04346" stop-opacity="0"></stop></linearGradient><radialGradient id="paint19_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.5625 14.5625) rotate(140.244) scale(18.3733 13.7403)"><stop stop-color="#FDAE69"></stop><stop offset="0.729021" stop-color="#CE8C4F"></stop><stop offset="0.921546" stop-color="#AD7B45"></stop><stop offset="1" stop-color="#8B6B4A"></stop></radialGradient><radialGradient id="paint20_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.0625 7) rotate(65.3152) scale(11.0745 3.16547)"><stop offset="0.233237" stop-color="#FFD47C"></stop><stop offset="0.853648" stop-color="#FFD98B" stop-opacity="0"></stop></radialGradient><radialGradient id="paint21_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.3125 8.875) rotate(100.886) scale(6.6191 5.57808)"><stop offset="0.128419" stop-color="#FFD88C"></stop><stop offset="0.924134" stop-color="#FFBE7B" stop-opacity="0"></stop></radialGradient><linearGradient id="paint22_linear_18_31665" x1="7.25" y1="15.1875" x2="10.7588" y2="10.3142" gradientUnits="userSpaceOnUse"><stop offset="0.142353" stop-color="#C15F4D"></stop><stop offset="1" stop-color="#D58366" stop-opacity="0"></stop></linearGradient><radialGradient id="paint23_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(8.15625 15.7813) rotate(28.5422) scale(12.5574 1.96589)"><stop offset="0.149989" stop-color="#E4745D"></stop><stop offset="0.453292" stop-color="#C8604C"></stop><stop offset="0.632597" stop-color="#C0605F"></stop><stop offset="1" stop-color="#C0605F" stop-opacity="0"></stop></radialGradient><radialGradient id="paint24_radial_18_31665" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(1.40625 2.69067) rotate(46.0943) scale(22.3963)"><stop offset="0.935802" stop-color="#C17C61" stop-opacity="0"></stop><stop offset="0.982109" stop-color="#C17C61"></stop></radialGradient></defs></svg>

	

	<span>Croissant</span>
	

	<div class="border-br-gray-200 absolute bottom-0.5 right-0.5 h-1 w-1 border-[3px] border-l-transparent border-t-transparent border-b-gray-200 border-r-gray-200 dark:border-b-gray-700 dark:border-r-gray-700"></div></div>
		
		</button>
	
	
	</div>

	<button class="tag tag-ghost px-1! -ml-0.5 mb-1 md:mb-1.5" type="button">+ 1</button></div></div>

		<div class="flex flex-col-reverse lg:flex-row lg:items-center lg:justify-between"><div class="-mb-px flex h-12 items-center overflow-x-auto overflow-y-hidden ">
	<a class="tab-alternate active" href="/datasets/huggingface-course/codeparrot-ds-valid"><svg class="mr-1.5 text-gray-400 flex-none" style="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path class="uim-quaternary" d="M20.23 7.24L12 12L3.77 7.24a1.98 1.98 0 0 1 .7-.71L11 2.76c.62-.35 1.38-.35 2 0l6.53 3.77c.29.173.531.418.7.71z" opacity=".25" fill="currentColor"></path><path class="uim-tertiary" d="M12 12v9.5a2.09 2.09 0 0 1-.91-.21L4.5 17.48a2.003 2.003 0 0 1-1-1.73v-7.5a2.06 2.06 0 0 1 .27-1.01L12 12z" opacity=".5" fill="currentColor"></path><path class="uim-primary" d="M20.5 8.25v7.5a2.003 2.003 0 0 1-1 1.73l-6.62 3.82c-.275.13-.576.198-.88.2V12l8.23-4.76c.175.308.268.656.27 1.01z" fill="currentColor"></path></svg>
	Dataset card
	

	
		</a><a class="tab-alternate" href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/"><svg class="mr-1.5 text-gray-400 flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill="currentColor" d="M2.5 2h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Zm0 2v2h3V4h-3Zm4 0v2h3V4h-3Zm-4 3v2h3V7h-3Zm4 0v2h3V7h-3Z"></path></svg>
	Data Studio
	

	
		</a><a class="tab-alternate" href="/datasets/huggingface-course/codeparrot-ds-valid/tree/main"><svg class="mr-1.5 text-gray-400 flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path class="uim-tertiary" d="M21 19h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2zm0-4h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2zm0-8h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2zm0 4h-8a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2z" opacity=".5" fill="currentColor"></path><path class="uim-primary" d="M9 19a1 1 0 0 1-1-1V6a1 1 0 0 1 2 0v12a1 1 0 0 1-1 1zm-6-4.333a1 1 0 0 1-.64-1.769L3.438 12l-1.078-.898a1 1 0 0 1 1.28-1.538l2 1.667a1 1 0 0 1 0 1.538l-2 1.667a.999.999 0 0 1-.64.231z" fill="currentColor"></path></svg>
	<span class="xl:hidden">Files</span>
		<span class="hidden xl:inline">Files and versions</span>
	

	
		</a><a class="tab-alternate" href="/datasets/huggingface-course/codeparrot-ds-valid/discussions"><svg class="mr-1.5 text-gray-400 flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M20.6081 3C21.7684 3 22.8053 3.49196 23.5284 4.38415C23.9756 4.93678 24.4428 5.82749 24.4808 7.16133C24.9674 7.01707 25.4353 6.93643 25.8725 6.93643C26.9833 6.93643 27.9865 7.37587 28.696 8.17411C29.6075 9.19872 30.0124 10.4579 29.8361 11.7177C29.7523 12.3177 29.5581 12.8555 29.2678 13.3534C29.8798 13.8646 30.3306 14.5763 30.5485 15.4322C30.719 16.1032 30.8939 17.5006 29.9808 18.9403C30.0389 19.0342 30.0934 19.1319 30.1442 19.2318C30.6932 20.3074 30.7283 21.5229 30.2439 22.6548C29.5093 24.3704 27.6841 25.7219 24.1397 27.1727C21.9347 28.0753 19.9174 28.6523 19.8994 28.6575C16.9842 29.4379 14.3477 29.8345 12.0653 29.8345C7.87017 29.8345 4.8668 28.508 3.13831 25.8921C0.356375 21.6797 0.754104 17.8269 4.35369 14.1131C6.34591 12.058 7.67023 9.02782 7.94613 8.36275C8.50224 6.39343 9.97271 4.20438 12.4172 4.20438H12.4179C12.6236 4.20438 12.8314 4.2214 13.0364 4.25468C14.107 4.42854 15.0428 5.06476 15.7115 6.02205C16.4331 5.09583 17.134 4.359 17.7682 3.94323C18.7242 3.31737 19.6794 3 20.6081 3ZM20.6081 5.95917C20.2427 5.95917 19.7963 6.1197 19.3039 6.44225C17.7754 7.44319 14.8258 12.6772 13.7458 14.7131C13.3839 15.3952 12.7655 15.6837 12.2086 15.6837C11.1036 15.6837 10.2408 14.5497 12.1076 13.1085C14.9146 10.9402 13.9299 7.39584 12.5898 7.1776C12.5311 7.16799 12.4731 7.16355 12.4172 7.16355C11.1989 7.16355 10.6615 9.33114 10.6615 9.33114C10.6615 9.33114 9.0863 13.4148 6.38031 16.206C3.67434 18.998 3.5346 21.2388 5.50675 24.2246C6.85185 26.2606 9.42666 26.8753 12.0653 26.8753C14.8021 26.8753 17.6077 26.2139 19.1799 25.793C19.2574 25.7723 28.8193 22.984 27.6081 20.6107C27.4046 20.212 27.0693 20.0522 26.6471 20.0522C24.9416 20.0522 21.8393 22.6726 20.5057 22.6726C20.2076 22.6726 19.9976 22.5416 19.9116 22.222C19.3433 20.1173 28.552 19.2325 27.7758 16.1839C27.639 15.6445 27.2677 15.4256 26.746 15.4263C24.4923 15.4263 19.4358 19.5181 18.3759 19.5181C18.2949 19.5181 18.2368 19.4937 18.2053 19.4419C17.6743 18.557 17.9653 17.9394 21.7082 15.6009C25.4511 13.2617 28.0783 11.8545 26.5841 10.1752C26.4121 9.98141 26.1684 9.8956 25.8725 9.8956C23.6001 9.89634 18.2311 14.9403 18.2311 14.9403C18.2311 14.9403 16.7821 16.496 15.9057 16.496C15.7043 16.496 15.533 16.4139 15.4169 16.2112C14.7956 15.1296 21.1879 10.1286 21.5484 8.06535C21.7928 6.66715 21.3771 5.95917 20.6081 5.95917Z" fill="#FF9D00"></path><path d="M5.50686 24.2246C3.53472 21.2387 3.67446 18.9979 6.38043 16.206C9.08641 13.4147 10.6615 9.33111 10.6615 9.33111C10.6615 9.33111 11.2499 6.95933 12.59 7.17757C13.93 7.39581 14.9139 10.9401 12.1069 13.1084C9.29997 15.276 12.6659 16.7489 13.7459 14.713C14.8258 12.6772 17.7747 7.44316 19.304 6.44221C20.8326 5.44128 21.9089 6.00204 21.5484 8.06532C21.188 10.1286 14.795 15.1295 15.4171 16.2118C16.0391 17.2934 18.2312 14.9402 18.2312 14.9402C18.2312 14.9402 25.0907 8.49588 26.5842 10.1752C28.0776 11.8545 25.4512 13.2616 21.7082 15.6008C17.9646 17.9393 17.6744 18.557 18.2054 19.4418C18.7372 20.3266 26.9998 13.1351 27.7759 16.1838C28.5513 19.2324 19.3434 20.1173 19.9117 22.2219C20.48 24.3274 26.3979 18.2382 27.6082 20.6107C28.8193 22.9839 19.2574 25.7722 19.18 25.7929C16.0914 26.62 8.24723 28.3726 5.50686 24.2246Z" fill="#FFD21E"></path></svg>
	Community
	

	
		</a></div>
	
			</div></div></header>


</div>
	
<div class="container relative flex flex-col md:grid md:space-y-0 w-full md:grid-cols-12 md:flex-1 md:grid-rows-full space-y-4 md:gap-6 ">
		<section class="pt-6 border-gray-100 md:col-span-8 pb-24 relative break-words copiable-code-container">
				<div class="SVELTE_HYDRATER contents" data-target="UnsafeBanner" data-props="{&quot;classNames&quot;:&quot;mb-4&quot;,&quot;repoId&quot;:&quot;huggingface-course/codeparrot-ds-valid&quot;,&quot;repoType&quot;:&quot;dataset&quot;,&quot;minLevel&quot;:&quot;unsafe&quot;}"></div>
					<div class="SVELTE_HYDRATER contents" data-target="DatasetViewer" data-props="{&quot;data&quot;:{&quot;kind&quot;:&quot;DatasetAndSampleData&quot;,&quot;datasetInfo&quot;:[{&quot;isValid&quot;:true,&quot;href&quot;:&quot;&quot;,&quot;label&quot;:&quot;Size of downloaded dataset files:&quot;,&quot;value&quot;:&quot;46.1 MB&quot;},{&quot;isValid&quot;:true,&quot;href&quot;:&quot;/datasets/huggingface-course/codeparrot-ds-valid/tree/refs%2Fconvert%2Fparquet/&quot;,&quot;label&quot;:&quot;Size of the auto-converted Parquet files:&quot;,&quot;value&quot;:&quot;16.1 MB&quot;},{&quot;isValid&quot;:true,&quot;href&quot;:&quot;&quot;,&quot;label&quot;:&quot;Number of rows:&quot;,&quot;value&quot;:&quot;3,322&quot;}],&quot;partial&quot;:false,&quot;configsData&quot;:{&quot;configInfos&quot;:[{&quot;name&quot;:&quot;default&quot;,&quot;status&quot;:&quot;ok&quot;,&quot;numRows&quot;:3322}],&quot;selectedConfig&quot;:&quot;default&quot;,&quot;hasSelectedConfigParquet&quot;:true},&quot;splitsData&quot;:{&quot;splitInfos&quot;:[{&quot;name&quot;:&quot;validation&quot;,&quot;numRows&quot;:3322}],&quot;selectedSplit&quot;:&quot;validation&quot;},&quot;sampleData&quot;:{&quot;dataset&quot;:&quot;huggingface-course/codeparrot-ds-valid&quot;,&quot;config&quot;:&quot;default&quot;,&quot;split&quot;:&quot;validation&quot;,&quot;capabilities&quot;:{&quot;rows&quot;:true,&quot;search&quot;:true,&quot;filter&quot;:true,&quot;statistics&quot;:true},&quot;navigation&quot;:{&quot;p&quot;:0},&quot;jwt&quot;:&quot;eyJhbGciOiJFZERTQSJ9.eyJyZWFkIjp0cnVlLCJwZXJtaXNzaW9ucyI6eyJyZXBvLmNvbnRlbnQucmVhZCI6dHJ1ZX0sImlhdCI6MTc0MjkyMzAxMSwic3ViIjoiL2RhdGFzZXRzL2h1Z2dpbmdmYWNlLWNvdXJzZS9jb2RlcGFycm90LWRzLXZhbGlkIiwiZXhwIjoxNzQyOTI2NjExLCJpc3MiOiJodHRwczovL2h1Z2dpbmdmYWNlLmNvIn0.wpx6I0IIcu88hIrv5BdxCVHUrcNnPW-LPTUkTe2I0HPhQ045OM8Q9sUZ2240n1YSVTf_9etwx5caP7rTwZCaCA&quot;,&quot;sampleData&quot;:{&quot;columns&quot;:[{&quot;name&quot;:&quot;repo_name&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;repo_name&quot;,&quot;column_type&quot;:&quot;string_text&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;min&quot;:7,&quot;max&quot;:92,&quot;mean&quot;:20.85581,&quot;median&quot;:20,&quot;std&quot;:6.55673,&quot;histogram&quot;:{&quot;hist&quot;:[603,2021,563,93,28,10,3,0,0,1],&quot;bin_edges&quot;:[7,16,25,34,43,52,61,70,79,88,92]}}}},{&quot;name&quot;:&quot;path&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;path&quot;,&quot;column_type&quot;:&quot;string_text&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;min&quot;:5,&quot;max&quot;:149,&quot;mean&quot;:37.46478,&quot;median&quot;:35,&quot;std&quot;:17.66866,&quot;histogram&quot;:{&quot;hist&quot;:[433,1152,1086,384,179,60,18,6,3,1],&quot;bin_edges&quot;:[5,20,35,50,65,80,95,110,125,140,149]}}}},{&quot;name&quot;:&quot;copies&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;copies&quot;,&quot;column_type&quot;:&quot;string_text&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;min&quot;:1,&quot;max&quot;:3,&quot;mean&quot;:1.58158,&quot;median&quot;:1,&quot;std&quot;:0.76909,&quot;histogram&quot;:{&quot;hist&quot;:[1968,776,578],&quot;bin_edges&quot;:[1,2,3,3]}}}},{&quot;name&quot;:&quot;size&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;size&quot;,&quot;column_type&quot;:&quot;string_text&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;min&quot;:4,&quot;max&quot;:6,&quot;mean&quot;:4.3239,&quot;median&quot;:4,&quot;std&quot;:0.49249,&quot;histogram&quot;:{&quot;hist&quot;:[2285,998,39],&quot;bin_edges&quot;:[4,5,6,6]}}}},{&quot;name&quot;:&quot;content&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;content&quot;,&quot;column_type&quot;:&quot;string_text&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;min&quot;:911,&quot;max&quot;:692979,&quot;mean&quot;:13206.06924,&quot;median&quot;:5506.5,&quot;std&quot;:27406.87066,&quot;histogram&quot;:{&quot;hist&quot;:[3239,65,8,5,2,1,0,1,0,1],&quot;bin_edges&quot;:[911,70118,139325,208532,277739,346946,416153,485360,554567,623774,692979]}}}},{&quot;name&quot;:&quot;license&quot;,&quot;align&quot;:&quot;depends on text direction&quot;,&quot;type&quot;:&quot;string&quot;,&quot;statistics&quot;:{&quot;column_name&quot;:&quot;license&quot;,&quot;column_type&quot;:&quot;string_label&quot;,&quot;column_statistics&quot;:{&quot;nan_count&quot;:0,&quot;nan_proportion&quot;:0,&quot;no_label_count&quot;:0,&quot;no_label_proportion&quot;:0,&quot;n_unique&quot;:15,&quot;frequencies&quot;:{&quot;bsd-2-clause&quot;:56,&quot;agpl-3.0&quot;:71,&quot;mit&quot;:697,&quot;lgpl-3.0&quot;:29,&quot;bsd-3-clause&quot;:1463,&quot;mpl-2.0&quot;:9,&quot;artistic-2.0&quot;:2,&quot;apache-2.0&quot;:410,&quot;gpl-3.0&quot;:357,&quot;epl-1.0&quot;:4,&quot;cc0-1.0&quot;:10,&quot;isc&quot;:9,&quot;unlicense&quot;:20,&quot;gpl-2.0&quot;:159,&quot;lgpl-2.1&quot;:26}}}}],&quot;rows&quot;:[{&quot;rowIdx&quot;:0,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;ratnania/pigasus&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;doc/manual/include/demo/test_neumann_quartcircle.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;1&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2730&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#! /usr/bin/python\n\n# ...\ntry:\n    from matplotlib import pyplot as plt\n    PLOT=True\nexcept ImportError:\n    PLOT=False\n# ...\nimport numpy                as np\nfrom pigasus.gallery.poisson import *\nimport sys\nimport inspect\nfilename = inspect.getfile(inspect.currentframe()) # script filename (usually with path)\n\n# ...\nsin = np.sin ; cos = np.cos ; pi = np.pi ; exp = np.exp\n# ...\n\n#-----------------------------------\ntry:\n    nx = int(sys.argv[1])\nexcept:\n    nx = 31\n\ntry:\n    ny = int(sys.argv[2])\nexcept:\n    ny = 31\n\ntry:\n    px = int(sys.argv[3])\nexcept:\n    px = 2\n\ntry:\n    py = int(sys.argv[4])\nexcept:\n    py = 2\n\nfrom igakit.cad_geometry import quart_circle as domain\ngeo = domain(n=[nx,ny],p=[px,py])\n#-----------------------------------\n\n# ...\n# exact solution\n# ...\nR = 1.\nr = 0.5\nc = 1. # for neumann\n#c = pi / (R**2-r**2) # for all dirichlet bc\nu = lambda x,y : [ x * y * sin ( c * (R**2 - x**2 - y**2 )) ]\n# ...\n\n# ...\n# rhs\n# ...\nf = lambda x,y : [4*c**2*x**3*y*sin(c*(R**2 - x**2 - y**2)) \\\n                  + 4*c**2*x*y**3*sin(c*(R**2 - x**2 - y**2)) \\\n                  + 12*c*x*y*cos(c*(R**2 - x**2 - y**2)) ]\n# ...\n\n# ...\n# values of gradu.n at the boundary\n# ...\ngradu   = lambda x,y : [-2*c*x**2*y*cos(c*(R**2 - x**2 - y**2)) + y*sin(c*(R**2\n                                                                           -\n                                                                           x**2\n                                                                           -\n                                                                           y**2)) \\\n                       ,-2*c*x*y**2*cos(c*(R**2 - x**2 - y**2)) + x*sin(c*(R**2 - x**2 - y**2)) ]\n\ndef func_g (x,y) :\n    du  = gradu (x, y)\n    return [ du[0] , du[1] ]\n# ...\n\n# ...\n# values of u at the boundary\n# ...\n\nbc_neumann={}\n\nbc_neumann [0,0] = func_g\nDirichlet = [[1,2,3]]\n\n#AllDirichlet = True\n# ...\n\n# ...\ntry:\n    bc_dirichlet\nexcept NameError:\n    bc_dirichlet = None\nelse:\n    pass\n\ntry:\n    bc_neumann\nexcept NameError:\n    bc_neumann = None\nelse:\n    pass\n\ntry:\n    AllDirichlet\nexcept NameError:\n    AllDirichlet = None\nelse:\n    pass\n\ntry:\n    Dirichlet\nexcept NameError:\n    Dirichlet = None\nelse:\n    pass\n\ntry:\n    Metric\nexcept NameError:\n    Metric = None\nelse:\n    pass\n# ...\n\n# ...\nPDE = poisson(geometry=geo, bc_dirichlet=bc_dirichlet, bc_neumann=bc_neumann,\n              AllDirichlet=AllDirichlet, Dirichlet=Dirichlet,metric=Metric)\n# ...\n\n# ...\nPDE.assembly(f=f)\nPDE.solve()\n# ...\n\n# ...\nnormU = PDE.norm(exact=u)\nprint \&quot;norm U   = \&quot;, normU\n# ...\n\n# ...\nif PLOT:\n    PDE.plot()  ; plt.colorbar(); plt.title('$u_h$')\n    plt.savefig(filename.split('.py')[0]+'.png', format='png')\n    plt.clf()\n# ...\n\nPDE.free()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;mit&quot;}}},{&quot;rowIdx&quot;:1,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;devanshdalal/scikit-learn&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;examples/gaussian_process/plot_gpr_noisy_targets.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;64&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;3706&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;\&quot;\&quot;\&quot;\n=========================================================\nGaussian Processes regression: basic introductory example\n=========================================================\n\nA simple one-dimensional regression example computed in two different ways:\n\n1. A noise-free case\n2. A noisy case with known noise-level per datapoint\n\nIn both cases, the kernel's parameters are estimated using the maximum\nlikelihood principle.\n\nThe figures illustrate the interpolating property of the Gaussian Process\nmodel as well as its probabilistic nature in the form of a pointwise 95%\nconfidence interval.\n\nNote that the parameter ``alpha`` is applied as a Tikhonov\nregularization of the assumed covariance between the training points.\n\&quot;\&quot;\&quot;\nprint(__doc__)\n\n# Author: Vincent Dubourg <vincent.dubourg@gmail.com>\n#         Jake Vanderplas <vanderplas@astro.washington.edu>\n#         Jan Hendrik Metzen <jhm@informatik.uni-bremen.de>s\n# License: BSD 3 clause\n\nimport numpy as np\nfrom matplotlib import pyplot as plt\n\nfrom sklearn.gaussian_process import GaussianProcessRegressor\nfrom sklearn.gaussian_process.kernels import RBF, ConstantKernel as C\n\nnp.random.seed(1)\n\n\ndef f(x):\n    \&quot;\&quot;\&quot;The function to predict.\&quot;\&quot;\&quot;\n    return x * np.sin(x)\n\n# ----------------------------------------------------------------------\n#  First the noiseless case\nX = np.atleast_2d([1., 3., 5., 6., 7., 8.]).T\n\n# Observations\ny = f(X).ravel()\n\n# Mesh the input space for evaluations of the real function, the prediction and\n# its MSE\nx = np.atleast_2d(np.linspace(0, 10, 1000)).T\n\n# Instanciate a Gaussian Process model\nkernel = C(1.0, (1e-3, 1e3)) * RBF(10, (1e-2, 1e2))\ngp = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=9)\n\n# Fit to data using Maximum Likelihood Estimation of the parameters\ngp.fit(X, y)\n\n# Make the prediction on the meshed x-axis (ask for MSE as well)\ny_pred, sigma = gp.predict(x, return_std=True)\n\n# Plot the function, the prediction and the 95% confidence interval based on\n# the MSE\nfig = plt.figure()\nplt.plot(x, f(x), 'r:', label=u'$f(x) = x\\,\\sin(x)$')\nplt.plot(X, y, 'r.', markersize=10, label=u'Observations')\nplt.plot(x, y_pred, 'b-', label=u'Prediction')\nplt.fill(np.concatenate([x, x[::-1]]),\n         np.concatenate([y_pred - 1.9600 * sigma,\n                        (y_pred + 1.9600 * sigma)[::-1]]),\n         alpha=.5, fc='b', ec='None', label='95% confidence interval')\nplt.xlabel('$x$')\nplt.ylabel('$f(x)$')\nplt.ylim(-10, 20)\nplt.legend(loc='upper left')\n\n# ----------------------------------------------------------------------\n# now the noisy case\nX = np.linspace(0.1, 9.9, 20)\nX = np.atleast_2d(X).T\n\n# Observations and noise\ny = f(X).ravel()\ndy = 0.5 + 1.0 * np.random.random(y.shape)\nnoise = np.random.normal(0, dy)\ny += noise\n\n# Instanciate a Gaussian Process model\ngp = GaussianProcessRegressor(kernel=kernel, alpha=(dy / y) ** 2,\n                              n_restarts_optimizer=10)\n\n# Fit to data using Maximum Likelihood Estimation of the parameters\ngp.fit(X, y)\n\n# Make the prediction on the meshed x-axis (ask for MSE as well)\ny_pred, sigma = gp.predict(x, return_std=True)\n\n# Plot the function, the prediction and the 95% confidence interval based on\n# the MSE\nfig = plt.figure()\nplt.plot(x, f(x), 'r:', label=u'$f(x) = x\\,\\sin(x)$')\nplt.errorbar(X.ravel(), y, dy, fmt='r.', markersize=10, label=u'Observations')\nplt.plot(x, y_pred, 'b-', label=u'Prediction')\nplt.fill(np.concatenate([x, x[::-1]]),\n         np.concatenate([y_pred - 1.9600 * sigma,\n                        (y_pred + 1.9600 * sigma)[::-1]]),\n         alpha=.5, fc='b', ec='None', label='95% confidence interval')\nplt.xlabel('$x$')\nplt.ylabel('$f(x)$')\nplt.ylim(-10, 20)\nplt.legend(loc='upper left')\n\nplt.show()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;bsd-3-clause&quot;}}},{&quot;rowIdx&quot;:2,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;lordkman/burnman&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;examples/example_geotherms.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;4&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;4049&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;# This file is part of BurnMan - a thermoelastic and thermodynamic toolkit for the Earth and Planetary Sciences\n# Copyright (C) 2012 - 2015 by the BurnMan team, released under the GNU\n# GPL v2 or later.\n\n\n\&quot;\&quot;\&quot;\nexample_geotherms\n-----------------\n\nThis example shows each of the geotherms currently possible with BurnMan.\nThese are:\n\n1. Brown and Shankland, 1981 :cite:`Brown1981`\n2. Anderson, 1982 :cite:`anderson1982earth`\n3. Watson and Baxter, 2007 :cite:`Watson2007`\n4. linear extrapolation\n5. Read in from file from user\n6. Adiabatic from potential temperature and choice of mineral\n\n*Uses:*\n\n* :func:`burnman.geotherm.brown_shankland`\n* :func:`burnman.geotherm.anderson`\n* input geotherm file *input_geotherm/example_geotherm.txt* (optional)\n* :class:`burnman.composite.Composite` for adiabat\n\n*Demonstrates:*\n\n* the available geotherms\n\n\&quot;\&quot;\&quot;\nfrom __future__ import absolute_import\n\nimport os\nimport sys\nimport numpy as np\nimport matplotlib.pyplot as plt\n# hack to allow scripts to be placed in subdirectories next to burnman:\nif not os.path.exists('burnman') and os.path.exists('../burnman'):\n    sys.path.insert(1, os.path.abspath('..'))\n\nimport burnman\nfrom burnman import minerals\n\nif __name__ == \&quot;__main__\&quot;:\n    # we want to evaluate several geotherms at these values\n    pressures = np.arange(9.0e9, 128e9, 3e9)\n    seismic_model = burnman.seismic.PREM()\n    depths = seismic_model.depth(pressures)\n    # load two builtin geotherms and evaluate the temperatures at all pressures\n    temperature1 = burnman.geotherm.brown_shankland(depths)\n    temperature2 = burnman.geotherm.anderson(depths)\n\n    # a geotherm is actually just a function that returns a list of temperatures given pressures in Pa\n    # so we can just write our own function\n    my_geotherm_function = lambda p: [1500 + (2500 - 1500) * x / 128e9 for x in p]\n    temperature3 = my_geotherm_function(pressures)\n\n    # what about a geotherm defined from datapoints given in a file (our\n    # inline)?\n    table = [[1e9, 1600], [30e9, 1700], [130e9, 2700]]\n    # this could also be loaded from a file, just uncomment this\n    # table = burnman.tools.read_table(\&quot;input_geotherm/example_geotherm.txt\&quot;)\n\n    table_pressure = np.array(table)[:, 0]\n    table_temperature = np.array(table)[:, 1]\n\n    my_geotherm_interpolate = lambda p: [np.interp(x, table_pressure,\n                                                    table_temperature) for x in p]\n\n    temperature4 = my_geotherm_interpolate(pressures)\n\n    # finally, we can also calculate a self consistent\n    # geotherm for an assemblage of minerals\n    # based on self compression of the composite rock.\n    # First we need to define an assemblage\n    amount_perovskite = 0.8\n    fe_pv = 0.05\n    fe_pc = 0.2\n    pv = minerals.SLB_2011.mg_fe_perovskite()\n    pc = minerals.SLB_2011.ferropericlase()\n    pv.set_composition([1. - fe_pv, fe_pv, 0.])\n    pc.set_composition([1. - fe_pc, fe_pc])\n    example_rock = burnman.Composite(\n        [pv, pc], [amount_perovskite, 1.0 - amount_perovskite])\n\n    # next, define an anchor temperature at which we are starting.\n    # Perhaps 1500 K for the upper mantle\n    T0 = 1500.\n    # then generate temperature values using the self consistent function.\n    # This takes more time than the above methods\n    temperature5 = burnman.geotherm.adiabatic(pressures, T0, example_rock)\n\n    # you can also look at burnman/geotherm.py to see how the geotherms are\n    # implemented\n\n    plt.plot(pressures / 1e9, temperature1, '-r', label=\&quot;Brown, Shankland\&quot;)\n    plt.plot(pressures / 1e9, temperature2, '-c', label=\&quot;Anderson\&quot;)\n    plt.plot(pressures / 1e9, temperature3, '-b', label=\&quot;handwritten linear\&quot;)\n    plt.plot(pressures / 1e9, temperature4,\n             '-k', label=\&quot;handwritten from table\&quot;)\n    plt.plot(pressures / 1e9, temperature5, '-m',\n             label=\&quot;Adiabat with pv (70%) and fp(30%)\&quot;)\n\n    plt.legend(loc='lower right')\n    plt.xlim([8.5, 130])\n    plt.xlabel('Pressure/GPa')\n    plt.ylabel('Temperature')\n    plt.savefig(\&quot;output_figures/example_geotherm.png\&quot;)\n    plt.show()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;gpl-2.0&quot;}}},{&quot;rowIdx&quot;:3,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;francesco-mannella/dmp-esn&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;parametric/parametric_dmp/bin/tr_datasets/e_cursive_curves_angles_start_none/results/plot.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;18&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;1043&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#!/usr/bin/env python\n\nimport glob \nimport numpy as np\nimport matplotlib.pyplot as plt\n\nimport os\nimport sys\n\n\npathname = os.path.dirname(sys.argv[0])\nif pathname:\n    os.chdir(pathname)\n\nn_dim = None\ntrains = []\nfor fname in glob.glob(\&quot;tl*\&quot;):\n    t = np.loadtxt(fname)\n    trains.append(t)\n\ntests = []\nfor fname in glob.glob(\&quot;tt*\&quot;):\n    t = np.loadtxt(fname)\n    tests.append(t)\n\ntrial_results= []\nfor fname in glob.glob(\&quot;rtl*\&quot;):\n    t = np.loadtxt(fname)\n    trial_results.append(t)\n\ntest_results= []\nfor fname in glob.glob(\&quot;rtt*\&quot;):\n    t = np.loadtxt(fname)\n    test_results.append(t)\n\nfig = plt.figure()\nax = fig.add_subplot(111, aspect=\&quot;equal\&quot;)\nfor d in trains:\n    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=\&quot;blue\&quot;, lw=3, alpha=0.5)\nfor d in tests: \n    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=\&quot;red\&quot;,  lw=3, alpha=0.5)\nfor d in trial_results:\n    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=[0,0,.5],  lw=2)\nfor d in test_results:\n    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=[.5,0,0],  lw=2)\nplt.show()\n\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;gpl-2.0&quot;}}},{&quot;rowIdx&quot;:4,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;flowersteam/SESM&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;SESM/pykinect.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;3387&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;import zmq\nimport numpy\nimport threading\n\nfrom collections import namedtuple\n\nPoint2D = namedtuple('Point2D', ('x', 'y'))\nPoint3D = namedtuple('Point3D', ('x', 'y', 'z'))\nQuaternion = namedtuple('Quaternion', ('x', 'y', 'z', 'w'))\n\ntorso_joints = ('hip_center', 'spine', 'shoulder_center', 'head')\nleft_arm_joints = ('shoulder_left', 'elbow_left', 'wrist_left', 'hand_left')\nright_arm_joints = ('shoulder_right', 'elbow_right', 'wrist_right', 'hand_right')\nleft_leg_joints = ('hip_left', 'knee_left', 'ankle_left', 'foot_left')\nright_leg_joints = ('hip_right', 'knee_right', 'ankle_right', 'foot_right')\nskeleton_joints = torso_joints + left_arm_joints + right_arm_joints + left_leg_joints + right_leg_joints\n\n\nclass Skeleton(namedtuple('Skeleton', ('timestamp', 'user_id') + skeleton_joints)):\n    joints = skeleton_joints\n\n    @property\n    def to_np(self):\n        l = []\n        \n        for j in self.joints:\n            p = getattr(self, j).position\n            l.append((p.x, p.y, p.z))\n            \n        return numpy.array(l)\n            \nJoint = namedtuple('Joint', ('position', 'orientation', 'pixel_coordinate'))\n\n\nclass KinectSensor(object):\n    def __init__(self, addr, port):\n        self._lock = threading.Lock()\n        self._skeleton = None\n\n        context = zmq.Context()\n        self.socket = context.socket(zmq.REQ)\n        self.socket.connect('tcp://{}:{}'.format(addr, port))\n\n        t = threading.Thread(target=self.get_skeleton)\n        t.daemon = True\n        t.start()\n\n    @property\n    def tracked_skeleton(self):\n        with self._lock:\n            return self._skeleton\n\n    @tracked_skeleton.setter\n    def tracked_skeleton(self, skeleton):\n        with self._lock:\n            self._skeleton = skeleton\n\n    def get_skeleton(self):\n        while True:\n            self.socket.send('Hello')\n\n            md = self.socket.recv_json()\n            msg = self.socket.recv()\n\n            skeleton_array = numpy.frombuffer(buffer(msg), dtype=md['dtype'])\n            skeleton_array = skeleton_array.reshape(md['shape'])\n\n            joints = []\n            for i in range(len(skeleton_joints)):\n                x, y, z, w = skeleton_array[i][0:4]\n                position = Point3D(x / w, y / w, z / w)\n                pixel_coord = Point2D(*skeleton_array[i][4:6])\n                orientation = Quaternion(*skeleton_array[i][6:10])\n                joints.append(Joint(position, orientation, pixel_coord))\n\n            self.tracked_skeleton = Skeleton(md['timestamp'], md['user_index'], *joints)\n\n\ndef draw_position(skel, ax):\n    xy, zy = [], []\n\n    if not skel:\n        return\n\n    for j in skeleton_joints:\n        p = getattr(skel, j).position\n        xy.append((p.x, p.y))\n        zy.append((p.z, p.y))\n\n    ax.set_xlim(-2, 5)\n    ax.set_ylim(-1.5, 1.5)\n    ax.scatter(zip(*xy)[0], zip(*xy)[1], 30, 'b')\n    ax.scatter(zip(*zy)[0], zip(*zy)[1], 30, 'r')\n\n\nif __name__ == '__main__':\n    import time\n\n    import matplotlib.pyplot as plt\n    plt.ion()\n    fig = plt.figure()\n    ax = fig.add_subplot(111)\n\n    kinect_sensor = KinectSensor('193.50.110.210', 9999)\n\n    import skelangle\n\n    kinect_angle = skelangle.AngleFromSkel()\n\n    try:\n        while True:\n            ax.clear()\n            draw_position(kinect_sensor.tracked_skeleton, ax)\n            plt.draw()\n            time.sleep(0.1)\n    except KeyboardInterrupt:\n        plt.close('all')\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;gpl-3.0&quot;}}},{&quot;rowIdx&quot;:5,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;gwparikh/cvgui&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;grouping_calibration.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;9402&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#!/usr/bin/env python\n\nimport os, sys, subprocess\nimport argparse\nimport subprocess\nimport threading\nimport timeit\nfrom multiprocessing import Queue, Lock\nfrom configobj import ConfigObj\nfrom numpy import loadtxt\nfrom numpy.linalg import inv\nimport matplotlib.pyplot as plt\nimport moving\nfrom cvguipy import trajstorage, cvgenetic, cvconfig\n\n\&quot;\&quot;\&quot; \nGrouping Calibration By Genetic Algorithm.\nThis script uses genetic algorithm to search for the best configuration.\n\nIt does not monitor RAM usage, therefore, CPU thrashing might be happened when number of parents (selection size) is too large. \n\&quot;\&quot;\&quot;\n# class for genetic algorithm\nclass GeneticCompare(object):\n    def __init__(self, motalist, motplist, IDlist, cfg_list, lock):\n        self.motalist = motalist\n        self.motplist = motplist\n        self.IDlist = IDlist\n        self.cfg_list = cfg_list\n        self.lock = lock\n    \n    # This is used for calculte fitness of individual in genetic algorithn.\n    # It is modified to create sqlite and cfg file before tuning computeClearMOT.\n    # NOTE errors show up when loading two same ID\n    def computeMOT(self, i):\n        \n        # create sqlite and cfg file with id i\n        cfg_name = config_files +str(i)+'.cfg'\n        sql_name = sqlite_files +str(i)+'.sqlite'\n        open(cfg_name,'w').close()\n        config = ConfigObj(cfg_name)\n        cfg_list.write_config(i ,config)\n        command = ['cp', 'tracking_only.sqlite', sql_name]\n        process = subprocess.Popen(command)\n        process.wait()\n        command = ['trajextract.py', args.inputVideo, '-o', args.homography, '-t', cfg_name, '-d', sql_name, '--gf']\n        # suppress output of grouping extraction\n        devnull = open(os.devnull, 'wb')\n        process = subprocess.Popen(command, stdout = devnull)\n        process.wait()\n        \n        obj = trajstorage.CVsqlite(sql_name)\n        print \&quot;loading\&quot;, i\n        obj.loadObjects()\n        motp, mota, mt, mme, fpt, gt = moving.computeClearMOT(cdb.annotations, obj.objects, args.matchDistance, firstFrame, lastFrame)\n        if motp is None:\n            motp = 0\n        self.lock.acquire()\n        self.IDlist.put(i)\n        self.motplist.put(motp)\n        self.motalist.put(mota)\n        obj.close()\n        if args.PrintMOTA:\n            print(\&quot;ID: mota:{} motp:{}\&quot;.format(mota, motp))\n        self.lock.release()\n            \n        return mota\n        \nif __name__ == '__main__' :\n    parser = argparse.ArgumentParser(description=\&quot;compare all sqlites that are created by cfg_combination.py to the Annotated version to find the ID of the best configuration\&quot;)\n    parser.add_argument('inputVideo', help= \&quot;input video filename\&quot;)\n    parser.add_argument('-r', '--configuration-file', dest='range_cfg', help= \&quot;the configuration-file contain the range of configuration\&quot;)\n    parser.add_argument('-t', '--traffintel-config', dest='traffintelConfig', help= \&quot;the TrafficIntelligence file to use for running the first extraction.\&quot;)\n    parser.add_argument('-m', '--mask-File', dest='maskFilename', help=\&quot;Name of the mask-File for trajextract\&quot;)\n    parser.add_argument('-d', '--database-file', dest ='databaseFile', help =\&quot;Name of the databaseFile.\&quot;)\n    parser.add_argument('-o', '--homography-file', dest ='homography', help = \&quot;Name of the homography file.\&quot;, required = True)\n    parser.add_argument('-md', '--matching-distance', dest='matchDistance', help = \&quot;matchDistance\&quot;, default = 10, type = float)\n    parser.add_argument('-a', '--accuracy', dest = 'accuracy', help = \&quot;accuracy parameter for genetic algorithm\&quot;, type = int)\n    parser.add_argument('-p', '--population', dest = 'population', help = \&quot;population parameter for genetic algorithm\&quot;, required = True, type = int)\n    parser.add_argument('-np', '--num-of-parents', dest = 'num_of_parents', help = \&quot;Number of parents that are selected each generation\&quot;, type = int)\n    parser.add_argument('-mota', '--print-MOTA', dest='PrintMOTA', action = 'store_true', help = \&quot;Print MOTA for each ID.\&quot;)\n    args = parser.parse_args()\n    \n    os.mkdir('cfg_files')\n    os.mkdir('sql_files')\n    sqlite_files = \&quot;sql_files/Sqlite_ID_\&quot;\n    config_files = \&quot;cfg_files/Cfg_ID_\&quot;\n    \n    # ------------------initialize annotated version if not existed ---------- #\n    # inputVideo check\n    if not os.path.exists(args.inputVideo):\n        print(\&quot;Input video {} does not exist! Exiting...\&quot;.format(args.inputVideo))\n        sys.exit(1)\n\n    # configuration file check\n    if args.range_cfg is None:\n        config = ConfigObj('range.cfg')\n    else:\n        config = ConfigObj(args.range_cfg)\n\n    # get configuration and put them to a List\n    cfg_list = cvconfig.CVConfigList()\n    thread_cfgtolist = threading.Thread(target = cvconfig.config_to_list, args = (cfg_list, config))\n    thread_cfgtolist.start();\n    # check if dbfile name is entered\n    if args.databaseFile is None:\n        print(\&quot;Database-file is not entered, running trajextract and cvplayer.\&quot;)\n        if not os.path.exists(args.homography):\n            print(\&quot;Homography file does not exist! Exiting...\&quot;)\n            sys.exit(1)\n        else:\n            videofile=args.inputVideo\n            if 'avi' in videofile:\n                if args.maskFilename is not None:\n                    command = ['trajextract.py',args.inputVideo,'-m', args.maskFilename,'-o', args.homography]\n                else:\n                    command = ['trajextract.py',args.inputVideo,'-o', args.homography]\n                process = subprocess.Popen(command)\n                process.wait()\n                databaseFile = videofile.replace('avi','sqlite')\n                command = ['cvplayer.py',args.inputVideo,'-d',databaseFile,'-o',args.homography]\n                process = subprocess.Popen(command)\n                process.wait()\n            else:\n                print(\&quot;Input video {} is not 'avi' type. Exiting...\&quot;.format(args.inputVideo))\n                sys.exit(1)\n    else:\n        databaseFile = args.databaseFile\n    thread_cfgtolist.join()\n    # ------------------Done initialization for annotation-------------------- #\n    \n    # create first tracking only database template.\n    print(\&quot;creating the first tracking only database template.\&quot;)\n    if args.maskFilename is not None:\n        command = map(str, ['trajextract.py',args.inputVideo, '-d', 'tracking_only.sqlite', '-t', args.traffintelConfig, '-o', args.homography, '-m', args.maskFilename, '--tf'])\n    else:\n        command = map(str, ['trajextract.py',args.inputVideo, '-d', sql_name, '-t', args.traffintelConfig, '-o', args.homography, '--tf'])\n    process = subprocess.Popen(command)\n    process.wait()\n    # ----start using genetic algorithm to search for best configuration-------#\n    start = timeit.default_timer()\n    \n    dbfile = databaseFile;\n    homography = loadtxt(args.homography)\n    \n    cdb = trajstorage.CVsqlite(dbfile)\n    cdb.open()\n    cdb.getLatestAnnotation()\n    cdb.createBoundingBoxTable(cdb.latestannotations, inv(homography))\n    cdb.loadAnnotaion()\n    for a in cdb.annotations:\n        a.computeCentroidTrajectory(homography)\n    print \&quot;Latest Annotaions in \&quot;+dbfile+\&quot;: \&quot;, cdb.latestannotations\n    \n    cdb.frameNumbers = cdb.getFrameList()\n    firstFrame = cdb.frameNumbers[0]\n    lastFrame = cdb.frameNumbers[-1]\n    \n    foundmota = Queue()\n    foundmotp = Queue()\n    IDs = Queue()\n    lock = Lock()\n    \n    Comp = GeneticCompare(foundmota, foundmotp, IDs, cfg_list, lock)\n    if args.accuracy != None:\n        GeneticCal = cvgenetic.CVGenetic(args.population, cfg_list, Comp.computeMOT, args.accuracy)\n    else:\n        GeneticCal = cvgenetic.CVGenetic(args.population, cfg_list, Comp.computeMOT)\n    if args.num_of_parents != None:\n        GeneticCal.run_thread(args.num_of_parents)\n    else:\n        GeneticCal.run_thread()\n    \n    # tranform queues to lists\n    foundmota = cvgenetic.Queue_to_list(foundmota)\n    foundmotp = cvgenetic.Queue_to_list(foundmotp)\n    IDs = cvgenetic.Queue_to_list(IDs)\n\n    for i in range(len(foundmotp)):\n        foundmotp[i] /= args.matchDistance\n    Best_mota = max(foundmota)\n    Best_ID = IDs[foundmota.index(Best_mota)]\n    print \&quot;Best multiple object tracking accuracy (MOTA)\&quot;, Best_mota\n    print \&quot;ID:\&quot;, Best_ID\n    stop = timeit.default_timer()\n    print str(stop-start) + \&quot;s\&quot;\n    \n    total = []\n    for i in range(len(foundmota)):\n        total.append(foundmota[i]- 0.1 * foundmotp[i])\n    Best_total = max(total)\n    Best_total_ID = IDs[total.index(Best_total)]\n    # ------------------------------Done searching----------------------------#\n    # use matplot to plot a graph of all calculated IDs along with thier mota\n    plt.figure(1)\n    plt.plot(foundmota ,IDs ,'bo')\n    plt.plot(foundmotp ,IDs ,'yo')\n    plt.plot(Best_mota, Best_ID, 'ro')\n    plt.axis([-1, 1, -1, cfg_list.get_total_combination()])\n    plt.xlabel('mota')\n    plt.ylabel('ID')\n    plt.title(b'Best MOTA: '+str(Best_mota) +'\\nwith ID: '+str(Best_ID))\n    plotFile = os.path.splitext(dbfile)[0] + '_CalibrationResult_mota.png'\n    plt.savefig(plotFile)\n    \n    plt.figure(2)\n    plt.plot(total, IDs, 'bo')\n    plt.plot(Best_total, Best_total_ID, 'ro')\n    plt.xlabel('mota + motp')\n    plt.ylabel('ID')\n    plt.title(b'Best total: '+str(Best_total) +'\\nwith ID: '+str(Best_total_ID))\n    \n    # save the plot\n    plotFile = os.path.splitext(dbfile)[0] + '_CalibrationResult_motp.png'\n    plt.savefig(plotFile)\n    \n    plt.show()\n    \n    cdb.close()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;mit&quot;}}},{&quot;rowIdx&quot;:6,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;keflavich/pyspeckit-obsolete&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;pyspeckit/spectrum/models/ammonia.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;1&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;28836&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;\&quot;\&quot;\&quot;\n========================================\nAmmonia inversion transition TKIN fitter\n========================================\n\nAmmonia inversion transition TKIN fitter translated from Erik Rosolowsky's\nhttp://svn.ok.ubc.ca/svn/signals/nh3fit/\n\n.. moduleauthor:: Adam Ginsburg <adam.g.ginsburg@gmail.com>\n\nModule API\n^^^^^^^^^^\n\n\&quot;\&quot;\&quot;\nimport numpy as np\nfrom pyspeckit.mpfit import mpfit\nfrom pyspeckit.spectrum.parinfo import ParinfoList,Parinfo\nimport fitter\nimport matplotlib.cbook as mpcb\nimport copy\nimport model\n\n\nline_names = ['oneone','twotwo','threethree','fourfour']\n\nfreq_dict = { \n    'oneone':     23.694506e9,\n    'twotwo':     23.722633335e9,\n    'threethree': 23.8701296e9,\n    'fourfour':   24.1394169e9,\n    }\naval_dict = {\n    'oneone':     1.712e-7,  #64*!pi**4/(3*h*c**3)*nu11**3*mu0**2*(1/2.)\n    'twotwo':     2.291e-7,  #64*!pi**4/(3*h*c**3)*nu22**3*mu0**2*(2/3.)\n    'threethree': 2.625e-7,  #64*!pi**4/(3*h*c**3)*nu33**3*mu0**2*(3/4.)\n    'fourfour':   3.167e-7,  #64*!pi**4/(3*h*c**3)*nu44**3*mu0**2*(4/5.)\n    }\northo_dict = {\n    'oneone':     False,\n    'twotwo':     False,\n    'threethree': True,\n    'fourfour':   False,\n    }\nn_ortho = np.arange(0,28,3) # 0..3..27\nn_para = np.array([x for x in range(28) if x % 3 != 0])\n\nvoff_lines_dict = {\n    'oneone': [19.8513, 19.3159, 7.88669, 7.46967, 7.35132, 0.460409, 0.322042,\n        -0.0751680, -0.213003, 0.311034, 0.192266, -0.132382, -0.250923, -7.23349,\n        -7.37280, -7.81526, -19.4117, -19.5500],\n    'twotwo':[26.5263, 26.0111, 25.9505, 16.3917, 16.3793, 15.8642, 0.562503,\n        0.528408, 0.523745, 0.0132820, -0.00379100, -0.0132820, -0.501831,\n        -0.531340, -0.589080, -15.8547, -16.3698, -16.3822, -25.9505, -26.0111,\n        -26.5263],\n    'threethree':[29.195098, 29.044147, 28.941877, 28.911408, 21.234827,\n        21.214619, 21.136387, 21.087456, 1.005122, 0.806082, 0.778062,\n        0.628569, 0.016754, -0.005589, -0.013401, -0.639734, -0.744554,\n        -1.031924, -21.125222, -21.203441, -21.223649, -21.076291, -28.908067,\n        -28.938523, -29.040794, -29.191744],\n    'fourfour':[  0.        , -30.49783692,  30.49783692,   0., 24.25907811,\n        -24.25907811,   0.        ]\n                      }\n\ntau_wts_dict = {\n    'oneone': [0.0740740, 0.148148, 0.0925930, 0.166667, 0.0185190, 0.0370370,\n        0.0185190, 0.0185190, 0.0925930, 0.0333330, 0.300000, 0.466667,\n        0.0333330, 0.0925930, 0.0185190, 0.166667, 0.0740740, 0.148148],\n    'twotwo': [0.00418600, 0.0376740, 0.0209300, 0.0372090, 0.0260470,\n        0.00186000, 0.0209300, 0.0116280, 0.0106310, 0.267442, 0.499668,\n        0.146512, 0.0116280, 0.0106310, 0.0209300, 0.00186000, 0.0260470,\n        0.0372090, 0.0209300, 0.0376740, 0.00418600],\n    'threethree': [0.012263, 0.008409, 0.003434, 0.005494, 0.006652, 0.008852,\n        0.004967, 0.011589, 0.019228, 0.010387, 0.010820, 0.009482, 0.293302,\n        0.459109, 0.177372, 0.009482, 0.010820, 0.019228, 0.004967, 0.008852,\n        0.006652, 0.011589, 0.005494, 0.003434, 0.008409, 0.012263],\n    'fourfour': [0.2431, 0.0162, 0.0162, 0.3008, 0.0163, 0.0163, 0.3911]}\n\ndef ammonia(xarr, tkin=20, tex=None, ntot=1e14, width=1,\n        xoff_v=0.0, fortho=0.0, tau=None, fillingfraction=None, return_tau=False,\n        thin=False, verbose=False, return_components=False, debug=False ):\n    \&quot;\&quot;\&quot;\n    Generate a model Ammonia spectrum based on input temperatures, column, and\n    gaussian parameters\n\n    ntot can be specified as a column density (e.g., 10^15) or a log-column-density (e.g., 15)\n\n    tex can be specified or can be assumed LTE if unspecified, if tex>tkin, or if \&quot;thin\&quot;\n        is specified\n\n    \&quot;thin\&quot; uses a different parametetrization and requires only the optical depth, width, offset,\n        and tkin to be specified.  In the 'thin' approximation, tex is not used in computation of\n        the partition function - LTE is implicitly assumed\n\n    If tau is specified, ntot is NOT fit but is set to a fixed value\n    fillingfraction is an arbitrary scaling factor to apply to the model\n    fortho is the ortho/(ortho+para) fraction.  The default is to assume all ortho.\n    xoff_v is the velocity offset in km/s \n\n    tau refers to the optical depth of the 1-1 line.  The optical depths of the\n    other lines are fixed relative to tau_oneone\n\n    (not implemented) if tau is specified, ntot is ignored\n    \&quot;\&quot;\&quot;\n\n    # Convert X-units to frequency in GHz\n    xarr = xarr.as_unit('GHz')\n\n    if tex is not None:\n        if tex > tkin: # cannot have Tex > Tkin\n            tex = tkin \n        elif thin: # tex is not used in this case\n            tex = tkin\n    else:\n        tex = tkin\n\n    if thin:\n        ntot = 1e15\n    elif 5 < ntot < 25: \n        # allow ntot to be specified as a logarithm.  This is\n        # safe because ntot < 1e10 gives a spectrum of all zeros, and the\n        # plausible range of columns is not outside the specified range\n        ntot = 10**ntot\n    elif (25 < ntot < 1e5) or (ntot < 5):\n        # these are totally invalid for log/non-log\n        return 0\n\n    # fillingfraction is an arbitrary scaling for the data\n    # The model will be (normal model) * fillingfraction\n    if fillingfraction is None:\n        fillingfraction = 1.0\n\n    ckms = 2.99792458e5\n    ccms = ckms*1e5\n    g1 = 1                \n    g2 = 1                \n    h = 6.6260693e-27     \n    kb = 1.3806505e-16     \n    mu0 = 1.476e-18               # Dipole Moment in cgs (1.476 Debeye)\n  \n    # Generate Partition Functions  \n    nlevs = 51\n    jv=np.arange(nlevs)\n    ortho = jv % 3 == 0\n    para = True-ortho\n    Jpara = jv[para]\n    Jortho = jv[ortho]\n    Brot = 298117.06e6\n    Crot = 186726.36e6\n\n    runspec = np.zeros(len(xarr))\n    \n    tau_dict = {}\n    para_count = 0\n    ortho_count = 1 # ignore 0-0\n\n    if tau is not None and thin:\n        \&quot;\&quot;\&quot;\n        Use optical depth in the 1-1 line as a free parameter\n        The optical depths of the other lines are then set by the kinetic temperature\n        Tex is still a free parameter in the final spectrum calculation at the bottom\n        (technically, I think this process assumes LTE; Tex should come into play in\n        these equations, not just the final one)\n        \&quot;\&quot;\&quot;\n        dT0 = 41.5                    # Energy diff between (2,2) and (1,1) in K\n        trot = tkin/(1+tkin/dT0*np.log(1+0.6*np.exp(-15.7/tkin)))\n        tau_dict['oneone']     = tau\n        tau_dict['twotwo']     = tau*(23.722/23.694)**2*4/3.*5/3.*np.exp(-41.5/trot)\n        tau_dict['threethree'] = tau*(23.8701279/23.694)**2*3/2.*14./3.*np.exp(-101.1/trot)\n        tau_dict['fourfour']   = tau*(24.1394169/23.694)**2*8/5.*9/3.*np.exp(-177.34/trot)\n    else:\n        \&quot;\&quot;\&quot;\n        Column density is the free parameter.  It is used in conjunction with\n        the full partition function to compute the optical depth in each band\n        Given the complexity of these equations, it would be worth my while to\n        comment each step carefully.  \n        \&quot;\&quot;\&quot;\n        Zpara = (2*Jpara+1)*np.exp(-h*(Brot*Jpara*(Jpara+1)+\n            (Crot-Brot)*Jpara**2)/(kb*tkin))\n        Zortho = 2*(2*Jortho+1)*np.exp(-h*(Brot*Jortho*(Jortho+1)+\n            (Crot-Brot)*Jortho**2)/(kb*tkin))\n        for linename in line_names:\n            if ortho_dict[linename]:\n                orthoparafrac = fortho\n                Z = Zortho \n                count = ortho_count\n                ortho_count += 1\n            else:\n                orthoparafrac = 1.0-fortho\n                Z = Zpara\n                count = para_count # need to treat partition function separately\n                para_count += 1\n            tau_dict[linename] = (ntot * orthoparafrac * Z[count]/(Z.sum()) / ( 1\n                + np.exp(-h*freq_dict[linename]/(kb*tkin) )) * ccms**2 /\n                (8*np.pi*freq_dict[linename]**2) * aval_dict[linename]*\n                (1-np.exp(-h*freq_dict[linename]/(kb*tex))) /\n                (width/ckms*freq_dict[linename]*np.sqrt(2*np.pi)) )\n\n    # allow tau(11) to be specified instead of ntot\n    # in the thin case, this is not needed: ntot plays no role\n    # this process allows you to specify tau without using the approximate equations specified\n    # above.  It should remove ntot from the calculations anyway...\n    if tau is not None and not thin:\n        tau11_temp = tau_dict['oneone']\n        # re-scale all optical depths so that tau is as specified, but the relative taus\n        # are sest by the kinetic temperature and partition functions\n        for linename,t in tau_dict.iteritems():\n            tau_dict[linename] = t * tau/tau11_temp\n\n    components =[]\n    for linename in line_names:\n        voff_lines = np.array(voff_lines_dict[linename])\n        tau_wts = np.array(tau_wts_dict[linename])\n  \n        lines = (1-voff_lines/ckms)*freq_dict[linename]/1e9\n        tau_wts = tau_wts / (tau_wts).sum()\n        nuwidth = np.abs(width/ckms*lines)\n        nuoff = xoff_v/ckms*lines\n  \n        # tau array\n        tauprof = np.zeros(len(xarr))\n        for kk,no in enumerate(nuoff):\n            tauprof += (tau_dict[linename] * tau_wts[kk] *\n                    np.exp(-(xarr+no-lines[kk])**2 / (2.0*nuwidth[kk]**2)) *\n                    fillingfraction)\n            components.append( tauprof )\n  \n        T0 = (h*xarr*1e9/kb) # \&quot;temperature\&quot; of wavelength\n        if tau is not None and thin:\n            #runspec = tauprof+runspec\n            # is there ever a case where you want to ignore the optical depth function? I think no\n            runspec = (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-tauprof))+runspec\n        else:\n            runspec = (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-tauprof))+runspec\n        if runspec.min() < 0:\n            raise ValueError(\&quot;Model dropped below zero.  That is not possible normally.  Here are the input values: \&quot;+\n                    (\&quot;tex: %f \&quot; % tex) + \n                    (\&quot;tkin: %f \&quot; % tkin) + \n                    (\&quot;ntot: %f \&quot; % ntot) + \n                    (\&quot;width: %f \&quot; % width) + \n                    (\&quot;xoff_v: %f \&quot; % xoff_v) + \n                    (\&quot;fortho: %f \&quot; % fortho)\n                    )\n\n    if verbose or debug:\n        print \&quot;tkin: %g  tex: %g  ntot: %g  width: %g  xoff_v: %g  fortho: %g  fillingfraction: %g\&quot; % (tkin,tex,ntot,width,xoff_v,fortho,fillingfraction)\n\n    if return_components:\n        return (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-1*np.array(components)))\n\n    if return_tau:\n        return tau_dict\n  \n    return runspec\n\nclass ammonia_model(model.SpectralModel):\n\n    def __init__(self,npeaks=1,npars=6,multisingle='multi',**kwargs):\n        self.npeaks = npeaks\n        self.npars = npars\n        self._default_parnames = ['tkin','tex','ntot','width','xoff_v','fortho']\n        self.parnames = copy.copy(self._default_parnames)\n\n        # all fitters must have declared modelfuncs, which should take the fitted pars...\n        self.modelfunc = ammonia\n        self.n_modelfunc = self.n_ammonia\n\n        # for fitting ammonia simultaneously with a flat background\n        self.onepeakammonia = fitter.vheightmodel(ammonia)\n        #self.onepeakammoniafit = self._fourparfitter(self.onepeakammonia)\n\n        if multisingle in ('multi','single'):\n            self.multisingle = multisingle\n        else:\n            raise Exception(\&quot;multisingle must be multi or single\&quot;)\n\n        self.default_parinfo = None\n        self.default_parinfo, kwargs = self._make_parinfo(**kwargs)\n\n        # enforce ammonia-specific parameter limits\n        for par in self.default_parinfo:\n            if 'tex' in par.parname.lower():\n                par.limited = (True,par.limited[1])\n                par.limits = (max(par.limits[0],2.73), par.limits[1])\n            if 'tkin' in par.parname.lower():\n                par.limited = (True,par.limited[1])\n                par.limits = (max(par.limits[0],2.73), par.limits[1])\n            if 'width' in par.parname.lower():\n                par.limited = (True,par.limited[1])\n                par.limits = (max(par.limits[0],0), par.limits[1])\n            if 'fortho' in par.parname.lower():\n                par.limited = (True,True)\n                if par.limits[1] != 0:\n                    par.limits = (max(par.limits[0],0), min(par.limits[1],1))\n                else:\n                    par.limits = (max(par.limits[0],0), 1)\n            if 'ntot' in par.parname.lower():\n                par.limited = (True,par.limited[1])\n                par.limits = (max(par.limits[0],0), par.limits[1])\n\n        self.parinfo = copy.copy(self.default_parinfo)\n\n\n        self.modelfunc_kwargs = kwargs\n        # lower case? self.modelfunc_kwargs.update({'parnames':self.parinfo.parnames})\n\n    def __call__(self,*args,**kwargs):\n        #if 'use_lmfit' in kwargs: kwargs.pop('use_lmfit')\n        use_lmfit = kwargs.pop('use_lmfit') if 'use_lmfit' in kwargs else self.use_lmfit\n        if use_lmfit:\n            return self.lmfitter(*args,**kwargs)\n        if self.multisingle == 'single':\n            return self.onepeakammoniafit(*args,**kwargs)\n        elif self.multisingle == 'multi':\n            return self.multinh3fit(*args,**kwargs)\n\n    def n_ammonia(self, pars=None, parnames=None, **kwargs):\n        \&quot;\&quot;\&quot;\n        Returns a function that sums over N ammonia line profiles, where N is the length of\n        tkin,tex,ntot,width,xoff_v,fortho *OR* N = len(pars) / 6\n\n        The background \&quot;height\&quot; is assumed to be zero (you must \&quot;baseline\&quot; your\n        spectrum before fitting)\n\n        *pars* [ list ]\n            a list with len(pars) = (6-nfixed)n, assuming\n            tkin,tex,ntot,width,xoff_v,fortho repeated\n\n        *parnames* [ list ] \n            len(parnames) must = len(pars).  parnames determine how the ammonia\n            function parses the arguments\n        \&quot;\&quot;\&quot;\n        if hasattr(pars,'values'):\n            # important to treat as Dictionary, since lmfit params &amp; parinfo both have .items\n            parnames,parvals = zip(*pars.items())\n            parnames = [p.lower() for p in parnames]\n            parvals = [p.value for p in parvals]\n        elif parnames is None:\n            parvals = pars\n            parnames = self.parnames\n        else:\n            parvals = pars\n        if len(pars) != len(parnames):\n            # this should only be needed when other codes are changing the number of peaks\n            # during a copy, as opposed to letting them be set by a __call__\n            # (n_modelfuncs = n_ammonia can be called directly)\n            # n_modelfuncs doesn't care how many peaks there are\n            if len(pars) % len(parnames) == 0:\n                parnames = [p for ii in range(len(pars)/len(parnames)) for p in parnames]\n                npars = len(parvals) / self.npeaks\n            else:\n                raise ValueError(\&quot;Wrong array lengths passed to n_ammonia!\&quot;)\n        else:\n            npars = len(parvals) / self.npeaks\n\n\n        self._components = []\n        def L(x):\n            v = np.zeros(len(x))\n            for jj in xrange(self.npeaks):\n                modelkwargs = kwargs.copy()\n                for ii in xrange(npars):\n                    name = parnames[ii+jj*npars].strip('0123456789').lower()\n                    modelkwargs.update({name:parvals[ii+jj*npars]})\n                v += ammonia(x,**modelkwargs)\n            return v\n        return L\n\n    def components(self, xarr, pars, hyperfine=False):\n        \&quot;\&quot;\&quot;\n        Ammonia components don't follow the default, since in Galactic astronomy the hyperfine components should be well-separated.\n        If you want to see the individual components overlaid, you'll need to pass hyperfine to the plot_fit call\n        \&quot;\&quot;\&quot;\n\n        comps=[]\n        for ii in xrange(self.npeaks):\n            if hyperfine:\n                modelkwargs = dict(zip(self.parnames[ii*self.npars:(ii+1)*self.npars],pars[ii*self.npars:(ii+1)*self.npars]))\n                comps.append( ammonia(xarr,return_components=True,**modelkwargs) )\n            else:\n                modelkwargs = dict(zip(self.parnames[ii*self.npars:(ii+1)*self.npars],pars[ii*self.npars:(ii+1)*self.npars]))\n                comps.append( [ammonia(xarr,return_components=False,**modelkwargs)] )\n\n        modelcomponents = np.concatenate(comps)\n\n        return modelcomponents\n\n\n    def multinh3fit(self, xax, data, npeaks=1, err=None, \n            params=(20,20,14,1.0,0.0,0.5),\n            parnames=None,\n            fixed=(False,False,False,False,False,False),\n            limitedmin=(True,True,True,True,False,True),\n            limitedmax=(False,False,False,False,False,True), minpars=(2.73,2.73,0,0,0,0),\n            parinfo=None,\n            maxpars=(0,0,0,0,0,1), quiet=True, shh=True, veryverbose=False, **kwargs):\n        \&quot;\&quot;\&quot;\n        Fit multiple nh3 profiles (multiple can be 1)\n\n        Inputs:\n           xax - x axis\n           data - y axis\n           npeaks - How many nh3 profiles to fit?  Default 1 (this could supersede onedgaussfit)\n           err - error corresponding to data\n\n         These parameters need to have length = 6*npeaks.  If npeaks > 1 and length = 6, they will\n         be replicated npeaks times, otherwise they will be reset to defaults:\n           params - Fit parameters: [tkin, tex, ntot (or tau), width, offset, ortho fraction] * npeaks\n                  If len(params) % 6 == 0, npeaks will be set to len(params) / 6\n           fixed - Is parameter fixed?\n           limitedmin/minpars - set lower limits on each parameter (default: width>0, Tex and Tkin > Tcmb)\n           limitedmax/maxpars - set upper limits on each parameter\n           parnames - default parameter names, important for setting kwargs in model ['tkin','tex','ntot','width','xoff_v','fortho']\n\n           quiet - should MPFIT output each iteration?\n           shh - output final parameters?\n\n        Returns:\n           Fit parameters\n           Model\n           Fit errors\n           chi2\n        \&quot;\&quot;\&quot;\n\n        if parinfo is None:\n            self.npars = len(params) / npeaks\n\n            if len(params) != npeaks and (len(params) / self.npars) > npeaks:\n                npeaks = len(params) / self.npars \n            self.npeaks = npeaks\n\n            if isinstance(params,np.ndarray): params=params.tolist()\n            # this is actually a hack, even though it's decently elegant\n            # somehow, parnames was being changed WITHOUT being passed as a variable\n            # this doesn't make sense - at all - but it happened.\n            # (it is possible for self.parnames to have npars*npeaks elements where\n            # npeaks > 1 coming into this function even though only 6 pars are specified;\n            # _default_parnames is the workaround)\n            if parnames is None: parnames = copy.copy(self._default_parnames)\n\n            partype_dict = dict(zip(['params','parnames','fixed','limitedmin','limitedmax','minpars','maxpars'],\n                    [params,parnames,fixed,limitedmin,limitedmax,minpars,maxpars]))\n\n            # make sure all various things are the right length; if they're not, fix them using the defaults\n            for partype,parlist in partype_dict.iteritems():\n                if len(parlist) != self.npars*self.npeaks:\n                    # if you leave the defaults, or enter something that can be multiplied by npars to get to the\n                    # right number of gaussians, it will just replicate\n                    if len(parlist) == self.npars: \n                        partype_dict[partype] *= npeaks \n                    elif len(parlist) > self.npars:\n                        # DANGER:  THIS SHOULD NOT HAPPEN!\n                        print \&quot;WARNING!  Input parameters were longer than allowed for variable \&quot;,parlist\n                        partype_dict[partype] = partype_dict[partype][:self.npars]\n                    elif parlist==params: # this instance shouldn't really be possible\n                        partype_dict[partype] = [20,20,1e10,1.0,0.0,0.5] * npeaks\n                    elif parlist==fixed:\n                        partype_dict[partype] = [False] * len(params)\n                    elif parlist==limitedmax: # only fortho, fillingfraction have upper limits\n                        partype_dict[partype] = (np.array(parnames) == 'fortho') + (np.array(parnames) == 'fillingfraction')\n                    elif parlist==limitedmin: # no physical values can be negative except velocity\n                        partype_dict[partype] = (np.array(parnames) != 'xoff_v')\n                    elif parlist==minpars: # all have minima of zero except kinetic temperature, which can't be below CMB.  Excitation temperature technically can be, but not in this model\n                        partype_dict[partype] = ((np.array(parnames) == 'tkin') + (np.array(parnames) == 'tex')) * 2.73\n                    elif parlist==maxpars: # fractions have upper limits of 1.0\n                        partype_dict[partype] = ((np.array(parnames) == 'fortho') + (np.array(parnames) == 'fillingfraction')).astype('float')\n                    elif parlist==parnames: # assumes the right number of parnames (essential)\n                        partype_dict[partype] = list(parnames) * self.npeaks \n\n            if len(parnames) != len(partype_dict['params']):\n                raise ValueError(\&quot;Wrong array lengths AFTER fixing them\&quot;)\n\n            # used in components.  Is this just a hack?\n            self.parnames = partype_dict['parnames']\n\n            parinfo = [ {'n':ii, 'value':partype_dict['params'][ii],\n                'limits':[partype_dict['minpars'][ii],partype_dict['maxpars'][ii]],\n                'limited':[partype_dict['limitedmin'][ii],partype_dict['limitedmax'][ii]], 'fixed':partype_dict['fixed'][ii],\n                'parname':partype_dict['parnames'][ii]+str(ii/self.npars),\n                'mpmaxstep':float(partype_dict['parnames'][ii] in ('tex','tkin')), # must force small steps in temperature (True = 1.0)\n                'error': 0} \n                for ii in xrange(len(partype_dict['params'])) ]\n\n            # hack: remove 'fixed' pars\n            parinfo_with_fixed = parinfo\n            parinfo = [p for p in parinfo_with_fixed if not p['fixed']]\n            fixed_kwargs = dict((p['parname'].strip(\&quot;0123456789\&quot;).lower(),p['value']) for p in parinfo_with_fixed if p['fixed'])\n            # don't do this - it breaks the NEXT call because npars != len(parnames) self.parnames = [p['parname'] for p in parinfo]\n            # this is OK - not a permanent change\n            parnames = [p['parname'] for p in parinfo]\n            # not OK self.npars = len(parinfo)/self.npeaks\n            parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True)\n            #import pdb; pdb.set_trace()\n        else: \n            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True) \n            parinfo_with_fixed = None\n            fixed_kwargs = {}\n\n        fitfun_kwargs = dict(kwargs.items()+fixed_kwargs.items())\n\n        npars = len(parinfo)/self.npeaks\n\n        # (fortho0 is not fortho)\n        # this doesn't work if parinfo_with_fixed is not None:\n        # this doesn't work     for p in parinfo_with_fixed:\n        # this doesn't work         # users can change the defaults while holding them fixed \n        # this doesn't work         if p['fixed']:\n        # this doesn't work             kwargs.update({p['parname']:p['value']})\n\n        def mpfitfun(x,y,err):\n            if err is None:\n                def f(p,fjac=None): return [0,(y-self.n_ammonia(pars=p, parnames=parinfo.parnames, **fitfun_kwargs)(x))]\n            else:\n                def f(p,fjac=None): return [0,(y-self.n_ammonia(pars=p, parnames=parinfo.parnames, **fitfun_kwargs)(x))/err]\n            return f\n\n        if veryverbose:\n            print \&quot;GUESSES: \&quot;\n            print \&quot;\\n\&quot;.join([\&quot;%s: %s\&quot; % (p['parname'],p['value']) for p in parinfo])\n\n        mp = mpfit(mpfitfun(xax,data,err),parinfo=parinfo,quiet=quiet)\n        mpp = mp.params\n        if mp.perror is not None: mpperr = mp.perror\n        else: mpperr = mpp*0\n        chi2 = mp.fnorm\n\n        if mp.status == 0:\n            raise Exception(mp.errmsg)\n\n        for i,p in enumerate(mpp):\n            parinfo[i]['value'] = p\n            parinfo[i]['error'] = mpperr[i]\n\n        if not shh:\n            print \&quot;Fit status: \&quot;,mp.status\n            print \&quot;Fit message: \&quot;,mp.errmsg\n            print \&quot;Final fit values: \&quot;\n            for i,p in enumerate(mpp):\n                print parinfo[i]['parname'],p,\&quot; +/- \&quot;,mpperr[i]\n            print \&quot;Chi2: \&quot;,mp.fnorm,\&quot; Reduced Chi2: \&quot;,mp.fnorm/len(data),\&quot; DOF:\&quot;,len(data)-len(mpp)\n\n        if any(['tex' in s for s in parnames]) and any(['tkin' in s for s in parnames]):\n            texnum = (i for i,s in enumerate(parnames) if 'tex' in s)\n            tkinnum = (i for i,s in enumerate(parnames) if 'tkin' in s)\n            for txn,tkn in zip(texnum,tkinnum):\n                if mpp[txn] > mpp[tkn]: mpp[txn] = mpp[tkn]  # force Tex>Tkin to Tex=Tkin (already done in n_ammonia)\n        self.mp = mp\n\n        if parinfo_with_fixed is not None:\n            # self self.parinfo preserving the 'fixed' parameters \n            # ORDER MATTERS!\n            for p in parinfo:\n                parinfo_with_fixed[p['n']] = p\n            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo_with_fixed], preserve_order=True)\n        else:\n            self.parinfo = parinfo\n            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True)\n\n        # I don't THINK these are necessary?\n        #self.parinfo = parinfo\n        #self.parinfo = ParinfoList([Parinfo(p) for p in self.parinfo])\n\n        # need to restore the fixed parameters....\n        # though the above commented out section indicates that I've done and undone this dozens of times now\n        # (a test has been added to test_nh3.py)\n        # this was NEVER included or tested because it breaks the order\n        #for par in parinfo_with_fixed:\n        #    if par.parname not in self.parinfo.keys():\n        #        self.parinfo.append(par)\n\n        self.mpp = self.parinfo.values\n        self.mpperr = self.parinfo.errors\n        self.mppnames = self.parinfo.names\n        self.model = self.n_ammonia(pars=self.mpp, parnames=self.mppnames, **kwargs)(xax)\n        #if self.model.sum() == 0:\n        #    print \&quot;DON'T FORGET TO REMOVE THIS ERROR!\&quot;\n        #    raise ValueError(\&quot;Model is zeros.\&quot;)\n\n        indiv_parinfo = [self.parinfo[jj*self.npars:(jj+1)*self.npars] for jj in xrange(len(self.parinfo)/self.npars)]\n        modelkwargs = [\n                dict([(p['parname'].strip(\&quot;0123456789\&quot;).lower(),p['value']) for p in pi])\n                for pi in indiv_parinfo]\n        self.tau_list = [ammonia(xax,return_tau=True,**mk) for mk in modelkwargs]\n\n        return self.mpp,self.model,self.mpperr,chi2\n\n    def moments(self, Xax, data, negamp=None, veryverbose=False,  **kwargs):\n        \&quot;\&quot;\&quot;\n        Returns a very simple and likely incorrect guess\n        \&quot;\&quot;\&quot;\n\n        # TKIN, TEX, ntot, width, center, ortho fraction\n        return [20,10, 1e15, 1.0, 0.0, 1.0]\n\n    def annotations(self):\n        from decimal import Decimal # for formatting\n        tex_key = {'tkin':'T_K','tex':'T_{ex}','ntot':'N','fortho':'F_o','width':'\\\\sigma','xoff_v':'v','fillingfraction':'FF','tau':'\\\\tau_{1-1}'}\n        # small hack below: don't quantize if error > value.  We want to see the values.\n        label_list = []\n        for pinfo in self.parinfo:\n            parname = tex_key[pinfo['parname'].strip(\&quot;0123456789\&quot;).lower()]\n            parnum = int(pinfo['parname'][-1])\n            if pinfo['fixed']:\n                formatted_value = \&quot;%s\&quot; % pinfo['value']\n                pm = \&quot;\&quot;\n                formatted_error=\&quot;\&quot;\n            else:\n                formatted_value = Decimal(\&quot;%g\&quot; % pinfo['value']).quantize(Decimal(\&quot;%0.2g\&quot; % (min(pinfo['error'],pinfo['value']))))\n                pm = \&quot;$\\\\pm$\&quot;\n                formatted_error = Decimal(\&quot;%g\&quot; % pinfo['error']).quantize(Decimal(\&quot;%0.2g\&quot; % pinfo['error']))\n            label =  \&quot;$%s(%i)$=%8s %s %8s\&quot; % (parname, parnum, formatted_value, pm, formatted_error)\n            label_list.append(label)\n        labels = tuple(mpcb.flatten(label_list))\n        return labels\n\nclass ammonia_model_vtau(ammonia_model):\n    def __init__(self,**kwargs):\n        super(ammonia_model_vtau,self).__init__()\n        self.parnames = ['tkin','tex','tau','width','xoff_v','fortho']\n\n    def moments(self, Xax, data, negamp=None, veryverbose=False,  **kwargs):\n        \&quot;\&quot;\&quot;\n        Returns a very simple and likely incorrect guess\n        \&quot;\&quot;\&quot;\n\n        # TKIN, TEX, ntot, width, center, ortho fraction\n        return [20,10, 1, 1.0, 0.0, 1.0]\n\n    def __call__(self,*args,**kwargs):\n        if self.multisingle == 'single':\n            return self.onepeakammoniafit(*args,**kwargs)\n        elif self.multisingle == 'multi':\n            return self.multinh3fit(*args,**kwargs)\n\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;mit&quot;}}},{&quot;rowIdx&quot;:7,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;jakevdp/seaborn&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;doc/sphinxext/ipython_directive.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;37&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;37557&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;# -*- coding: utf-8 -*-\n\&quot;\&quot;\&quot;\nSphinx directive to support embedded IPython code.\n\nThis directive allows pasting of entire interactive IPython sessions, prompts\nand all, and their code will actually get re-executed at doc build time, with\nall prompts renumbered sequentially. It also allows you to input code as a pure\npython input by giving the argument python to the directive. The output looks\nlike an interactive ipython section.\n\nTo enable this directive, simply list it in your Sphinx ``conf.py`` file\n(making sure the directory where you placed it is visible to sphinx, as is\nneeded for all Sphinx directives). For example, to enable syntax highlighting\nand the IPython directive::\n\n    extensions = ['IPython.sphinxext.ipython_console_highlighting',\n                  'IPython.sphinxext.ipython_directive']\n\nThe IPython directive outputs code-blocks with the language 'ipython'. So\nif you do not have the syntax highlighting extension enabled as well, then\nall rendered code-blocks will be uncolored. By default this directive assumes\nthat your prompts are unchanged IPython ones, but this can be customized.\nThe configurable options that can be placed in conf.py are:\n\nipython_savefig_dir:\n    The directory in which to save the figures. This is relative to the\n    Sphinx source directory. The default is `html_static_path`.\nipython_rgxin:\n    The compiled regular expression to denote the start of IPython input\n    lines. The default is re.compile('In \\[(\\d+)\\]:\\s?(.*)\\s*'). You\n    shouldn't need to change this.\nipython_rgxout:\n    The compiled regular expression to denote the start of IPython output\n    lines. The default is re.compile('Out\\[(\\d+)\\]:\\s?(.*)\\s*'). You\n    shouldn't need to change this.\nipython_promptin:\n    The string to represent the IPython input prompt in the generated ReST.\n    The default is 'In [%d]:'. This expects that the line numbers are used\n    in the prompt.\nipython_promptout:\n    The string to represent the IPython prompt in the generated ReST. The\n    default is 'Out [%d]:'. This expects that the line numbers are used\n    in the prompt.\nipython_mplbackend:\n    The string which specifies if the embedded Sphinx shell should import\n    Matplotlib and set the backend. The value specifies a backend that is\n    passed to `matplotlib.use()` before any lines in `ipython_execlines` are\n    executed. If not specified in conf.py, then the default value of 'agg' is\n    used. To use the IPython directive without matplotlib as a dependency, set\n    the value to `None`. It may end up that matplotlib is still imported\n    if the user specifies so in `ipython_execlines` or makes use of the\n    @savefig pseudo decorator.\nipython_execlines:\n    A list of strings to be exec'd in the embedded Sphinx shell. Typical\n    usage is to make certain packages always available. Set this to an empty\n    list if you wish to have no imports always available. If specified in\n    conf.py as `None`, then it has the effect of making no imports available.\n    If omitted from conf.py altogether, then the default value of\n    ['import numpy as np', 'import matplotlib.pyplot as plt'] is used.\nipython_holdcount\n    When the @suppress pseudo-decorator is used, the execution count can be\n    incremented or not. The default behavior is to hold the execution count,\n    corresponding to a value of `True`. Set this to `False` to increment\n    the execution count after each suppressed command.\n\nAs an example, to use the IPython directive when `matplotlib` is not available,\none sets the backend to `None`::\n\n    ipython_mplbackend = None\n\nAn example usage of the directive is:\n\n.. code-block:: rst\n\n    .. ipython::\n\n        In [1]: x = 1\n\n        In [2]: y = x**2\n\n        In [3]: print(y)\n\nSee http://matplotlib.org/sampledoc/ipython_directive.html for additional\ndocumentation.\n\nToDo\n----\n\n- Turn the ad-hoc test() function into a real test suite.\n- Break up ipython-specific functionality from matplotlib stuff into better\n  separated code.\n\nAuthors\n-------\n\n- John D Hunter: orignal author.\n- Fernando Perez: refactoring, documentation, cleanups, port to 0.11.\n- VÃ¡clavÅ milauer <eudoxos-AT-arcig.cz>: Prompt generalizations.\n- Skipper Seabold, refactoring, cleanups, pure python addition\n\&quot;\&quot;\&quot;\nfrom __future__ import print_function\nfrom __future__ import unicode_literals\n\n#-----------------------------------------------------------------------------\n# Imports\n#-----------------------------------------------------------------------------\n\n# Stdlib\nimport os\nimport re\nimport sys\nimport tempfile\nimport ast\nfrom pandas.compat import zip, range, map, lmap, u, cStringIO as StringIO\nimport warnings\n\n# To keep compatibility with various python versions\ntry:\n    from hashlib import md5\nexcept ImportError:\n    from md5 import md5\n\n# Third-party\nimport sphinx\nfrom docutils.parsers.rst import directives\nfrom docutils import nodes\nfrom sphinx.util.compat import Directive\n\n# Our own\nfrom IPython import Config, InteractiveShell\nfrom IPython.core.profiledir import ProfileDir\nfrom IPython.utils import io\nfrom IPython.utils.py3compat import PY3\n\nif PY3:\n    from io import StringIO\n    text_type = str\nelse:\n    from StringIO import StringIO\n    text_type = unicode\n\n#-----------------------------------------------------------------------------\n# Globals\n#-----------------------------------------------------------------------------\n# for tokenizing blocks\nCOMMENT, INPUT, OUTPUT =  range(3)\n\n#-----------------------------------------------------------------------------\n# Functions and class declarations\n#-----------------------------------------------------------------------------\n\ndef block_parser(part, rgxin, rgxout, fmtin, fmtout):\n    \&quot;\&quot;\&quot;\n    part is a string of ipython text, comprised of at most one\n    input, one ouput, comments, and blank lines.  The block parser\n    parses the text into a list of::\n\n      blocks = [ (TOKEN0, data0), (TOKEN1, data1), ...]\n\n    where TOKEN is one of [COMMENT | INPUT | OUTPUT ] and\n    data is, depending on the type of token::\n\n      COMMENT : the comment string\n\n      INPUT: the (DECORATOR, INPUT_LINE, REST) where\n         DECORATOR: the input decorator (or None)\n         INPUT_LINE: the input as string (possibly multi-line)\n         REST : any stdout generated by the input line (not OUTPUT)\n\n      OUTPUT: the output string, possibly multi-line\n\n    \&quot;\&quot;\&quot;\n    block = []\n    lines = part.split('\\n')\n    N = len(lines)\n    i = 0\n    decorator = None\n    while 1:\n\n        if i==N:\n            # nothing left to parse -- the last line\n            break\n\n        line = lines[i]\n        i += 1\n        line_stripped = line.strip()\n        if line_stripped.startswith('#'):\n            block.append((COMMENT, line))\n            continue\n\n        if line_stripped.startswith('@'):\n            # we're assuming at most one decorator -- may need to\n            # rethink\n            decorator = line_stripped\n            continue\n\n        # does this look like an input line?\n        matchin = rgxin.match(line)\n        if matchin:\n            lineno, inputline = int(matchin.group(1)), matchin.group(2)\n\n            # the ....: continuation string\n            continuation = '   %s:'%''.join(['.']*(len(str(lineno))+2))\n            Nc = len(continuation)\n            # input lines can continue on for more than one line, if\n            # we have a '\\' line continuation char or a function call\n            # echo line 'print'.  The input line can only be\n            # terminated by the end of the block or an output line, so\n            # we parse out the rest of the input line if it is\n            # multiline as well as any echo text\n\n            rest = []\n            while i<N:\n\n                # look ahead; if the next line is blank, or a comment, or\n                # an output line, we're done\n\n                nextline = lines[i]\n                matchout = rgxout.match(nextline)\n                #print \&quot;nextline=%s, continuation=%s, starts=%s\&quot;%(nextline, continuation, nextline.startswith(continuation))\n                if matchout or nextline.startswith('#'):\n                    break\n                elif nextline.startswith(continuation):\n                    nextline = nextline[Nc:]\n                    if nextline and nextline[0] == ' ':\n                        nextline = nextline[1:]\n\n                    inputline += '\\n' +  nextline\n\n                else:\n                    rest.append(nextline)\n                i+= 1\n\n            block.append((INPUT, (decorator, inputline, '\\n'.join(rest))))\n            continue\n\n        # if it looks like an output line grab all the text to the end\n        # of the block\n        matchout = rgxout.match(line)\n        if matchout:\n            lineno, output = int(matchout.group(1)), matchout.group(2)\n            if i<N-1:\n                output = '\\n'.join([output] + lines[i:])\n\n            block.append((OUTPUT, output))\n            break\n\n    return block\n\n\nclass DecodingStringIO(StringIO, object):\n    def __init__(self,buf='',encodings=('utf8',), *args, **kwds):\n        super(DecodingStringIO, self).__init__(buf, *args, **kwds)\n        self.set_encodings(encodings)\n\n    def set_encodings(self, encodings):\n        self.encodings = encodings\n\n    def write(self,data):\n        if isinstance(data, text_type):\n            return super(DecodingStringIO, self).write(data)\n        else:\n            for enc in self.encodings:\n                try:\n                    data = data.decode(enc)\n                    return super(DecodingStringIO, self).write(data)\n                except :\n                    pass\n        # default to brute utf8 if no encoding succeded\n            return super(DecodingStringIO, self).write(data.decode('utf8', 'replace'))\n\n\nclass EmbeddedSphinxShell(object):\n    \&quot;\&quot;\&quot;An embedded IPython instance to run inside Sphinx\&quot;\&quot;\&quot;\n\n    def __init__(self, exec_lines=None,state=None):\n\n        self.cout = DecodingStringIO(u'')\n\n        if exec_lines is None:\n            exec_lines = []\n\n        self.state = state\n\n        # Create config object for IPython\n        config = Config()\n        config.InteractiveShell.autocall = False\n        config.InteractiveShell.autoindent = False\n        config.InteractiveShell.colors = 'NoColor'\n\n        # create a profile so instance history isn't saved\n        tmp_profile_dir = tempfile.mkdtemp(prefix='profile_')\n        profname = 'auto_profile_sphinx_build'\n        pdir = os.path.join(tmp_profile_dir,profname)\n        profile = ProfileDir.create_profile_dir(pdir)\n\n        # Create and initialize global ipython, but don't start its mainloop.\n        # This will persist across different EmbededSphinxShell instances.\n        IP = InteractiveShell.instance(config=config, profile_dir=profile)\n\n        # io.stdout redirect must be done after instantiating InteractiveShell\n        io.stdout = self.cout\n        io.stderr = self.cout\n\n        # For debugging, so we can see normal output, use this:\n        #from IPython.utils.io import Tee\n        #io.stdout = Tee(self.cout, channel='stdout') # dbg\n        #io.stderr = Tee(self.cout, channel='stderr') # dbg\n\n        # Store a few parts of IPython we'll need.\n        self.IP = IP\n        self.user_ns = self.IP.user_ns\n        self.user_global_ns = self.IP.user_global_ns\n\n        self.input = ''\n        self.output = ''\n\n        self.is_verbatim = False\n        self.is_doctest = False\n        self.is_suppress = False\n\n        # Optionally, provide more detailed information to shell.\n        self.directive = None\n\n        # on the first call to the savefig decorator, we'll import\n        # pyplot as plt so we can make a call to the plt.gcf().savefig\n        self._pyplot_imported = False\n\n        # Prepopulate the namespace.\n        for line in exec_lines:\n            self.process_input_line(line, store_history=False)\n\n    def clear_cout(self):\n        self.cout.seek(0)\n        self.cout.truncate(0)\n\n    def process_input_line(self, line, store_history=True):\n        \&quot;\&quot;\&quot;process the input, capturing stdout\&quot;\&quot;\&quot;\n\n        stdout = sys.stdout\n        splitter = self.IP.input_splitter\n        try:\n            sys.stdout = self.cout\n            splitter.push(line)\n            more = splitter.push_accepts_more()\n            if not more:\n                try:\n                    source_raw = splitter.source_raw_reset()[1]\n                except:\n                    # recent ipython #4504\n                    source_raw = splitter.raw_reset()\n                self.IP.run_cell(source_raw, store_history=store_history)\n        finally:\n            sys.stdout = stdout\n\n    def process_image(self, decorator):\n        \&quot;\&quot;\&quot;\n        # build out an image directive like\n        # .. image:: somefile.png\n        #    :width 4in\n        #\n        # from an input like\n        # savefig somefile.png width=4in\n        \&quot;\&quot;\&quot;\n        savefig_dir = self.savefig_dir\n        source_dir = self.source_dir\n        saveargs = decorator.split(' ')\n        filename = saveargs[1]\n        # insert relative path to image file in source\n        outfile = os.path.relpath(os.path.join(savefig_dir,filename),\n                    source_dir)\n\n        imagerows = ['.. image:: %s'%outfile]\n\n        for kwarg in saveargs[2:]:\n            arg, val = kwarg.split('=')\n            arg = arg.strip()\n            val = val.strip()\n            imagerows.append('   :%s: %s'%(arg, val))\n\n        image_file = os.path.basename(outfile) # only return file name\n        image_directive = '\\n'.join(imagerows)\n        return image_file, image_directive\n\n    # Callbacks for each type of token\n    def process_input(self, data, input_prompt, lineno):\n        \&quot;\&quot;\&quot;\n        Process data block for INPUT token.\n\n        \&quot;\&quot;\&quot;\n        decorator, input, rest = data\n        image_file = None\n        image_directive = None\n\n        is_verbatim = decorator=='@verbatim' or self.is_verbatim\n        is_doctest = (decorator is not None and \\\n                     decorator.startswith('@doctest')) or self.is_doctest\n        is_suppress = decorator=='@suppress' or self.is_suppress\n        is_okexcept = decorator=='@okexcept' or self.is_okexcept\n        is_okwarning = decorator=='@okwarning' or self.is_okwarning\n        is_savefig = decorator is not None and \\\n                     decorator.startswith('@savefig')\n\n        # set the encodings to be used by DecodingStringIO\n        # to convert the execution output into unicode if\n        # needed. this attrib is set by IpythonDirective.run()\n        # based on the specified block options, defaulting to ['ut\n        self.cout.set_encodings(self.output_encoding)\n\n        input_lines = input.split('\\n')\n\n        if len(input_lines) > 1:\n           if input_lines[-1] != \&quot;\&quot;:\n               input_lines.append('') # make sure there's a blank line\n                                       # so splitter buffer gets reset\n\n        continuation = '   %s:'%''.join(['.']*(len(str(lineno))+2))\n\n        if is_savefig:\n            image_file, image_directive = self.process_image(decorator)\n\n        ret = []\n        is_semicolon = False\n\n        # Hold the execution count, if requested to do so.\n        if is_suppress and self.hold_count:\n            store_history = False\n        else:\n            store_history = True\n\n        # Note: catch_warnings is not thread safe\n        with warnings.catch_warnings(record=True) as ws:\n            for i, line in enumerate(input_lines):\n                if line.endswith(';'):\n                    is_semicolon = True\n\n                if i == 0:\n                    # process the first input line\n                    if is_verbatim:\n                        self.process_input_line('')\n                        self.IP.execution_count += 1 # increment it anyway\n                    else:\n                        # only submit the line in non-verbatim mode\n                        self.process_input_line(line, store_history=store_history)\n                    formatted_line = '%s %s'%(input_prompt, line)\n                else:\n                    # process a continuation line\n                    if not is_verbatim:\n                        self.process_input_line(line, store_history=store_history)\n\n                    formatted_line = '%s %s'%(continuation, line)\n\n                if not is_suppress:\n                    ret.append(formatted_line)\n\n        if not is_suppress and len(rest.strip()) and is_verbatim:\n            # the \&quot;rest\&quot; is the standard output of the\n            # input, which needs to be added in\n            # verbatim mode\n            ret.append(rest)\n\n        self.cout.seek(0)\n        output = self.cout.read()\n        if not is_suppress and not is_semicolon:\n            ret.append(output)\n        elif is_semicolon: # get spacing right\n            ret.append('')\n\n        # context information\n        filename = self.state.document.current_source\n        lineno = self.state.document.current_line\n\n        # output any exceptions raised during execution to stdout\n        # unless :okexcept: has been specified.\n        if not is_okexcept and \&quot;Traceback\&quot; in output:\n            s =  \&quot;\\nException in %s at block ending on line %s\\n\&quot; % (filename, lineno)\n            s += \&quot;Specify :okexcept: as an option in the ipython:: block to suppress this message\\n\&quot;\n            sys.stdout.write('\\n\\n>>>' + ('-' * 73))\n            sys.stdout.write(s)\n            sys.stdout.write(output)\n            sys.stdout.write('<<<' + ('-' * 73) + '\\n\\n')\n\n        # output any warning raised during execution to stdout\n        # unless :okwarning: has been specified.\n        if not is_okwarning:\n            for w in ws:\n                s =  \&quot;\\nWarning in %s at block ending on line %s\\n\&quot; % (filename, lineno)\n                s += \&quot;Specify :okwarning: as an option in the ipython:: block to suppress this message\\n\&quot;\n                sys.stdout.write('\\n\\n>>>' + ('-' * 73))\n                sys.stdout.write(s)\n                sys.stdout.write('-' * 76 + '\\n')\n                s=warnings.formatwarning(w.message, w.category,\n                                         w.filename, w.lineno, w.line)\n                sys.stdout.write(s)\n                sys.stdout.write('<<<' + ('-' * 73) + '\\n')\n\n        self.cout.truncate(0)\n        return (ret, input_lines, output, is_doctest, decorator, image_file,\n                    image_directive)\n\n\n    def process_output(self, data, output_prompt,\n                       input_lines, output, is_doctest, decorator, image_file):\n        \&quot;\&quot;\&quot;\n        Process data block for OUTPUT token.\n\n        \&quot;\&quot;\&quot;\n        TAB = ' ' * 4\n\n        if is_doctest and output is not None:\n\n            found = output\n            found = found.strip()\n            submitted = data.strip()\n\n            if self.directive is None:\n                source = 'Unavailable'\n                content = 'Unavailable'\n            else:\n                source = self.directive.state.document.current_source\n                content = self.directive.content\n                # Add tabs and join into a single string.\n                content = '\\n'.join([TAB + line for line in content])\n\n            # Make sure the output contains the output prompt.\n            ind = found.find(output_prompt)\n            if ind < 0:\n                e = ('output does not contain output prompt\\n\\n'\n                     'Document source: {0}\\n\\n'\n                     'Raw content: \\n{1}\\n\\n'\n                     'Input line(s):\\n{TAB}{2}\\n\\n'\n                     'Output line(s):\\n{TAB}{3}\\n\\n')\n                e = e.format(source, content, '\\n'.join(input_lines),\n                             repr(found), TAB=TAB)\n                raise RuntimeError(e)\n            found = found[len(output_prompt):].strip()\n\n            # Handle the actual doctest comparison.\n            if decorator.strip() == '@doctest':\n                # Standard doctest\n                if found != submitted:\n                    e = ('doctest failure\\n\\n'\n                         'Document source: {0}\\n\\n'\n                         'Raw content: \\n{1}\\n\\n'\n                         'On input line(s):\\n{TAB}{2}\\n\\n'\n                         'we found output:\\n{TAB}{3}\\n\\n'\n                         'instead of the expected:\\n{TAB}{4}\\n\\n')\n                    e = e.format(source, content, '\\n'.join(input_lines),\n                                 repr(found), repr(submitted), TAB=TAB)\n                    raise RuntimeError(e)\n            else:\n                self.custom_doctest(decorator, input_lines, found, submitted)\n\n    def process_comment(self, data):\n        \&quot;\&quot;\&quot;Process data fPblock for COMMENT token.\&quot;\&quot;\&quot;\n        if not self.is_suppress:\n            return [data]\n\n    def save_image(self, image_file):\n        \&quot;\&quot;\&quot;\n        Saves the image file to disk.\n        \&quot;\&quot;\&quot;\n        self.ensure_pyplot()\n        command = ('plt.gcf().savefig(\&quot;%s\&quot;, bbox_inches=\&quot;tight\&quot;, '\n                   'dpi=100)' % image_file)\n\n        #print 'SAVEFIG', command  # dbg\n        self.process_input_line('bookmark ipy_thisdir', store_history=False)\n        self.process_input_line('cd -b ipy_savedir', store_history=False)\n        self.process_input_line(command, store_history=False)\n        self.process_input_line('cd -b ipy_thisdir', store_history=False)\n        self.process_input_line('bookmark -d ipy_thisdir', store_history=False)\n        self.clear_cout()\n\n    def process_block(self, block):\n        \&quot;\&quot;\&quot;\n        process block from the block_parser and return a list of processed lines\n        \&quot;\&quot;\&quot;\n        ret = []\n        output = None\n        input_lines = None\n        lineno = self.IP.execution_count\n\n        input_prompt = self.promptin % lineno\n        output_prompt = self.promptout % lineno\n        image_file = None\n        image_directive = None\n\n        for token, data in block:\n            if token == COMMENT:\n                out_data = self.process_comment(data)\n            elif token == INPUT:\n                (out_data, input_lines, output, is_doctest, decorator,\n                    image_file, image_directive) = \\\n                          self.process_input(data, input_prompt, lineno)\n            elif token == OUTPUT:\n                out_data = \\\n                    self.process_output(data, output_prompt,\n                                        input_lines, output, is_doctest,\n                                        decorator, image_file)\n            if out_data:\n                ret.extend(out_data)\n\n        # save the image files\n        if image_file is not None:\n            self.save_image(image_file)\n\n        return ret, image_directive\n\n    def ensure_pyplot(self):\n        \&quot;\&quot;\&quot;\n        Ensures that pyplot has been imported into the embedded IPython shell.\n\n        Also, makes sure to set the backend appropriately if not set already.\n\n        \&quot;\&quot;\&quot;\n        # We are here if the @figure pseudo decorator was used. Thus, it's\n        # possible that we could be here even if python_mplbackend were set to\n        # `None`. That's also strange and perhaps worthy of raising an\n        # exception, but for now, we just set the backend to 'agg'.\n\n        if not self._pyplot_imported:\n            if 'matplotlib.backends' not in sys.modules:\n                # Then ipython_matplotlib was set to None but there was a\n                # call to the @figure decorator (and ipython_execlines did\n                # not set a backend).\n                #raise Exception(\&quot;No backend was set, but @figure was used!\&quot;)\n                import matplotlib\n                matplotlib.use('agg')\n\n            # Always import pyplot into embedded shell.\n            self.process_input_line('import matplotlib.pyplot as plt',\n                                    store_history=False)\n            self._pyplot_imported = True\n\n    def process_pure_python(self, content):\n        \&quot;\&quot;\&quot;\n        content is a list of strings. it is unedited directive content\n\n        This runs it line by line in the InteractiveShell, prepends\n        prompts as needed capturing stderr and stdout, then returns\n        the content as a list as if it were ipython code\n        \&quot;\&quot;\&quot;\n        output = []\n        savefig = False # keep up with this to clear figure\n        multiline = False # to handle line continuation\n        multiline_start = None\n        fmtin = self.promptin\n\n        ct = 0\n\n        for lineno, line in enumerate(content):\n\n            line_stripped = line.strip()\n            if not len(line):\n                output.append(line)\n                continue\n\n            # handle decorators\n            if line_stripped.startswith('@'):\n                output.extend([line])\n                if 'savefig' in line:\n                    savefig = True # and need to clear figure\n                continue\n\n            # handle comments\n            if line_stripped.startswith('#'):\n                output.extend([line])\n                continue\n\n            # deal with lines checking for multiline\n            continuation  = u'   %s:'% ''.join(['.']*(len(str(ct))+2))\n            if not multiline:\n                modified = u\&quot;%s %s\&quot; % (fmtin % ct, line_stripped)\n                output.append(modified)\n                ct += 1\n                try:\n                    ast.parse(line_stripped)\n                    output.append(u'')\n                except Exception: # on a multiline\n                    multiline = True\n                    multiline_start = lineno\n            else: # still on a multiline\n                modified = u'%s %s' % (continuation, line)\n                output.append(modified)\n\n                # if the next line is indented, it should be part of multiline\n                if len(content) > lineno + 1:\n                    nextline = content[lineno + 1]\n                    if len(nextline) - len(nextline.lstrip()) > 3:\n                        continue\n                try:\n                    mod = ast.parse(\n                            '\\n'.join(content[multiline_start:lineno+1]))\n                    if isinstance(mod.body[0], ast.FunctionDef):\n                        # check to see if we have the whole function\n                        for element in mod.body[0].body:\n                            if isinstance(element, ast.Return):\n                                multiline = False\n                    else:\n                        output.append(u'')\n                        multiline = False\n                except Exception:\n                    pass\n\n            if savefig: # clear figure if plotted\n                self.ensure_pyplot()\n                self.process_input_line('plt.clf()', store_history=False)\n                self.clear_cout()\n                savefig = False\n\n        return output\n\n    def custom_doctest(self, decorator, input_lines, found, submitted):\n        \&quot;\&quot;\&quot;\n        Perform a specialized doctest.\n\n        \&quot;\&quot;\&quot;\n        from .custom_doctests import doctests\n\n        args = decorator.split()\n        doctest_type = args[1]\n        if doctest_type in doctests:\n            doctests[doctest_type](self, args, input_lines, found, submitted)\n        else:\n            e = \&quot;Invalid option to @doctest: {0}\&quot;.format(doctest_type)\n            raise Exception(e)\n\n\nclass IPythonDirective(Directive):\n\n    has_content = True\n    required_arguments = 0\n    optional_arguments = 4 # python, suppress, verbatim, doctest\n    final_argumuent_whitespace = True\n    option_spec = { 'python': directives.unchanged,\n                    'suppress' : directives.flag,\n                    'verbatim' : directives.flag,\n                    'doctest' : directives.flag,\n                    'okexcept': directives.flag,\n                    'okwarning': directives.flag,\n                    'output_encoding': directives.unchanged_required\n                  }\n\n    shell = None\n\n    seen_docs = set()\n\n    def get_config_options(self):\n        # contains sphinx configuration variables\n        config = self.state.document.settings.env.config\n\n        # get config variables to set figure output directory\n        confdir = self.state.document.settings.env.app.confdir\n        savefig_dir = config.ipython_savefig_dir\n        source_dir = os.path.dirname(self.state.document.current_source)\n        if savefig_dir is None:\n            savefig_dir = config.html_static_path\n        if isinstance(savefig_dir, list):\n            savefig_dir = savefig_dir[0] # safe to assume only one path?\n        savefig_dir = os.path.join(confdir, savefig_dir)\n\n        # get regex and prompt stuff\n        rgxin      = config.ipython_rgxin\n        rgxout     = config.ipython_rgxout\n        promptin   = config.ipython_promptin\n        promptout  = config.ipython_promptout\n        mplbackend = config.ipython_mplbackend\n        exec_lines = config.ipython_execlines\n        hold_count = config.ipython_holdcount\n\n        return (savefig_dir, source_dir, rgxin, rgxout,\n                promptin, promptout, mplbackend, exec_lines, hold_count)\n\n    def setup(self):\n        # Get configuration values.\n        (savefig_dir, source_dir, rgxin, rgxout, promptin, promptout,\n         mplbackend, exec_lines, hold_count) = self.get_config_options()\n\n        if self.shell is None:\n            # We will be here many times.  However, when the\n            # EmbeddedSphinxShell is created, its interactive shell member\n            # is the same for each instance.\n\n            if mplbackend:\n                import matplotlib\n                # Repeated calls to use() will not hurt us since `mplbackend`\n                # is the same each time.\n                matplotlib.use(mplbackend)\n\n            # Must be called after (potentially) importing matplotlib and\n            # setting its backend since exec_lines might import pylab.\n            self.shell = EmbeddedSphinxShell(exec_lines, self.state)\n\n            # Store IPython directive to enable better error messages\n            self.shell.directive = self\n\n        # reset the execution count if we haven't processed this doc\n        #NOTE: this may be borked if there are multiple seen_doc tmp files\n        #check time stamp?\n        if not self.state.document.current_source in self.seen_docs:\n            self.shell.IP.history_manager.reset()\n            self.shell.IP.execution_count = 1\n            self.shell.IP.prompt_manager.width = 0\n            self.seen_docs.add(self.state.document.current_source)\n\n        # and attach to shell so we don't have to pass them around\n        self.shell.rgxin = rgxin\n        self.shell.rgxout = rgxout\n        self.shell.promptin = promptin\n        self.shell.promptout = promptout\n        self.shell.savefig_dir = savefig_dir\n        self.shell.source_dir = source_dir\n        self.shell.hold_count = hold_count\n\n        # setup bookmark for saving figures directory\n        self.shell.process_input_line('bookmark ipy_savedir %s'%savefig_dir,\n                                      store_history=False)\n        self.shell.clear_cout()\n\n        return rgxin, rgxout, promptin, promptout\n\n    def teardown(self):\n        # delete last bookmark\n        self.shell.process_input_line('bookmark -d ipy_savedir',\n                                      store_history=False)\n        self.shell.clear_cout()\n\n    def run(self):\n        debug = False\n\n        #TODO, any reason block_parser can't be a method of embeddable shell\n        # then we wouldn't have to carry these around\n        rgxin, rgxout, promptin, promptout = self.setup()\n\n        options = self.options\n        self.shell.is_suppress = 'suppress' in options\n        self.shell.is_doctest = 'doctest' in options\n        self.shell.is_verbatim = 'verbatim' in options\n        self.shell.is_okexcept = 'okexcept' in options\n        self.shell.is_okwarning = 'okwarning' in options\n\n        self.shell.output_encoding = [options.get('output_encoding', 'utf8')]\n\n        # handle pure python code\n        if 'python' in self.arguments:\n            content = self.content\n            self.content = self.shell.process_pure_python(content)\n\n        parts = '\\n'.join(self.content).split('\\n\\n')\n\n        lines = ['.. code-block:: ipython', '']\n        figures = []\n\n        for part in parts:\n            block = block_parser(part, rgxin, rgxout, promptin, promptout)\n            if len(block):\n                rows, figure = self.shell.process_block(block)\n                for row in rows:\n                    lines.extend(['   %s'%line for line in row.split('\\n')])\n\n                if figure is not None:\n                    figures.append(figure)\n\n        for figure in figures:\n            lines.append('')\n            lines.extend(figure.split('\\n'))\n            lines.append('')\n\n        if len(lines)>2:\n            if debug:\n                print('\\n'.join(lines))\n            else:\n                # This has to do with input, not output. But if we comment\n                # these lines out, then no IPython code will appear in the\n                # final output.\n                self.state_machine.insert_input(\n                    lines, self.state_machine.input_lines.source(0))\n\n        # cleanup\n        self.teardown()\n\n        return []\n\n# Enable as a proper Sphinx directive\ndef setup(app):\n    setup.app = app\n\n    app.add_directive('ipython', IPythonDirective)\n    app.add_config_value('ipython_savefig_dir', None, 'env')\n    app.add_config_value('ipython_rgxin',\n                         re.compile('In \\[(\\d+)\\]:\\s?(.*)\\s*'), 'env')\n    app.add_config_value('ipython_rgxout',\n                         re.compile('Out\\[(\\d+)\\]:\\s?(.*)\\s*'), 'env')\n    app.add_config_value('ipython_promptin', 'In [%d]:', 'env')\n    app.add_config_value('ipython_promptout', 'Out[%d]:', 'env')\n\n    # We could just let matplotlib pick whatever is specified as the default\n    # backend in the matplotlibrc file, but this would cause issues if the\n    # backend didn't work in headless environments. For this reason, 'agg'\n    # is a good default backend choice.\n    app.add_config_value('ipython_mplbackend', 'agg', 'env')\n\n    # If the user sets this config value to `None`, then EmbeddedSphinxShell's\n    # __init__ method will treat it as [].\n    execlines = ['import numpy as np', 'import matplotlib.pyplot as plt']\n    app.add_config_value('ipython_execlines', execlines, 'env')\n\n    app.add_config_value('ipython_holdcount', True, 'env')\n\n# Simple smoke test, needs to be converted to a proper automatic test.\ndef test():\n\n    examples = [\n        r\&quot;\&quot;\&quot;\nIn [9]: pwd\nOut[9]: '/home/jdhunter/py4science/book'\n\nIn [10]: cd bookdata/\n/home/jdhunter/py4science/book/bookdata\n\nIn [2]: from pylab import *\n\nIn [2]: ion()\n\nIn [3]: im = imread('stinkbug.png')\n\n@savefig mystinkbug.png width=4in\nIn [4]: imshow(im)\nOut[4]: <matplotlib.image.AxesImage object at 0x39ea850>\n\n\&quot;\&quot;\&quot;,\n        r\&quot;\&quot;\&quot;\n\nIn [1]: x = 'hello world'\n\n# string methods can be\n# used to alter the string\n@doctest\nIn [2]: x.upper()\nOut[2]: 'HELLO WORLD'\n\n@verbatim\nIn [3]: x.st<TAB>\nx.startswith  x.strip\n\&quot;\&quot;\&quot;,\n    r\&quot;\&quot;\&quot;\n\nIn [130]: url = 'http://ichart.finance.yahoo.com/table.csv?s=CROX\\\n   .....: &amp;d=9&amp;e=22&amp;f=2009&amp;g=d&amp;a=1&amp;br=8&amp;c=2006&amp;ignore=.csv'\n\nIn [131]: print url.split('&amp;')\n['http://ichart.finance.yahoo.com/table.csv?s=CROX', 'd=9', 'e=22', 'f=2009', 'g=d', 'a=1', 'b=8', 'c=2006', 'ignore=.csv']\n\nIn [60]: import urllib\n\n\&quot;\&quot;\&quot;,\n    r\&quot;\&quot;\&quot;\\\n\nIn [133]: import numpy.random\n\n@suppress\nIn [134]: numpy.random.seed(2358)\n\n@doctest\nIn [135]: numpy.random.rand(10,2)\nOut[135]:\narray([[ 0.64524308,  0.59943846],\n       [ 0.47102322,  0.8715456 ],\n       [ 0.29370834,  0.74776844],\n       [ 0.99539577,  0.1313423 ],\n       [ 0.16250302,  0.21103583],\n       [ 0.81626524,  0.1312433 ],\n       [ 0.67338089,  0.72302393],\n       [ 0.7566368 ,  0.07033696],\n       [ 0.22591016,  0.77731835],\n       [ 0.0072729 ,  0.34273127]])\n\n\&quot;\&quot;\&quot;,\n\n    r\&quot;\&quot;\&quot;\nIn [106]: print x\njdh\n\nIn [109]: for i in range(10):\n   .....:     print i\n   .....:\n   .....:\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\&quot;\&quot;\&quot;,\n\n        r\&quot;\&quot;\&quot;\n\nIn [144]: from pylab import *\n\nIn [145]: ion()\n\n# use a semicolon to suppress the output\n@savefig test_hist.png width=4in\nIn [151]: hist(np.random.randn(10000), 100);\n\n\n@savefig test_plot.png width=4in\nIn [151]: plot(np.random.randn(10000), 'o');\n   \&quot;\&quot;\&quot;,\n\n        r\&quot;\&quot;\&quot;\n# use a semicolon to suppress the output\nIn [151]: plt.clf()\n\n@savefig plot_simple.png width=4in\nIn [151]: plot([1,2,3])\n\n@savefig hist_simple.png width=4in\nIn [151]: hist(np.random.randn(10000), 100);\n\n\&quot;\&quot;\&quot;,\n     r\&quot;\&quot;\&quot;\n# update the current fig\nIn [151]: ylabel('number')\n\nIn [152]: title('normal distribution')\n\n\n@savefig hist_with_text.png\nIn [153]: grid(True)\n\n@doctest float\nIn [154]: 0.1 + 0.2\nOut[154]: 0.3\n\n@doctest float\nIn [155]: np.arange(16).reshape(4,4)\nOut[155]:\narray([[ 0,  1,  2,  3],\n       [ 4,  5,  6,  7],\n       [ 8,  9, 10, 11],\n       [12, 13, 14, 15]])\n\nIn [1]: x = np.arange(16, dtype=float).reshape(4,4)\n\nIn [2]: x[0,0] = np.inf\n\nIn [3]: x[0,1] = np.nan\n\n@doctest float\nIn [4]: x\nOut[4]:\narray([[ inf,  nan,   2.,   3.],\n       [  4.,   5.,   6.,   7.],\n       [  8.,   9.,  10.,  11.],\n       [ 12.,  13.,  14.,  15.]])\n\n\n        \&quot;\&quot;\&quot;,\n        ]\n    # skip local-file depending first example:\n    examples = examples[1:]\n\n    #ipython_directive.DEBUG = True  # dbg\n    #options = dict(suppress=True)  # dbg\n    options = dict()\n    for example in examples:\n        content = example.split('\\n')\n        IPythonDirective('debug', arguments=None, options=options,\n                          content=content, lineno=0,\n                          content_offset=None, block_text=None,\n                          state=None, state_machine=None,\n                          )\n\n# Run test suite as a script\nif __name__=='__main__':\n    if not os.path.isdir('_static'):\n        os.mkdir('_static')\n    test()\n    print('All OK? Check figures in _static/')\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;bsd-3-clause&quot;}}},{&quot;rowIdx&quot;:8,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;INCF/BIDS2ISATab&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;setup.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;1&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2176&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;from setuptools import setup\nimport os\n\nhere = os.path.abspath(os.path.dirname(__file__))\n\nsetup(\n    name=\&quot;BIDS2ISATab\&quot;,\n\n    # Versions should comply with PEP440.  For a discussion on single-sourcing\n    # the version across setup.py and the project code, see\n    # http://packaging.python.org/en/latest/tutorial.html#version\n    version='0.1.0',\n\n    description=\&quot;Command line tool generating ISA-Tab compatible description from a Brain Imaging Data Structure \&quot;\n                \&quot;compatible dataset.\&quot;,\n    long_description=\&quot;Command line tool generating ISA-Tab compatible description from a Brain Imaging Data Structure \&quot;\n                     \&quot;compatible dataset.\&quot;,\n\n    # The project URL.\n    url='https://github.com/INCF/BIDS2ISATab',\n\n    # Choose your license\n    license='BSD',\n\n    classifiers=[\n        # How mature is this project? Common values are\n        #   3 - Alpha\n        #   4 - Beta\n        #   5 - Production/Stable\n        'Development Status :: 4 - Beta',\n\n        # Pick your license as you wish (should match \&quot;license\&quot; above)\n        'License :: OSI Approved :: BSD License',\n\n        # Specify the Python versions you support here. In particular, ensure\n        # that you indicate whether you support Python 2, Python 3 or both.\n        'Programming Language :: Python :: 2.7',\n        'Programming Language :: Python :: 3.5',\n    ],\n\n    # What does your project relate to?\n    keywords='bids isatab',\n\n    # You can just specify the packages manually here if your project is\n    # simple. Or you can use find_packages.\n    packages=[\&quot;bids2isatab\&quot;],\n\n    # List run-time dependencies here.  These will be installed by pip when your\n    # project is installed.\n    install_requires = [\&quot;future\&quot;,\n                        \&quot;pandas\&quot;,\n                        'nibabel'],\n\n    include_package_data=True,\n\n    # To provide executable scripts, use entry points in preference to the\n    # \&quot;scripts\&quot; keyword. Entry points provide cross-platform support and allow\n    # pip to create the appropriate form of executable for the target platform.\n    entry_points={\n        'console_scripts': [\n            'bids2isatab=bids2isatab.main:main',\n        ],\n    },\n)\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;apache-2.0&quot;}}},{&quot;rowIdx&quot;:9,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;zooniverse/aggregation&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;experimental/clusteringAlg/adaptiveDBSCAN.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;4734&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#!/usr/bin/env python\n__author__ = 'greg'\nfrom sklearn.cluster import DBSCAN\nimport numpy as np\nimport math\n\ndef dist(c1,c2):\n    return math.sqrt((c1[0]-c2[0])**2 + (c1[1]-c2[1])**2)\n\nclass CannotSplit(Exception):\n    def __init__(self,value):\n        self.value = value\n    def __str__(self):\n        return \&quot;\&quot;\nsamples_needed = 3\n\ndef adaptiveDBSCAN(XYpts,user_ids):\n    if XYpts == []:\n        return []\n\n    pts_in_each_cluster = []\n    users_in_each_cluster = []\n    cluster_centers = []\n\n    #increase the epsilon until we don't have any nearby clusters corresponding to non-overlapping\n    #sets of users\n    X = np.array(XYpts)\n    #for epsilon in [5,10,15,20,25,30]:\n    for first_epsilon in [100,200,300,400]:\n        db = DBSCAN(eps=first_epsilon, min_samples=samples_needed).fit(X)\n\n        labels = db.labels_\n        pts_in_each_cluster = []\n        users_in_each_cluster = []\n        cluster_centers = []\n\n        for k in sorted(set(labels)):\n            if k == -1:\n                continue\n\n            class_member_mask = (labels == k)\n            pts_in_cluster = list(X[class_member_mask])\n            xSet,ySet = zip(*pts_in_cluster)\n\n            cluster_centers.append((np.mean(xSet),np.mean(ySet)))\n            pts_in_each_cluster.append(pts_in_cluster[:])\n            users_in_each_cluster.append([u for u,l in zip(user_ids,labels) if l == k])\n\n        #do we have any adjacent clusters with non-overlapping sets of users\n        #if so, we should merge them by increasing the epsilon value\n        cluster_compare = []\n        for cluster_index, (c1,users) in enumerate(zip(cluster_centers,users_in_each_cluster)):\n            for cluster_index, (c2,users2) in enumerate(zip(cluster_centers[cluster_index+1:],users_in_each_cluster[cluster_index+1:])):\n                overlappingUsers = [u for u in users if u in users2]\n                cluster_compare.append((dist(c1,c2),overlappingUsers))\n\n        cluster_compare.sort(key = lambda x:x[0])\n        needToMerge = [] in [c[1] for c in cluster_compare[:10]]\n        if not(needToMerge):\n            break\n    #print epsilon\n    #print [c[1] for c in cluster_compare[:10]]\n    centers_to_return = []\n    assert not(needToMerge)\n\n\n    #do we need to split any clusters?\n    for cluster_index in range(len(cluster_centers)):\n        #print \&quot;splitting\&quot;\n        needToSplit = (sorted(users_in_each_cluster[cluster_index]) != sorted(list(set(users_in_each_cluster[cluster_index]))))\n        if needToSplit:\n            subcluster_centers = []\n            stillToSplit = []\n            X = np.array(pts_in_each_cluster[cluster_index])\n            #for epsilon in [30,25,20,15,10,5,1,0.1,0.01]:\n            for second_epsilon in range(200,1,-2):#[400,300,200,100,80,75,65,60,50,25,24,23,22,21,20,19,18,17,16,15,14,13,10,5,1]:\n                db = DBSCAN(eps=second_epsilon, min_samples=samples_needed).fit(X)\n\n                labels = db.labels_\n                subcluster_centers = []\n\n                needToSplit = False\n\n                for k in sorted(set(labels)):\n                    if k == -1:\n                        continue\n\n                    class_member_mask = (labels == k)\n                    users_in_subcluster = [u for u,l in zip(users_in_each_cluster[cluster_index],labels) if l == k]\n                    needToSplit =  (sorted(users_in_subcluster) != sorted(list(set(users_in_subcluster))))\n                    if needToSplit:\n                        stillToSplit = list(X[class_member_mask])\n                        break\n\n                    pts_in_cluster = list(X[class_member_mask])\n                    xSet,ySet = zip(*pts_in_cluster)\n                    subcluster_centers.append((np.mean(xSet),np.mean(ySet)))\n\n                if not(needToSplit):\n                    break\n\n\n            if needToSplit:\n                print \&quot;second is \&quot; + str(second_epsilon)\n                print stillToSplit\n                for i in range(len(stillToSplit)):\n                    p1 = stillToSplit[i]\n                    for j in range(len(stillToSplit[i+1:])):\n                        p2 = stillToSplit[j+i+1]\n                        print math.sqrt((p1[0]-p2[0])**2 + (p1[1]-p2[1])**2),\n                        #print (i,j+i+1),\n                    print\n                print X\n                print users_in_each_cluster[cluster_index]\n                raise CannotSplit(pts_in_each_cluster[cluster_index])\n            centers_to_return.extend(subcluster_centers)\n\n            #if needToSplit:\n            #    print pts_in_each_cluster[cluster_index]\n            #    print users_in_each_cluster[cluster_index]\n            #else:\n\n        else:\n            centers_to_return.append(cluster_centers[cluster_index])\n\n\n\n    return centers_to_return&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;apache-2.0&quot;}}},{&quot;rowIdx&quot;:10,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;jrleja/bsfh&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;misc/timings_pyfsps.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;3&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;4274&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#compare a lookup table of spectra at ages and metallicities to\n#calls to fsps.sps.get_spectrum() for different metallicities\nimport time, os, subprocess, re, sys\nimport numpy as np\n#import matplotlib.pyplot as pl\nimport fsps\nfrom prospect import sources as sps_basis\nfrom prospect.models import sedmodel\n\n\ndef run_command(cmd):\n    \&quot;\&quot;\&quot;\n    Open a child process, and return its exit status and stdout.\n\n    \&quot;\&quot;\&quot;\n    child = subprocess.Popen(cmd, shell=True, stderr=subprocess.PIPE,\n                             stdin=subprocess.PIPE, stdout=subprocess.PIPE)\n    out = [s for s in child.stdout]\n    w = child.wait()\n    return os.WEXITSTATUS(w), out\n\n\n# Check to make sure that the required environment variable is present.\ntry:\n    ev = os.environ[\&quot;SPS_HOME\&quot;]\nexcept KeyError:\n    raise ImportError(\&quot;You need to have the SPS_HOME environment variable\&quot;)\n\n# Check the SVN revision number.\ncmd = [\&quot;svnversion\&quot;, ev]\nstat, out = run_command(\&quot; \&quot;.join(cmd))\nfsps_vers = int(re.match(\&quot;^([0-9])+\&quot;, out[0]).group(0))\n\n\nsps = fsps.StellarPopulation(zcontinuous=True)\nprint('FSPS version = {}'.format(fsps_vers))\nprint('Zs={0}, N_lambda={1}'.format(sps.zlegend, len(sps.wavelengths)))\nprint('single age')\n\ndef spec_from_fsps(z, t, s):\n    t0 = time.time()\n    sps.params['logzsol'] = z\n    sps.params['sigma_smooth'] = s\n    sps.params['tage'] = t\n    wave, spec  = sps.get_spectrum(peraa=True, tage = sps.params['tage'])\n    #print(spec.shape)\n    return time.time()-t0\n\ndef mags_from_fsps(z, t, s):\n    t0 = time.time()\n    sps.params['zred']=t\n    sps.params['logzsol'] = z\n    sps.params['sigma_smooth'] = s\n    sps.params['tage'] = t\n    mags  = sps.get_mags(tage = sps.params['tage'], redshift=0.0)\n    #print(spec.shape)\n    return time.time()-t0\n\n\ndef spec_from_ztinterp(z, t, s):\n    t0 = time.time()\n    sps.params['logzsol'] = z\n    sps.params['sigma_smooth'] = s\n    sps.params['tage'] = t\n    sps.params['imf3'] = s\n    spec, m, l  = sps.ztinterp(sps.params['logzsol'], sps.params['tage'], peraa=True)\n    #print(spec.shape)\n    return time.time()-t0\n  \n\nif sys.argv[1] == 'mags':\n    from_fsps = mags_from_fsps\n    print('timing get_mags')\n    print('nbands = {}'.format(len(sps.get_mags(tage=1.0))))\nelif sys.argv[1] == 'spec':\n    from_fsps = spec_from_fsps\n    print('timing get_spectrum')\nelif sys.argv[1] == 'ztinterp':\n    from_fsps = spec_from_ztinterp\n    print('timing get_spectrum')\nelif sys.argv[1] == 'sedpy':\n    from sedpy import observate\n    nbands = len(sps.get_mags(tage=1.0))\n    fnames = nbands * ['sdss_r0']\n    filters = observate.load_filters(fnames)\n    \n    def mags_from_sedpy(z, t, s):\n        t0 = time.time()\n        sps.params['logzsol'] = z\n        sps.params['sigma_smooth'] = s\n        sps.params['tage'] = t\n        wave, spec  = sps.get_spectrum(peraa=True,\n                                       tage = sps.params['tage'])\n        mags = observate.getSED(wave, spec, filters)\n        return time.time()-t0\n    \n    from_fsps = mags_from_sedpy\n    \nsps.params['add_neb_emission'] = False\nsps.params['smooth_velocity'] = True\nsps.params['sfh'] = 0\n\nntry = 30\nzz = np.random.uniform(-1,0,ntry)\ntt = np.random.uniform(0.1,4,ntry)\nss = np.random.uniform(1,2.5,ntry)\n\n#make sure all z's already compiled\n_ =[from_fsps(z, 1.0, 0.0) for z in [-1, -0.8, -0.6, -0.4, -0.2, 0.0]]\nall_dur = []\nprint('no neb emission:')\ndur_many = np.zeros(ntry)\nfor i in xrange(ntry):\n    dur_many[i] = from_fsps(zz[i], tt[i], ss[i])\nprint('<t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))\nall_dur += [dur_many]\n\nprint('no neb emission, no smooth:')\ndur_many = np.zeros(ntry)\nfor i in xrange(ntry):\n    dur_many[i] = from_fsps(zz[i], tt[i], 0.0)\nprint('<t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))\nall_dur += [dur_many]\n\nsps.params['add_neb_emission'] = True    \nprint('neb emission:')\ndur_many = np.zeros(ntry)\nfor i in xrange(ntry):\n    dur_many[i] = from_fsps(zz[i], tt[i], ss[i])\nprint('<t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))\nall_dur += [dur_many]\n    \nprint('neb emission, no smooth:')\ndur_many = np.zeros(ntry)\nfor i in xrange(ntry):\n    dur_many[i] = from_fsps(zz[i], tt[i], 0.0)\nprint('<t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))\nall_dur += [dur_many]\n\n\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;mit&quot;}}},{&quot;rowIdx&quot;:11,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;ClinicalGraphics/scikit-image&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;doc/examples/xx_applications/plot_morphology.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;6&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;8329&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;\&quot;\&quot;\&quot;\n=======================\nMorphological Filtering\n=======================\n\nMorphological image processing is a collection of non-linear operations related\nto the shape or morphology of features in an image, such as boundaries,\nskeletons, etc. In any given technique, we probe an image with a small shape or\ntemplate called a structuring element, which defines the region of interest or\nneighborhood around a pixel.\n\nIn this document we outline the following basic morphological operations:\n\n1. Erosion\n2. Dilation\n3. Opening\n4. Closing\n5. White Tophat\n6. Black Tophat\n7. Skeletonize\n8. Convex Hull\n\n\nTo get started, let's load an image using ``io.imread``. Note that morphology\nfunctions only work on gray-scale or binary images, so we set ``as_grey=True``.\n\&quot;\&quot;\&quot;\n\nimport matplotlib.pyplot as plt\nfrom skimage.data import data_dir\nfrom skimage.util import img_as_ubyte\nfrom skimage import io\n\nphantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))\nfig, ax = plt.subplots()\nax.imshow(phantom, cmap=plt.cm.gray)\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nLet's also define a convenience function for plotting comparisons:\n\&quot;\&quot;\&quot;\n\ndef plot_comparison(original, filtered, filter_name):\n\n    fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(8, 4), sharex=True, sharey=True)\n    ax1.imshow(original, cmap=plt.cm.gray)\n    ax1.set_title('original')\n    ax1.axis('off')\n    ax1.set_adjustable('box-forced')\n    ax2.imshow(filtered, cmap=plt.cm.gray)\n    ax2.set_title(filter_name)\n    ax2.axis('off')\n    ax2.set_adjustable('box-forced')\n\n\&quot;\&quot;\&quot;\nErosion\n=======\n\nMorphological ``erosion`` sets a pixel at (i, j) to the *minimum over all\npixels in the neighborhood centered at (i, j)*. The structuring element,\n``selem``, passed to ``erosion`` is a boolean array that describes this\nneighborhood. Below, we use ``disk`` to create a circular structuring element,\nwhich we use for most of the following examples.\n\&quot;\&quot;\&quot;\n\nfrom skimage.morphology import erosion, dilation, opening, closing, white_tophat\nfrom skimage.morphology import black_tophat, skeletonize, convex_hull_image\nfrom skimage.morphology import disk\n\nselem = disk(6)\neroded = erosion(phantom, selem)\nplot_comparison(phantom, eroded, 'erosion')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nNotice how the white boundary of the image disappears or gets eroded as we\nincrease the size of the disk. Also notice the increase in size of the two\nblack ellipses in the center and the disappearance of the 3 light grey\npatches in the lower part of the image.\n\n\nDilation\n========\n\nMorphological ``dilation`` sets a pixel at (i, j) to the *maximum over all\npixels in the neighborhood centered at (i, j)*. Dilation enlarges bright\nregions and shrinks dark regions.\n\&quot;\&quot;\&quot;\n\ndilated = dilation(phantom, selem)\nplot_comparison(phantom, dilated, 'dilation')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nNotice how the white boundary of the image thickens, or gets dilated, as we\nincrease the size of the disk. Also notice the decrease in size of the two\nblack ellipses in the centre, and the thickening of the light grey circle in\nthe center and the 3 patches in the lower part of the image.\n\n\nOpening\n=======\n\nMorphological ``opening`` on an image is defined as an *erosion followed by a\ndilation*. Opening can remove small bright spots (i.e. \&quot;salt\&quot;) and connect\nsmall dark cracks.\n\&quot;\&quot;\&quot;\n\nopened = opening(phantom, selem)\nplot_comparison(phantom, opened, 'opening')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nSince ``opening`` an image starts with an erosion operation, light regions that\nare *smaller* than the structuring element are removed. The dilation operation\nthat follows ensures that light regions that are *larger* than the structuring\nelement retain their original size. Notice how the light and dark shapes in the\ncenter their original thickness but the 3 lighter patches in the bottom get\ncompletely eroded. The size dependence is highlighted by the outer white ring:\nThe parts of the ring thinner than the structuring element were completely\nerased, while the thicker region at the top retains its original thickness.\n\n\nClosing\n=======\n\nMorphological ``closing`` on an image is defined as a *dilation followed by an\nerosion*. Closing can remove small dark spots (i.e. \&quot;pepper\&quot;) and connect\nsmall bright cracks.\n\nTo illustrate this more clearly, let's add a small crack to the white border:\n\&quot;\&quot;\&quot;\n\nphantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))\nphantom[10:30, 200:210] = 0\n\nclosed = closing(phantom, selem)\nplot_comparison(phantom, closed, 'closing')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nSince ``closing`` an image starts with an dilation operation, dark regions\nthat are *smaller* than the structuring element are removed. The dilation\noperation that follows ensures that dark regions that are *larger* than the\nstructuring element retain their original size. Notice how the white ellipses\nat the bottom get connected because of dilation, but other dark region retain\ntheir original sizes. Also notice how the crack we added is mostly removed.\n\n\nWhite tophat\n============\n\nThe ``white_tophat`` of an image is defined as the *image minus its\nmorphological opening*. This operation returns the bright spots of the image\nthat are smaller than the structuring element.\n\nTo make things interesting, we'll add bright and dark spots to the image:\n\&quot;\&quot;\&quot;\n\nphantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))\nphantom[340:350, 200:210] = 255\nphantom[100:110, 200:210] = 0\n\nw_tophat = white_tophat(phantom, selem)\nplot_comparison(phantom, w_tophat, 'white tophat')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nAs you can see, the 10-pixel wide white square is highlighted since it is\nsmaller than the structuring element. Also, the thin, white edges around most\nof the ellipse are retained because they're smaller than the structuring\nelement, but the thicker region at the top disappears.\n\n\nBlack tophat\n============\n\nThe ``black_tophat`` of an image is defined as its morphological **closing\nminus the original image**. This operation returns the *dark spots of the\nimage that are smaller than the structuring element*.\n\&quot;\&quot;\&quot;\n\nb_tophat = black_tophat(phantom, selem)\nplot_comparison(phantom, b_tophat, 'black tophat')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nAs you can see, the 10-pixel wide black square is highlighted since it is\nsmaller than the structuring element.\n\n\nDuality\n-------\n\nAs you should have noticed, many of these operations are simply the reverse\nof another operation. This duality can be summarized as follows:\n\n1. Erosion <-> Dilation\n2. Opening <-> Closing\n3. White tophat <-> Black tophat\n\n\nSkeletonize\n===========\n\nThinning is used to reduce each connected component in a binary image to a\n*single-pixel wide skeleton*. It is important to note that this is performed\non binary images only.\n\n\&quot;\&quot;\&quot;\n\nfrom skimage import img_as_bool\nhorse = ~img_as_bool(io.imread(data_dir+'/horse.png', as_grey=True))\n\nsk = skeletonize(horse)\nplot_comparison(horse, sk, 'skeletonize')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nAs the name suggests, this technique is used to thin the image to 1-pixel wide\nskeleton by applying thinning successively.\n\n\nConvex hull\n===========\n\nThe ``convex_hull_image`` is the *set of pixels included in the smallest\nconvex polygon that surround all white pixels in the input image*. Again note\nthat this is also performed on binary images.\n\n\&quot;\&quot;\&quot;\n\nhull1 = convex_hull_image(horse)\nplot_comparison(horse, hull1, 'convex hull')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\nAs the figure illustrates, ``convex_hull_image`` gives the smallest polygon\nwhich covers the white or True completely in the image.\n\nIf we add a small grain to the image, we can see how the convex hull adapts to\nenclose that grain:\n\&quot;\&quot;\&quot;\n\nimport numpy as np\n\nhorse2 = np.copy(horse)\nhorse2[45:50, 75:80] = 1\n\nhull2 = convex_hull_image(horse2)\nplot_comparison(horse2, hull2, 'convex hull')\n\n\&quot;\&quot;\&quot;\n.. image:: PLOT2RST.current_figure\n\n\nAdditional Resources\n====================\n\n1. `MathWorks tutorial on morphological processing\n<http://www.mathworks.com/help/images/morphology-fundamentals-dilation-and-erosion.html>`_\n2. `Auckland university's tutorial on Morphological Image Processing\n<http://www.cs.auckland.ac.nz/courses/compsci773s1c/lectures/ImageProcessing-html/topic4.htm>`_\n3. http://en.wikipedia.org/wiki/Mathematical_morphology\n\n\&quot;\&quot;\&quot;\n\nplt.show()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;bsd-3-clause&quot;}}},{&quot;rowIdx&quot;:12,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;codenote/chromium-test&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;ppapi/native_client/tests/breakpad_crash_test/crash_dump_tester.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;6&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;8213&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#!/usr/bin/python\n# Copyright (c) 2012 The Chromium Authors. All rights reserved.\n# Use of this source code is governed by a BSD-style license that can be\n# found in the LICENSE file.\n\nimport os\nimport subprocess\nimport sys\nimport tempfile\nimport time\n\nscript_dir = os.path.dirname(__file__)\nsys.path.append(os.path.join(script_dir,\n                             '../../tools/browser_tester'))\n\nimport browser_tester\nimport browsertester.browserlauncher\n\n# This script extends browser_tester to check for the presence of\n# Breakpad crash dumps.\n\n\n# This reads a file of lines containing 'key:value' pairs.\n# The file contains entries like the following:\n#   plat:Win32\n#   prod:Chromium\n#   ptype:nacl-loader\n#   rept:crash svc\ndef ReadDumpTxtFile(filename):\n  dump_info = {}\n  fh = open(filename, 'r')\n  for line in fh:\n    if ':' in line:\n      key, value = line.rstrip().split(':', 1)\n      dump_info[key] = value\n  fh.close()\n  return dump_info\n\n\ndef StartCrashService(browser_path, dumps_dir, windows_pipe_name,\n                      cleanup_funcs, crash_service_exe):\n  # Find crash_service.exe relative to chrome.exe.  This is a bit icky.\n  browser_dir = os.path.dirname(browser_path)\n  proc = subprocess.Popen([os.path.join(browser_dir, crash_service_exe),\n                           '--v=1',  # Verbose output for debugging failures\n                           '--dumps-dir=%s' % dumps_dir,\n                           '--pipe-name=%s' % windows_pipe_name])\n\n  def Cleanup():\n    # Note that if the process has already exited, this will raise\n    # an 'Access is denied' WindowsError exception, but\n    # crash_service.exe is not supposed to do this and such\n    # behaviour should make the test fail.\n    proc.terminate()\n    status = proc.wait()\n    sys.stdout.write('crash_dump_tester: %s exited with status %s\\n'\n                     % (crash_service_exe, status))\n\n  cleanup_funcs.append(Cleanup)\n\n\ndef ListPathsInDir(dir_path):\n  if os.path.exists(dir_path):\n    return [os.path.join(dir_path, name)\n            for name in os.listdir(dir_path)]\n  else:\n    return []\n\n\ndef GetDumpFiles(dumps_dirs):\n  all_files = [filename\n               for dumps_dir in dumps_dirs\n               for filename in ListPathsInDir(dumps_dir)]\n  sys.stdout.write('crash_dump_tester: Found %i files\\n' % len(all_files))\n  for dump_file in all_files:\n    sys.stdout.write('  %s (size %i)\\n'\n                     % (dump_file, os.stat(dump_file).st_size))\n  return [dump_file for dump_file in all_files\n          if dump_file.endswith('.dmp')]\n\n\ndef Main(cleanup_funcs):\n  parser = browser_tester.BuildArgParser()\n  parser.add_option('--expected_crash_dumps', dest='expected_crash_dumps',\n                    type=int, default=0,\n                    help='The number of crash dumps that we should expect')\n  parser.add_option('--expected_process_type_for_crash',\n                    dest='expected_process_type_for_crash',\n                    type=str, default='nacl-loader',\n                    help='The type of Chromium process that we expect the '\n                    'crash dump to be for')\n  # Ideally we would just query the OS here to find out whether we are\n  # running x86-32 or x86-64 Windows, but Python's win32api module\n  # does not contain a wrapper for GetNativeSystemInfo(), which is\n  # what NaCl uses to check this, or for IsWow64Process(), which is\n  # what Chromium uses.  Instead, we just rely on the build system to\n  # tell us.\n  parser.add_option('--win64', dest='win64', action='store_true',\n                    help='Pass this if we are running tests for x86-64 Windows')\n  options, args = parser.parse_args()\n\n  temp_dir = tempfile.mkdtemp(prefix='nacl_crash_dump_tester_')\n  def CleanUpTempDir():\n    browsertester.browserlauncher.RemoveDirectory(temp_dir)\n  cleanup_funcs.append(CleanUpTempDir)\n\n  # To get a guaranteed unique pipe name, use the base name of the\n  # directory we just created.\n  windows_pipe_name = r'\\\\.\\pipe\\%s_crash_service' % os.path.basename(temp_dir)\n\n  # This environment variable enables Breakpad crash dumping in\n  # non-official builds of Chromium.\n  os.environ['CHROME_HEADLESS'] = '1'\n  if sys.platform == 'win32':\n    dumps_dir = temp_dir\n    # Override the default (global) Windows pipe name that Chromium will\n    # use for out-of-process crash reporting.\n    os.environ['CHROME_BREAKPAD_PIPE_NAME'] = windows_pipe_name\n    # Launch the x86-32 crash service so that we can handle crashes in\n    # the browser process.\n    StartCrashService(options.browser_path, dumps_dir, windows_pipe_name,\n                      cleanup_funcs, 'crash_service.exe')\n    if options.win64:\n      # Launch the x86-64 crash service so that we can handle crashes\n      # in the NaCl loader process (nacl64.exe).\n      StartCrashService(options.browser_path, dumps_dir, windows_pipe_name,\n                        cleanup_funcs, 'crash_service64.exe')\n    # We add a delay because there is probably a race condition:\n    # crash_service.exe might not have finished doing\n    # CreateNamedPipe() before NaCl does a crash dump and tries to\n    # connect to that pipe.\n    # TODO(mseaborn): We could change crash_service.exe to report when\n    # it has successfully created the named pipe.\n    time.sleep(1)\n  elif sys.platform == 'darwin':\n    dumps_dir = temp_dir\n    os.environ['BREAKPAD_DUMP_LOCATION'] = dumps_dir\n  elif sys.platform.startswith('linux'):\n    # The \&quot;--user-data-dir\&quot; option is not effective for the Breakpad\n    # setup in Linux Chromium, because Breakpad is initialized before\n    # \&quot;--user-data-dir\&quot; is read.  So we set HOME to redirect the crash\n    # dumps to a temporary directory.\n    home_dir = temp_dir\n    os.environ['HOME'] = home_dir\n    options.enable_crash_reporter = True\n\n  result = browser_tester.Run(options.url, options)\n\n  # Find crash dump results.\n  if sys.platform.startswith('linux'):\n    # Look in \&quot;~/.config/*/Crash Reports\&quot;.  This will find crash\n    # reports under ~/.config/chromium or ~/.config/google-chrome, or\n    # under other subdirectories in case the branding is changed.\n    dumps_dirs = [os.path.join(path, 'Crash Reports')\n                  for path in ListPathsInDir(os.path.join(home_dir, '.config'))]\n  else:\n    dumps_dirs = [dumps_dir]\n  dmp_files = GetDumpFiles(dumps_dirs)\n\n  failed = False\n  msg = ('crash_dump_tester: ERROR: Got %i crash dumps but expected %i\\n' %\n         (len(dmp_files), options.expected_crash_dumps))\n  if len(dmp_files) != options.expected_crash_dumps:\n    sys.stdout.write(msg)\n    failed = True\n\n  for dump_file in dmp_files:\n    # Sanity check: Make sure dumping did not fail after opening the file.\n    msg = 'crash_dump_tester: ERROR: Dump file is empty\\n'\n    if os.stat(dump_file).st_size == 0:\n      sys.stdout.write(msg)\n      failed = True\n\n    # On Windows, the crash dumps should come in pairs of a .dmp and\n    # .txt file.\n    if sys.platform == 'win32':\n      second_file = dump_file[:-4] + '.txt'\n      msg = ('crash_dump_tester: ERROR: File %r is missing a corresponding '\n             '%r file\\n' % (dump_file, second_file))\n      if not os.path.exists(second_file):\n        sys.stdout.write(msg)\n        failed = True\n        continue\n      # Check that the crash dump comes from the NaCl process.\n      dump_info = ReadDumpTxtFile(second_file)\n      if 'ptype' in dump_info:\n        msg = ('crash_dump_tester: ERROR: Unexpected ptype value: %r != %r\\n'\n               % (dump_info['ptype'], options.expected_process_type_for_crash))\n        if dump_info['ptype'] != options.expected_process_type_for_crash:\n          sys.stdout.write(msg)\n          failed = True\n      else:\n        sys.stdout.write('crash_dump_tester: ERROR: Missing ptype field\\n')\n        failed = True\n    # TODO(mseaborn): Ideally we would also check that a backtrace\n    # containing an expected function name can be extracted from the\n    # crash dump.\n\n  if failed:\n    sys.stdout.write('crash_dump_tester: FAILED\\n')\n    result = 1\n  else:\n    sys.stdout.write('crash_dump_tester: PASSED\\n')\n\n  return result\n\n\ndef MainWrapper():\n  cleanup_funcs = []\n  try:\n    return Main(cleanup_funcs)\n  finally:\n    for func in cleanup_funcs:\n      func()\n\n\nif __name__ == '__main__':\n  sys.exit(MainWrapper())\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;bsd-3-clause&quot;}}},{&quot;rowIdx&quot;:13,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;hainm/dask&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;dask/dataframe/shuffle.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;4&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;2967&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;from itertools import count\nfrom collections import Iterator\nfrom math import ceil\nfrom toolz import merge, accumulate, merge_sorted\nimport toolz\nfrom operator import getitem, setitem\nimport pandas as pd\nimport numpy as np\nfrom pframe import pframe\n\nfrom .. import threaded\nfrom .core import DataFrame, Series, get, names\nfrom ..compatibility import unicode\nfrom ..utils import ignoring\n\n\ntokens = ('-%d' % i for i in count(1))\n\n\ndef set_index(f, index, npartitions=None, **kwargs):\n    \&quot;\&quot;\&quot; Set DataFrame index to new column\n\n    Sorts index and realigns Dataframe to new sorted order.  This shuffles and\n    repartitions your data.\n    \&quot;\&quot;\&quot;\n    npartitions = npartitions or f.npartitions\n    if not isinstance(index, Series):\n        index2 = f[index]\n    else:\n        index2 = index\n\n    divisions = (index2\n                  .quantiles(np.linspace(0, 100, npartitions+1)[1:-1])\n                  .compute())\n    return f.set_partition(index, divisions, **kwargs)\n\n\npartition_names = ('set_partition-%d' % i for i in count(1))\n\ndef set_partition(f, index, divisions, get=threaded.get, **kwargs):\n    \&quot;\&quot;\&quot; Set new partitioning along index given divisions \&quot;\&quot;\&quot;\n    divisions = unique(divisions)\n    name = next(names)\n    if isinstance(index, Series):\n        assert index.divisions == f.divisions\n        dsk = dict(((name, i), (f._partition_type.set_index, block, ind))\n                for i, (block, ind) in enumerate(zip(f._keys(), index._keys())))\n        f2 = type(f)(merge(f.dask, index.dask, dsk), name,\n                       f.column_info, f.divisions)\n    else:\n        dsk = dict(((name, i), (f._partition_type.set_index, block, index))\n                for i, block in enumerate(f._keys()))\n        f2 = type(f)(merge(f.dask, dsk), name, f.column_info, f.divisions)\n\n    head = f2.head()\n    pf = pframe(like=head, divisions=divisions, **kwargs)\n\n    def append(block):\n        pf.append(block)\n        return 0\n\n    f2.map_blocks(append).compute(get=get)\n    pf.flush()\n\n    return from_pframe(pf)\n\n\ndef from_pframe(pf):\n    \&quot;\&quot;\&quot; Load dask.array from pframe \&quot;\&quot;\&quot;\n    name = next(names)\n    dsk = dict(((name, i), (pframe.get_partition, pf, i))\n                for i in range(pf.npartitions))\n\n    return DataFrame(dsk, name, pf.columns, pf.divisions)\n\n\ndef unique(divisions):\n    \&quot;\&quot;\&quot; Polymorphic unique function\n\n    >>> list(unique([1, 2, 3, 1, 2, 3]))\n    [1, 2, 3]\n\n    >>> unique(np.array([1, 2, 3, 1, 2, 3]))\n    array([1, 2, 3])\n\n    >>> unique(pd.Categorical(['Alice', 'Bob', 'Alice'], ordered=False))\n    [Alice, Bob]\n    Categories (2, object): [Alice, Bob]\n    \&quot;\&quot;\&quot;\n    if isinstance(divisions, np.ndarray):\n        return np.unique(divisions)\n    if isinstance(divisions, pd.Categorical):\n        return pd.Categorical.from_codes(np.unique(divisions.codes),\n                divisions.categories, divisions.ordered)\n    if isinstance(divisions, (tuple, list, Iterator)):\n        return tuple(toolz.unique(divisions))\n    raise NotImplementedError()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;bsd-3-clause&quot;}}},{&quot;rowIdx&quot;:14,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;allanino/nupic&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;external/linux32/lib/python2.6/site-packages/matplotlib/backends/backend_tkagg.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;69&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;24593&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;# Todd Miller   jmiller@stsci.edu\n\nfrom __future__ import division\n\nimport os, sys, math\n\nimport Tkinter as Tk, FileDialog\nimport tkagg                 # Paint image to Tk photo blitter extension\nfrom backend_agg import FigureCanvasAgg\n\nimport os.path\n\nimport matplotlib\nfrom matplotlib.cbook import is_string_like\nfrom matplotlib.backend_bases import RendererBase, GraphicsContextBase, \\\n     FigureManagerBase, FigureCanvasBase, NavigationToolbar2, cursors\n\nfrom matplotlib.figure import Figure\nfrom matplotlib._pylab_helpers import Gcf\n\nimport matplotlib.windowing as windowing\nfrom matplotlib.widgets import SubplotTool\n\nimport matplotlib.cbook as cbook\n\nrcParams = matplotlib.rcParams\nverbose = matplotlib.verbose\n\n\nbackend_version = Tk.TkVersion\n\n# the true dots per inch on the screen; should be display dependent\n# see http://groups.google.com/groups?q=screen+dpi+x11&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;safe=off&amp;selm=7077.26e81ad5%40swift.cs.tcd.ie&amp;rnum=5 for some info about screen dpi\nPIXELS_PER_INCH = 75\n\ncursord = {\n    cursors.MOVE: \&quot;fleur\&quot;,\n    cursors.HAND: \&quot;hand2\&quot;,\n    cursors.POINTER: \&quot;arrow\&quot;,\n    cursors.SELECT_REGION: \&quot;tcross\&quot;,\n    }\n\n\ndef round(x):\n    return int(math.floor(x+0.5))\n\ndef raise_msg_to_str(msg):\n    \&quot;\&quot;\&quot;msg is a return arg from a raise.  Join with new lines\&quot;\&quot;\&quot;\n    if not is_string_like(msg):\n        msg = '\\n'.join(map(str, msg))\n    return msg\n\ndef error_msg_tkpaint(msg, parent=None):\n    import tkMessageBox\n    tkMessageBox.showerror(\&quot;matplotlib\&quot;, msg)\n\ndef draw_if_interactive():\n    if matplotlib.is_interactive():\n        figManager =  Gcf.get_active()\n        if figManager is not None:\n            figManager.show()\n\n\ndef show():\n    \&quot;\&quot;\&quot;\n    Show all the figures and enter the gtk mainloop\n\n    This should be the last line of your script.  This function sets\n    interactive mode to True, as detailed on\n    http://matplotlib.sf.net/interactive.html\n    \&quot;\&quot;\&quot;\n    for manager in Gcf.get_all_fig_managers():\n        manager.show()\n    import matplotlib\n    matplotlib.interactive(True)\n    if rcParams['tk.pythoninspect']:\n        os.environ['PYTHONINSPECT'] = '1'\n    if show._needmain:\n        Tk.mainloop()\n        show._needmain = False\nshow._needmain = True\n\ndef new_figure_manager(num, *args, **kwargs):\n    \&quot;\&quot;\&quot;\n    Create a new figure manager instance\n    \&quot;\&quot;\&quot;\n    _focus = windowing.FocusManager()\n    FigureClass = kwargs.pop('FigureClass', Figure)\n    figure = FigureClass(*args, **kwargs)\n    window = Tk.Tk()\n    canvas = FigureCanvasTkAgg(figure, master=window)\n    figManager = FigureManagerTkAgg(canvas, num, window)\n    if matplotlib.is_interactive():\n        figManager.show()\n    return figManager\n\n\nclass FigureCanvasTkAgg(FigureCanvasAgg):\n    keyvald = {65507 : 'control',\n               65505 : 'shift',\n               65513 : 'alt',\n               65508 : 'control',\n               65506 : 'shift',\n               65514 : 'alt',\n               65361 : 'left',\n               65362 : 'up',\n               65363 : 'right',\n               65364 : 'down',\n               65307 : 'escape',\n               65470 : 'f1',\n               65471 : 'f2',\n               65472 : 'f3',\n               65473 : 'f4',\n               65474 : 'f5',\n               65475 : 'f6',\n               65476 : 'f7',\n               65477 : 'f8',\n               65478 : 'f9',\n               65479 : 'f10',\n               65480 : 'f11',\n               65481 : 'f12',\n               65300 : 'scroll_lock',\n               65299 : 'break',\n               65288 : 'backspace',\n               65293 : 'enter',\n               65379 : 'insert',\n               65535 : 'delete',\n               65360 : 'home',\n               65367 : 'end',\n               65365 : 'pageup',\n               65366 : 'pagedown',\n               65438 : '0',\n               65436 : '1',\n               65433 : '2',\n               65435 : '3',\n               65430 : '4',\n               65437 : '5',\n               65432 : '6',\n               65429 : '7',\n               65431 : '8',\n               65434 : '9',\n               65451 : '+',\n               65453 : '-',\n               65450 : '*',\n               65455 : '/',\n               65439 : 'dec',\n               65421 : 'enter',\n               }\n\n    def __init__(self, figure, master=None, resize_callback=None):\n        FigureCanvasAgg.__init__(self, figure)\n        self._idle = True\n        t1,t2,w,h = self.figure.bbox.bounds\n        w, h = int(w), int(h)\n        self._tkcanvas = Tk.Canvas(\n            master=master, width=w, height=h, borderwidth=4)\n        self._tkphoto = Tk.PhotoImage(\n            master=self._tkcanvas, width=w, height=h)\n        self._tkcanvas.create_image(w/2, h/2, image=self._tkphoto)\n        self._resize_callback = resize_callback\n        self._tkcanvas.bind(\&quot;<Configure>\&quot;, self.resize)\n        self._tkcanvas.bind(\&quot;<Key>\&quot;, self.key_press)\n        self._tkcanvas.bind(\&quot;<Motion>\&quot;, self.motion_notify_event)\n        self._tkcanvas.bind(\&quot;<KeyRelease>\&quot;, self.key_release)\n        for name in \&quot;<Button-1>\&quot;, \&quot;<Button-2>\&quot;, \&quot;<Button-3>\&quot;:\n            self._tkcanvas.bind(name, self.button_press_event)\n        for name in \&quot;<ButtonRelease-1>\&quot;, \&quot;<ButtonRelease-2>\&quot;, \&quot;<ButtonRelease-3>\&quot;:\n            self._tkcanvas.bind(name, self.button_release_event)\n\n        # Mouse wheel on Linux generates button 4/5 events\n        for name in \&quot;<Button-4>\&quot;, \&quot;<Button-5>\&quot;:\n            self._tkcanvas.bind(name, self.scroll_event)\n        # Mouse wheel for windows goes to the window with the focus.\n        # Since the canvas won't usually have the focus, bind the\n        # event to the window containing the canvas instead.\n        # See http://wiki.tcl.tk/3893 (mousewheel) for details\n        root = self._tkcanvas.winfo_toplevel()\n        root.bind(\&quot;<MouseWheel>\&quot;, self.scroll_event_windows)\n\n        self._master = master\n        self._tkcanvas.focus_set()\n\n        # a dict from func-> cbook.Scheduler threads\n        self.sourced = dict()\n\n        # call the idle handler\n        def on_idle(*ignore):\n            self.idle_event()\n            return True\n\n        # disable until you figure out how to handle threads and interrupts\n        #t = cbook.Idle(on_idle)\n        #self._tkcanvas.after_idle(lambda *ignore: t.start())\n\n    def resize(self, event):\n        width, height = event.width, event.height\n        if self._resize_callback is not None:\n            self._resize_callback(event)\n\n        # compute desired figure size in inches\n\tdpival = self.figure.dpi\n        winch = width/dpival\n        hinch = height/dpival\n        self.figure.set_size_inches(winch, hinch)\n\n\n        self._tkcanvas.delete(self._tkphoto)\n        self._tkphoto = Tk.PhotoImage(\n            master=self._tkcanvas, width=width, height=height)\n        self._tkcanvas.create_image(width/2,height/2,image=self._tkphoto)\n        self.resize_event()\n        self.show()\n\n    def draw(self):\n        FigureCanvasAgg.draw(self)\n        tkagg.blit(self._tkphoto, self.renderer._renderer, colormode=2)\n        self._master.update_idletasks()\n\n    def blit(self, bbox=None):\n        tkagg.blit(self._tkphoto, self.renderer._renderer, bbox=bbox, colormode=2)\n        self._master.update_idletasks()\n\n    show = draw\n\n    def draw_idle(self):\n        'update drawing area only if idle'\n        d = self._idle\n        self._idle = False\n        def idle_draw(*args):\n            self.draw()\n            self._idle = True\n\n        if d: self._tkcanvas.after_idle(idle_draw)\n\n    def get_tk_widget(self):\n        \&quot;\&quot;\&quot;returns the Tk widget used to implement FigureCanvasTkAgg.\n        Although the initial implementation uses a Tk canvas,  this routine\n        is intended to hide that fact.\n        \&quot;\&quot;\&quot;\n        return self._tkcanvas\n\n    def motion_notify_event(self, event):\n        x = event.x\n        # flipy so y=0 is bottom of canvas\n        y = self.figure.bbox.height - event.y\n        FigureCanvasBase.motion_notify_event(self, x, y, guiEvent=event)\n\n\n    def button_press_event(self, event):\n        x = event.x\n        # flipy so y=0 is bottom of canvas\n        y = self.figure.bbox.height - event.y\n        num = getattr(event, 'num', None)\n\n        if sys.platform=='darwin':\n            # 2 and 3 were reversed on the OSX platform I\n            # tested under tkagg\n            if   num==2: num=3\n            elif num==3: num=2\n\n        FigureCanvasBase.button_press_event(self, x, y, num, guiEvent=event)\n\n    def button_release_event(self, event):\n        x = event.x\n        # flipy so y=0 is bottom of canvas\n        y = self.figure.bbox.height - event.y\n\n        num = getattr(event, 'num', None)\n\n        if sys.platform=='darwin':\n            # 2 and 3 were reversed on the OSX platform I\n            # tested under tkagg\n            if   num==2: num=3\n            elif num==3: num=2\n\n        FigureCanvasBase.button_release_event(self, x, y, num, guiEvent=event)\n\n    def scroll_event(self, event):\n        x = event.x\n        y = self.figure.bbox.height - event.y\n        num = getattr(event, 'num', None)\n        if   num==4: step = -1\n        elif num==5: step = +1\n        else:        step =  0\n\n        FigureCanvasBase.scroll_event(self, x, y, step, guiEvent=event)\n\n    def scroll_event_windows(self, event):\n        \&quot;\&quot;\&quot;MouseWheel event processor\&quot;\&quot;\&quot;\n        # need to find the window that contains the mouse\n        w = event.widget.winfo_containing(event.x_root, event.y_root)\n        if w == self._tkcanvas:\n            x = event.x_root - w.winfo_rootx()\n            y = event.y_root - w.winfo_rooty()\n            y = self.figure.bbox.height - y\n            step = event.delta/120.\n            FigureCanvasBase.scroll_event(self, x, y, step, guiEvent=event)\n\n    def _get_key(self, event):\n        val = event.keysym_num\n        if val in self.keyvald:\n            key = self.keyvald[val]\n        elif val<256:\n            key = chr(val)\n        else:\n            key = None\n        return key\n\n\n    def key_press(self, event):\n        key = self._get_key(event)\n        FigureCanvasBase.key_press_event(self, key, guiEvent=event)\n\n    def key_release(self, event):\n        key = self._get_key(event)\n        FigureCanvasBase.key_release_event(self, key, guiEvent=event)\n\n    def flush_events(self):\n        self._master.update()\n\n    def start_event_loop(self,timeout):\n        FigureCanvasBase.start_event_loop_default(self,timeout)\n    start_event_loop.__doc__=FigureCanvasBase.start_event_loop_default.__doc__\n\n    def stop_event_loop(self):\n        FigureCanvasBase.stop_event_loop_default(self)\n    stop_event_loop.__doc__=FigureCanvasBase.stop_event_loop_default.__doc__\n\nclass FigureManagerTkAgg(FigureManagerBase):\n    \&quot;\&quot;\&quot;\n    Public attributes\n\n    canvas      : The FigureCanvas instance\n    num         : The Figure number\n    toolbar     : The tk.Toolbar\n    window      : The tk.Window\n    \&quot;\&quot;\&quot;\n    def __init__(self, canvas, num, window):\n        FigureManagerBase.__init__(self, canvas, num)\n        self.window = window\n        self.window.withdraw()\n        self.window.wm_title(\&quot;Figure %d\&quot; % num)\n        self.canvas = canvas\n        self._num =  num\n        t1,t2,w,h = canvas.figure.bbox.bounds\n        w, h = int(w), int(h)\n        self.window.minsize(int(w*3/4),int(h*3/4))\n        if matplotlib.rcParams['toolbar']=='classic':\n            self.toolbar = NavigationToolbar( canvas, self.window )\n        elif matplotlib.rcParams['toolbar']=='toolbar2':\n            self.toolbar = NavigationToolbar2TkAgg( canvas, self.window )\n        else:\n            self.toolbar = None\n        if self.toolbar is not None:\n            self.toolbar.update()\n        self.canvas._tkcanvas.pack(side=Tk.TOP, fill=Tk.BOTH, expand=1)\n        self._shown = False\n\n        def notify_axes_change(fig):\n            'this will be called whenever the current axes is changed'\n            if self.toolbar != None: self.toolbar.update()\n        self.canvas.figure.add_axobserver(notify_axes_change)\n\n\n\n        # attach a show method to the figure for pylab ease of use\n        self.canvas.figure.show = lambda *args: self.show()\n\n\n    def resize(self, event):\n        width, height = event.width, event.height\n        self.toolbar.configure(width=width) # , height=height)\n\n\n    def show(self):\n        \&quot;\&quot;\&quot;\n        this function doesn't segfault but causes the\n        PyEval_RestoreThread: NULL state bug on win32\n        \&quot;\&quot;\&quot;\n\n        def destroy(*args):\n            self.window = None\n            Gcf.destroy(self._num)\n\n        if not self._shown: self.canvas._tkcanvas.bind(\&quot;<Destroy>\&quot;, destroy)\n        _focus = windowing.FocusManager()\n        if not self._shown:\n            self.window.deiconify()\n            # anim.py requires this\n            if sys.platform=='win32' : self.window.update()\n        else:\n            self.canvas.draw()\n        self._shown = True\n\n\n    def destroy(self, *args):\n        if Gcf.get_num_fig_managers()==0 and not matplotlib.is_interactive():\n            if self.window is not None:\n                self.window.quit()\n        if self.window is not None:\n            #self.toolbar.destroy()\n            self.window.destroy()\n\n            pass\n        self.window = None\n\n    def set_window_title(self, title):\n        self.window.wm_title(title)\n\nclass AxisMenu:\n    def __init__(self, master, naxes):\n        self._master = master\n        self._naxes = naxes\n        self._mbar = Tk.Frame(master=master, relief=Tk.RAISED, borderwidth=2)\n        self._mbar.pack(side=Tk.LEFT)\n        self._mbutton = Tk.Menubutton(\n            master=self._mbar, text=\&quot;Axes\&quot;, underline=0)\n        self._mbutton.pack(side=Tk.LEFT, padx=\&quot;2m\&quot;)\n        self._mbutton.menu = Tk.Menu(self._mbutton)\n        self._mbutton.menu.add_command(\n            label=\&quot;Select All\&quot;, command=self.select_all)\n        self._mbutton.menu.add_command(\n            label=\&quot;Invert All\&quot;, command=self.invert_all)\n        self._axis_var = []\n        self._checkbutton = []\n        for i in range(naxes):\n            self._axis_var.append(Tk.IntVar())\n            self._axis_var[i].set(1)\n            self._checkbutton.append(self._mbutton.menu.add_checkbutton(\n                label = \&quot;Axis %d\&quot; % (i+1),\n                variable=self._axis_var[i],\n                command=self.set_active))\n            self._mbutton.menu.invoke(self._mbutton.menu.index(\&quot;Select All\&quot;))\n        self._mbutton['menu'] = self._mbutton.menu\n        self._mbar.tk_menuBar(self._mbutton)\n        self.set_active()\n\n    def adjust(self, naxes):\n        if self._naxes < naxes:\n            for i in range(self._naxes, naxes):\n                self._axis_var.append(Tk.IntVar())\n                self._axis_var[i].set(1)\n                self._checkbutton.append( self._mbutton.menu.add_checkbutton(\n                    label = \&quot;Axis %d\&quot; % (i+1),\n                    variable=self._axis_var[i],\n                    command=self.set_active))\n        elif self._naxes > naxes:\n            for i in range(self._naxes-1, naxes-1, -1):\n                del self._axis_var[i]\n                self._mbutton.menu.forget(self._checkbutton[i])\n                del self._checkbutton[i]\n        self._naxes = naxes\n        self.set_active()\n\n    def get_indices(self):\n        a = [i for i in range(len(self._axis_var)) if self._axis_var[i].get()]\n        return a\n\n    def set_active(self):\n        self._master.set_active(self.get_indices())\n\n    def invert_all(self):\n        for a in self._axis_var:\n            a.set(not a.get())\n        self.set_active()\n\n    def select_all(self):\n        for a in self._axis_var:\n            a.set(1)\n        self.set_active()\n\nclass NavigationToolbar(Tk.Frame):\n    \&quot;\&quot;\&quot;\n    Public attriubutes\n\n      canvas   - the FigureCanvas  (gtk.DrawingArea)\n      win   - the gtk.Window\n\n    \&quot;\&quot;\&quot;\n    def _Button(self, text, file, command):\n        file = os.path.join(rcParams['datapath'], 'images', file)\n        im = Tk.PhotoImage(master=self, file=file)\n        b = Tk.Button(\n            master=self, text=text, padx=2, pady=2, image=im, command=command)\n        b._ntimage = im\n        b.pack(side=Tk.LEFT)\n        return b\n\n    def __init__(self, canvas, window):\n        self.canvas = canvas\n        self.window = window\n\n        xmin, xmax = canvas.figure.bbox.intervalx\n        height, width = 50, xmax-xmin\n        Tk.Frame.__init__(self, master=self.window,\n                          width=width, height=height,\n                          borderwidth=2)\n\n        self.update()  # Make axes menu\n\n        self.bLeft = self._Button(\n            text=\&quot;Left\&quot;, file=\&quot;stock_left.ppm\&quot;,\n            command=lambda x=-1: self.panx(x))\n\n        self.bRight = self._Button(\n            text=\&quot;Right\&quot;, file=\&quot;stock_right.ppm\&quot;,\n            command=lambda x=1: self.panx(x))\n\n        self.bZoomInX = self._Button(\n            text=\&quot;ZoomInX\&quot;,file=\&quot;stock_zoom-in.ppm\&quot;,\n            command=lambda x=1: self.zoomx(x))\n\n        self.bZoomOutX = self._Button(\n            text=\&quot;ZoomOutX\&quot;, file=\&quot;stock_zoom-out.ppm\&quot;,\n            command=lambda x=-1: self.zoomx(x))\n\n        self.bUp = self._Button(\n            text=\&quot;Up\&quot;, file=\&quot;stock_up.ppm\&quot;,\n            command=lambda y=1: self.pany(y))\n\n        self.bDown = self._Button(\n            text=\&quot;Down\&quot;, file=\&quot;stock_down.ppm\&quot;,\n            command=lambda y=-1: self.pany(y))\n\n        self.bZoomInY = self._Button(\n            text=\&quot;ZoomInY\&quot;, file=\&quot;stock_zoom-in.ppm\&quot;,\n            command=lambda y=1: self.zoomy(y))\n\n        self.bZoomOutY = self._Button(\n            text=\&quot;ZoomOutY\&quot;,file=\&quot;stock_zoom-out.ppm\&quot;,\n            command=lambda y=-1: self.zoomy(y))\n\n        self.bSave = self._Button(\n            text=\&quot;Save\&quot;, file=\&quot;stock_save_as.ppm\&quot;,\n            command=self.save_figure)\n\n        self.pack(side=Tk.BOTTOM, fill=Tk.X)\n\n\n    def set_active(self, ind):\n        self._ind = ind\n        self._active = [ self._axes[i] for i in self._ind ]\n\n    def panx(self, direction):\n        for a in self._active:\n            a.xaxis.pan(direction)\n        self.canvas.draw()\n\n    def pany(self, direction):\n        for a in self._active:\n            a.yaxis.pan(direction)\n        self.canvas.draw()\n\n    def zoomx(self, direction):\n\n        for a in self._active:\n            a.xaxis.zoom(direction)\n        self.canvas.draw()\n\n    def zoomy(self, direction):\n\n        for a in self._active:\n            a.yaxis.zoom(direction)\n        self.canvas.draw()\n\n    def save_figure(self):\n        fs = FileDialog.SaveFileDialog(master=self.window,\n                                       title='Save the figure')\n        try:\n            self.lastDir\n        except AttributeError:\n            self.lastDir = os.curdir\n\n        fname = fs.go(dir_or_file=self.lastDir) # , pattern=\&quot;*.png\&quot;)\n        if fname is None: # Cancel\n            return\n\n        self.lastDir = os.path.dirname(fname)\n        try:\n            self.canvas.print_figure(fname)\n        except IOError, msg:\n            err = '\\n'.join(map(str, msg))\n            msg = 'Failed to save %s: Error msg was\\n\\n%s' % (\n                fname, err)\n            error_msg_tkpaint(msg)\n\n    def update(self):\n        _focus = windowing.FocusManager()\n        self._axes = self.canvas.figure.axes\n        naxes = len(self._axes)\n        if not hasattr(self, \&quot;omenu\&quot;):\n            self.set_active(range(naxes))\n            self.omenu = AxisMenu(master=self, naxes=naxes)\n        else:\n            self.omenu.adjust(naxes)\n\nclass NavigationToolbar2TkAgg(NavigationToolbar2, Tk.Frame):\n    \&quot;\&quot;\&quot;\n    Public attriubutes\n\n      canvas   - the FigureCanvas  (gtk.DrawingArea)\n      win   - the gtk.Window\n    \&quot;\&quot;\&quot;\n    def __init__(self, canvas, window):\n        self.canvas = canvas\n        self.window = window\n        self._idle = True\n        #Tk.Frame.__init__(self, master=self.canvas._tkcanvas)\n        NavigationToolbar2.__init__(self, canvas)\n\n    def destroy(self, *args):\n        del self.message\n        Tk.Frame.destroy(self, *args)\n\n    def set_message(self, s):\n        self.message.set(s)\n\n    def draw_rubberband(self, event, x0, y0, x1, y1):\n        height = self.canvas.figure.bbox.height\n        y0 =  height-y0\n        y1 =  height-y1\n        try: self.lastrect\n        except AttributeError: pass\n        else: self.canvas._tkcanvas.delete(self.lastrect)\n        self.lastrect = self.canvas._tkcanvas.create_rectangle(x0, y0, x1, y1)\n\n        #self.canvas.draw()\n\n    def release(self, event):\n        try: self.lastrect\n        except AttributeError: pass\n        else:\n            self.canvas._tkcanvas.delete(self.lastrect)\n            del self.lastrect\n\n    def set_cursor(self, cursor):\n        self.window.configure(cursor=cursord[cursor])\n\n    def _Button(self, text, file, command):\n        file = os.path.join(rcParams['datapath'], 'images', file)\n        im = Tk.PhotoImage(master=self, file=file)\n        b = Tk.Button(\n            master=self, text=text, padx=2, pady=2, image=im, command=command)\n        b._ntimage = im\n        b.pack(side=Tk.LEFT)\n        return b\n\n    def _init_toolbar(self):\n        xmin, xmax = self.canvas.figure.bbox.intervalx\n        height, width = 50, xmax-xmin\n        Tk.Frame.__init__(self, master=self.window,\n                          width=width, height=height,\n                          borderwidth=2)\n\n        self.update()  # Make axes menu\n\n        self.bHome = self._Button( text=\&quot;Home\&quot;, file=\&quot;home.ppm\&quot;,\n                                   command=self.home)\n\n        self.bBack = self._Button( text=\&quot;Back\&quot;, file=\&quot;back.ppm\&quot;,\n                                   command = self.back)\n\n        self.bForward = self._Button(text=\&quot;Forward\&quot;, file=\&quot;forward.ppm\&quot;,\n                                     command = self.forward)\n\n        self.bPan = self._Button( text=\&quot;Pan\&quot;, file=\&quot;move.ppm\&quot;,\n                                  command = self.pan)\n\n        self.bZoom = self._Button( text=\&quot;Zoom\&quot;,\n                                   file=\&quot;zoom_to_rect.ppm\&quot;,\n                                   command = self.zoom)\n\n        self.bsubplot = self._Button( text=\&quot;Configure Subplots\&quot;, file=\&quot;subplots.ppm\&quot;,\n                                   command = self.configure_subplots)\n\n        self.bsave = self._Button( text=\&quot;Save\&quot;, file=\&quot;filesave.ppm\&quot;,\n                                   command = self.save_figure)\n        self.message = Tk.StringVar(master=self)\n        self._message_label = Tk.Label(master=self, textvariable=self.message)\n        self._message_label.pack(side=Tk.RIGHT)\n        self.pack(side=Tk.BOTTOM, fill=Tk.X)\n\n\n    def configure_subplots(self):\n        toolfig = Figure(figsize=(6,3))\n        window = Tk.Tk()\n        canvas = FigureCanvasTkAgg(toolfig, master=window)\n        toolfig.subplots_adjust(top=0.9)\n        tool =  SubplotTool(self.canvas.figure, toolfig)\n        canvas.show()\n        canvas.get_tk_widget().pack(side=Tk.TOP, fill=Tk.BOTH, expand=1)\n\n    def save_figure(self):\n        from tkFileDialog import asksaveasfilename\n        from tkMessageBox import showerror\n        filetypes = self.canvas.get_supported_filetypes().copy()\n        default_filetype = self.canvas.get_default_filetype()\n\n        # Tk doesn't provide a way to choose a default filetype,\n        # so we just have to put it first\n        default_filetype_name = filetypes[default_filetype]\n        del filetypes[default_filetype]\n\n        sorted_filetypes = filetypes.items()\n        sorted_filetypes.sort()\n        sorted_filetypes.insert(0, (default_filetype, default_filetype_name))\n\n        tk_filetypes = [\n            (name, '*.%s' % ext) for (ext, name) in sorted_filetypes]\n\n        fname = asksaveasfilename(\n            master=self.window,\n            title='Save the figure',\n            filetypes = tk_filetypes,\n            defaultextension = self.canvas.get_default_filetype()\n            )\n\n        if fname == \&quot;\&quot; or fname == ():\n            return\n        else:\n            try:\n                # This method will handle the delegation to the correct type\n                self.canvas.print_figure(fname)\n            except Exception, e:\n                showerror(\&quot;Error saving file\&quot;, str(e))\n\n    def set_active(self, ind):\n        self._ind = ind\n        self._active = [ self._axes[i] for i in self._ind ]\n\n    def update(self):\n        _focus = windowing.FocusManager()\n        self._axes = self.canvas.figure.axes\n        naxes = len(self._axes)\n        #if not hasattr(self, \&quot;omenu\&quot;):\n        #    self.set_active(range(naxes))\n        #    self.omenu = AxisMenu(master=self, naxes=naxes)\n        #else:\n        #    self.omenu.adjust(naxes)\n        NavigationToolbar2.update(self)\n\n    def dynamic_update(self):\n        'update drawing area only if idle'\n        # legacy method; new method is canvas.draw_idle\n        self.canvas.draw_idle()\n\n\nFigureManager = FigureManagerTkAgg\n\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;agpl-3.0&quot;}}},{&quot;rowIdx&quot;:15,&quot;cells&quot;:{&quot;repo_name&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;mhoffman/kmos&quot;},&quot;path&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;kmos/cli.py&quot;},&quot;copies&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;1&quot;},&quot;size&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;16514&quot;},&quot;content&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;#!/usr/bin/env python\n\&quot;\&quot;\&quot;Entry point module for the command-line\n   interface. The kmos executable should be\n   on the program path, import this modules\n   main function and run it.\n\n   To call kmos command as you would from the shell,\n   use ::\n\n       kmos.cli.main('...')\n\n   Every command can be shortened as long as it is non-ambiguous, e.g. ::\n\n\n    kmos ex <xml-file>\n\n   instead of ::\n\n    kmos export <xml-file>\n\n\n   etc.\n\n\&quot;\&quot;\&quot;\n\n#    Copyright 2009-2013 Max J. Hoffmann (mjhoffmann@gmail.com)\n#    This file is part of kmos.\n#\n#    kmos is free software: you can redistribute it and/or modify\n#    it under the terms of the GNU General Public License as published by\n#    the Free Software Foundation, either version 3 of the License, or\n#    (at your option) any later version.\n#\n#    kmos is distributed in the hope that it will be useful,\n#    but WITHOUT ANY WARRANTY; without even the implied warranty of\n#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n#    GNU General Public License for more details.\n#\n#    You should have received a copy of the GNU General Public License\n#    along with kmos.  If not, see <http://www.gnu.org/licenses/>.\n\nfrom __future__ import with_statement\nimport os\nimport shutil\n\nusage = {}\nusage['all'] = \&quot;\&quot;\&quot;kmos help all\n    Display documentation for all commands.\n                \&quot;\&quot;\&quot;\nusage['benchmark'] = \&quot;\&quot;\&quot;kmos benchmark\n    Run 1 mio. kMC steps on model in current directory\n    and report runtime.\n                     \&quot;\&quot;\&quot;\n\nusage['build'] = \&quot;\&quot;\&quot;kmos build\n    Build kmc_model.%s from *f90 files in the\n    current directory.\n\n    Additional Parameters ::\n        -d/--debug\n            Turn on assertion statements in F90 code\n\n        -n/--no-compiler-optimization\n            Do not send optimizing flags to compiler.\n                 \&quot;\&quot;\&quot; % ('pyd' if os.name == 'nt' else 'so')\n\nusage['help'] = \&quot;\&quot;\&quot;kmos help <command>\n    Print usage information for the given command.\n                \&quot;\&quot;\&quot;\n\nusage['export'] = \&quot;\&quot;\&quot;kmos export <xml-file> [<export-path>]\n    Take a kmos xml-file and export all generated\n    source code to the export-path. There try to\n    build the kmc_model.%s.\n\n    Additional Parameters ::\n\n        -s/--source-only\n            Export source only and don't build binary\n\n        -b/--backend (local_smart|lat_int)\n            Choose backend. Default is \&quot;local_smart\&quot;.\n            lat_int is EXPERIMENTAL and not made\n            for production, yet.\n\n        -d/--debug\n            Turn on assertion statements in F90 code.\n            (Only active in compile step)\n\n           --acf\n            Build the modules base_acf.f90 and proclist_acf.f90. Default is false.\n            This both modules contain functions to calculate ACF (autocorrelation function) and MSD (mean squared displacement). \n            \n        -n/--no-compiler-optimization\n            Do not send optimizing flags to compiler.\n                    \&quot;\&quot;\&quot; % ('pyd' if os.name == 'nt' else 'so')\n          \nusage['settings-export'] = \&quot;\&quot;\&quot;kmos settings-export <xml-file> [<export-path>]\n    Take a kmos xml-file and export kmc_settings.py\n    to the export-path.\n                    \&quot;\&quot;\&quot;\n\nusage['edit'] = \&quot;\&quot;\&quot;kmos edit <xml-file>\n    Open the kmos xml-file in a GUI to edit\n    the model.\n                \&quot;\&quot;\&quot;\n\nusage['import'] = \&quot;\&quot;\&quot;kmos import <xml-file>\n    Take a kmos xml-file and open an ipython shell\n    with the project_tree imported as pt.\n                  \&quot;\&quot;\&quot;\nusage['rebuild'] = \&quot;\&quot;\&quot;kmos rebuild\n    Export code and rebuild binary module from XML\n    information included in kmc_settings.py in\n    current directory.\n\n    Additional Parameters ::\n        -d/--debug\n            Turn on assertion statements in F90 code\n                    \&quot;\&quot;\&quot;\n\nusage['shell'] = \&quot;\&quot;\&quot;kmos shell\n    Open an interactive shell and create a KMC_Model in it\n               run == shell\n               \&quot;\&quot;\&quot;\nusage['run'] = \&quot;\&quot;\&quot;kmos run\n    Open an interactive shell and create a KMC_Model in it\n               run == shell\n               \&quot;\&quot;\&quot;\n\nusage['version'] = \&quot;\&quot;\&quot;kmos version\n    Print version number and exit.\n                   \&quot;\&quot;\&quot;\n\nusage['view'] = \&quot;\&quot;\&quot;kmos view\n    Take a kmc_model.%s and kmc_settings.py in the\n    same directory and start to simulate the\n    model visually.\n\n    Additional Parameters ::\n        -v/--steps-per-frame <number>\n            Number of steps per frame\n\n                 \&quot;\&quot;\&quot; % ('pyd' if os.name == 'nt' else 'so')\n\nusage['xml'] = \&quot;\&quot;\&quot;kmos xml\n    Print xml representation of model to stdout\n               \&quot;\&quot;\&quot;\n\n\ndef get_options(args=None, get_parser=False):\n    import optparse\n    import os\n    from glob import glob\n    import kmos\n\n    parser = optparse.OptionParser(\n        'Usage: %prog [help] ('\n        + '|'.join(sorted(usage.keys()))\n        + ') [options]',\n        version=kmos.__version__)\n\n    parser.add_option('-s', '--source-only',\n                      dest='source_only',\n                      action='store_true',\n                      default=False)\n\n    parser.add_option('-p', '--path-to-f2py',\n                      dest='path_to_f2py',\n                      default='f2py')\n\n    parser.add_option('-b', '--backend',\n                      dest='backend',\n                      default='local_smart')\n    parser.add_option('-a', '--avoid-default-state',\n                      dest='avoid_default_state',\n                      action='store_true',\n                      default=False,\n                      )\n\n    parser.add_option('-v', '--steps-per-frame',\n                      dest='steps_per_frame',\n                      type='int',\n                      default='50000')\n\n    parser.add_option('-d', '--debug',\n                      default=False,\n                      dest='debug',\n                      action='store_true')\n\n    parser.add_option('-n', '--no-compiler-optimization',\n                      default=False,\n                      dest='no_optimize',\n                      action='store_true')\n\n    parser.add_option('-o', '--overwrite',\n                      default=False,\n                      action='store_true')\n\n    parser.add_option('-l', '--variable-length',\n                      dest='variable_length',\n                      default=95,\n                      type='int')\n\n    parser.add_option('-c', '--catmap',\n                      default=False,\n                      action='store_true')\n    \n    parser.add_option('--acf',\n                      dest='acf',\n                      action='store_true',\n                      default=False,\n                      )\n   \n    try:\n        from numpy.distutils.fcompiler import get_default_fcompiler\n        from numpy.distutils import log\n        log.set_verbosity(-1, True)\n        fcompiler = get_default_fcompiler()\n    except:\n        fcompiler = 'gfortran'\n\n    parser.add_option('-f', '--fcompiler',\n                      dest='fcompiler',\n                      default=os.environ.get('F2PY_FCOMPILER', fcompiler))\n\n    if args is not None:\n        options, args = parser.parse_args(args.split())\n    else:\n        options, args = parser.parse_args()\n    if len(args) < 1:\n        parser.error('Command expected')\n    if get_parser:\n        return options, args, parser\n    else:\n        return options, args\n\n\ndef match_keys(arg, usage, parser):\n    \&quot;\&quot;\&quot;Try to match part of a command against\n       the set of commands from usage. Throws\n       an error if not successful.\n\n    \&quot;\&quot;\&quot;\n    possible_args = [key for key in usage if key.startswith(arg)]\n    if len(possible_args) == 0:\n        parser.error('Command \&quot;%s\&quot; not understood.' % arg)\n    elif len(possible_args) > 1:\n        parser.error(('Command \&quot;%s\&quot; ambiguous.\\n'\n                      'Could be one of %s\\n\\n') % (arg, possible_args))\n    else:\n        return possible_args[0]\n\n\ndef main(args=None):\n    \&quot;\&quot;\&quot;The CLI main entry point function.\n\n    The optional argument args, can be used to\n    directly supply command line argument like\n\n    $ kmos <args>\n\n    otherwise args will be taken from STDIN.\n\n    \&quot;\&quot;\&quot;\n\n    from glob import glob\n\n    options, args, parser = get_options(args, get_parser=True)\n\n    global model, pt, np, cm_model\n\n    if not args[0] in usage.keys():\n        args[0] = match_keys(args[0], usage, parser)\n\n    if args[0] == 'benchmark':\n        from sys import path\n        path.append(os.path.abspath(os.curdir))\n        nsteps = 1000000\n        from time import time\n        from kmos.run import KMC_Model\n        model = KMC_Model(print_rates=False, banner=False)\n        time0 = time()\n        try:\n            model.proclist.do_kmc_steps(nsteps)\n        except:  # kmos < 0.3 had no model.proclist.do_kmc_steps\n            model.do_steps(nsteps)\n\n        needed_time = time() - time0\n        print('Using the [%s] backend.' % model.get_backend())\n        print('%s steps took %.2f seconds' % (nsteps, needed_time))\n        print('Or %.2e steps/s' % (1e6 / needed_time))\n        model.deallocate()\n    elif args[0] == 'build':\n        from kmos.utils import build\n        build(options)\n    elif args[0] == 'edit':\n        from kmos import gui\n        gui.main()\n    elif args[0] == 'settings-export':\n        import kmos.types\n        import kmos.io\n        from kmos.io import ProcListWriter\n\n        if len(args) < 2:\n            parser.error('XML file and export path expected.')\n        if len(args) < 3:\n            out_dir = '%s_%s' % (os.path.splitext(args[1])[0], options.backend)\n            print('No export path provided. Exporting to %s' % out_dir)\n            args.append(out_dir)\n\n        xml_file = args[1]\n        export_dir = args[2]\n        project = kmos.types.Project()\n        project.import_file(xml_file)\n\n        writer = ProcListWriter(project, export_dir)\n        writer.write_settings()\n\n    elif args[0] == 'export':\n        import kmos.types\n        import kmos.io\n        from kmos.utils import build\n        if len(args) < 2:\n            parser.error('XML file and export path expected.')\n        if len(args) < 3:\n            out_dir = '%s_%s' % (os.path.splitext(args[1])[0], options.backend)\n\n            print('No export path provided. Exporting to %s' % out_dir)\n            args.append(out_dir)\n\n        xml_file = args[1]\n        export_dir = os.path.join(args[2], 'src')\n\n        project = kmos.types.Project()\n        project.import_file(xml_file)\n\n        project.shorten_names(max_length=options.variable_length)\n\n        kmos.io.export_source(project,\n                              export_dir,\n                              options=options)\n\n        if ((os.name == 'posix'\n           and os.uname()[0] in ['Linux', 'Darwin'])\n           or os.name == 'nt') \\\n           and not options.source_only:\n            os.chdir(export_dir)\n            build(options)\n            for out in glob('kmc_*'):\n                if os.path.exists('../%s' % out) :\n                    if options.overwrite :\n                        overwrite = 'y'\n                    else:\n                        overwrite = raw_input(('Should I overwrite existing %s ?'\n                                               '[y/N]  ') % out).lower()\n                    if overwrite.startswith('y') :\n                        print('Overwriting {out}'.format(**locals()))\n                        os.remove('../%s' % out)\n                        shutil.move(out, '..')\n                    else :\n                        print('Skipping {out}'.format(**locals()))\n                else:\n                    shutil.move(out, '..')\n\n    elif args[0] == 'settings-export':\n        import kmos.io\n        pt = kmos.io.import_file(args[1])\n        if len(args) < 3:\n            out_dir = os.path.splitext(args[1])[0]\n            print('No export path provided. Exporting kmc_settings.py to %s'\n                  % out_dir)\n            args.append(out_dir)\n\n        if not os.path.exists(args[2]):\n            os.mkdir(args[2])\n        elif not os.path.isdir(args[2]):\n            raise UserWarning(\&quot;Cannot overwrite %s; Exiting;\&quot; % args[2])\n        writer = kmos.io.ProcListWriter(pt, args[2])\n        writer.write_settings()\n\n    elif args[0] == 'help':\n        if len(args) < 2:\n            parser.error('Which help do you  want?')\n        if args[1] == 'all':\n            for command in sorted(usage):\n                print(usage[command])\n        elif args[1] in usage:\n            print('Usage: %s\\n' % usage[args[1]])\n        else:\n            arg = match_keys(args[1], usage, parser)\n            print('Usage: %s\\n' % usage[arg])\n\n    elif args[0] == 'import':\n        import kmos.io\n        if not len(args) >= 2:\n            raise UserWarning('XML file name expected.')\n        pt = kmos.io.import_xml_file(args[1])\n        if len(args) == 2:\n            sh(banner='Note: pt = kmos.io.import_xml(\\'%s\\')' % args[1])\n        elif len(args) == 3: # if optional 3rd argument is given, store model there and exit\n            pt.save(args[2])\n\n    elif args[0] == 'rebuild':\n        from time import sleep\n        print('Will rebuild model from kmc_settings.py in current directory')\n        print('Please do not interrupt,'\n              ' build process, as you will most likely')\n        print('loose the current model files.')\n        sleep(2.)\n        from sys import path\n        path.append(os.path.abspath(os.curdir))\n        from tempfile import mktemp\n        if not os.path.exists('kmc_model.so') \\\n           and not os.path.exists('kmc_model.pyd'):\n            raise Exception('No kmc_model.so found.')\n        if not os.path.exists('kmc_settings.py'):\n            raise Exception('No kmc_settings.py found.')\n\n        from kmos.run import KMC_Model\n\n        model = KMC_Model(print_rates=False, banner=False)\n        tempfile = mktemp()\n        f = file(tempfile, 'w')\n        f.write(model.xml())\n        f.close()\n\n        for kmc_model in glob('kmc_model.*'):\n            os.remove(kmc_model)\n        os.remove('kmc_settings.py')\n        main('export %s -b %s .' % (tempfile, options.backend))\n        os.remove(tempfile)\n        model.deallocate()\n\n    elif args[0] in ['run', 'shell']:\n        from sys import path\n        path.append(os.path.abspath(os.curdir))\n        from kmos.run import KMC_Model\n\n        # useful to have in interactive mode\n        import numpy as np\n        try:\n            from matplotlib import pyplot as plt\n        except:\n            plt = None\n\n        if options.catmap:\n            import catmap\n            import catmap.cli.kmc_runner\n            seed = catmap.cli.kmc_runner.get_seed_from_path('.')\n            cm_model = catmap.ReactionModel(setup_file='{seed}.mkm'.format(**locals()))\n            catmap_message = '\\nSide-loaded catmap_model {seed}.mkm into cm_model = ReactionModel(setup_file=\&quot;{seed}.mkm\&quot;)'.format(**locals())\n        else:\n            catmap_message = ''\n\n        try:\n            model = KMC_Model(print_rates=False)\n        except:\n            print(\&quot;Warning: could not import kmc_model!\&quot;\n                  \&quot; Please make sure you are in the right directory\&quot;)\n        sh(banner='Note: model = KMC_Model(print_rates=False){catmap_message}'.format(**locals()))\n        try:\n            model.deallocate()\n        except:\n            print(\&quot;Warning: could not deallocate model. Was is allocated?\&quot;)\n\n    elif args[0] == 'version':\n        from kmos import VERSION\n        print(VERSION)\n\n    elif args[0] == 'view':\n        from sys import path\n        path.append(os.path.abspath(os.curdir))\n        from kmos import view\n        view.main(steps_per_frame=options.steps_per_frame)\n\n    elif args[0] == 'xml':\n        from sys import path\n        path.append(os.path.abspath(os.curdir))\n        from kmos.run import KMC_Model\n        model = KMC_Model(banner=False, print_rates=False)\n        print(model.xml())\n\n    else:\n        parser.error('Command \&quot;%s\&quot; not understood.' % args[0])\n\n\ndef sh(banner):\n    \&quot;\&quot;\&quot;Wrapper around interactive ipython shell\n    that factors out ipython version depencies.\n\n    \&quot;\&quot;\&quot;\n\n    from distutils.version import LooseVersion\n    import IPython\n    if hasattr(IPython, 'release'):\n        try:\n            from IPython.terminal.embed import InteractiveShellEmbed\n            InteractiveShellEmbed(banner1=banner)()\n\n        except ImportError:\n            try:\n                from IPython.frontend.terminal.embed \\\n                    import InteractiveShellEmbed\n                InteractiveShellEmbed(banner1=banner)()\n\n            except ImportError:\n                from IPython.Shell import IPShellEmbed\n                IPShellEmbed(banner=banner)()\n    else:\n        from IPython.Shell import IPShellEmbed\n        IPShellEmbed(banner=banner)()\n&quot;},&quot;license&quot;:{&quot;kind&quot;:&quot;string&quot;,&quot;value&quot;:&quot;gpl-3.0&quot;}}}],&quot;truncated&quot;:true},&quot;paginationData&quot;:{&quot;pageIndex&quot;:0,&quot;numItemsPerPage&quot;:100,&quot;numTotalItems&quot;:3322,&quot;offset&quot;:0,&quot;length&quot;:100}},&quot;jwt&quot;:&quot;eyJhbGciOiJFZERTQSJ9.eyJyZWFkIjp0cnVlLCJwZXJtaXNzaW9ucyI6eyJyZXBvLmNvbnRlbnQucmVhZCI6dHJ1ZX0sImlhdCI6MTc0MjkyMzAxMSwic3ViIjoiL2RhdGFzZXRzL2h1Z2dpbmdmYWNlLWNvdXJzZS9jb2RlcGFycm90LWRzLXZhbGlkIiwiZXhwIjoxNzQyOTI2NjExLCJpc3MiOiJodHRwczovL2h1Z2dpbmdmYWNlLmNvIn0.wpx6I0IIcu88hIrv5BdxCVHUrcNnPW-LPTUkTe2I0HPhQ045OM8Q9sUZ2240n1YSVTf_9etwx5caP7rTwZCaCA&quot;,&quot;displayUrls&quot;:true},&quot;dataset&quot;:&quot;huggingface-course/codeparrot-ds-valid&quot;,&quot;isGated&quot;:false,&quot;isPrivate&quot;:false,&quot;hasParquetFormat&quot;:false,&quot;author&quot;:{&quot;avatarUrl&quot;:&quot;https://cdn-avatars.huggingface.co/v1/production/uploads/1631524479623-5e48005437cb5b49818287a5.png&quot;,&quot;fullname&quot;:&quot;Hugging Face Course&quot;,&quot;name&quot;:&quot;huggingface-course&quot;,&quot;type&quot;:&quot;org&quot;,&quot;isHf&quot;:false,&quot;isHfAdmin&quot;:false,&quot;isMod&quot;:false,&quot;isEnterprise&quot;:false,&quot;followerCount&quot;:95},&quot;compact&quot;:true}"><div class="flex flex-col overflow-hidden shadow-xs mx-auto mb-10 rounded-lg border pt-2  px-2.5"><div class="mb-2 flex flex-wrap items-center gap-2"><div class="mr-auto flex items-center"><svg class="mr-1 flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill="currentColor" d="M2.5 2h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Zm0 2v2h3V4h-3Zm4 0v2h3V4h-3Zm-4 3v2h3V7h-3Zm4 0v2h3V7h-3Z"></path></svg>
	<div class="whitespace-nowrap font-semibold">Dataset Viewer</div>
	</div>
				<a href="/datasets/huggingface-course/codeparrot-ds-valid/tree/refs%2Fconvert%2Fparquet/default" class="group mr-1 text-xs text-gray-400 max-sm:hidden"><svg class="text-[.6rem] mr-1 inline -translate-y-px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path fill="currentColor" d="M12 10H6.78A11 11 0 0 1 27 16h2A13 13 0 0 0 6 7.68V4H4v8h8zm8 12h5.22A11 11 0 0 1 5 16H3a13 13 0 0 0 23 8.32V28h2v-8h-8z"></path></svg>
						<span class="underline decoration-gray-300 group-hover:decoration-gray-400 dark:decoration-gray-500 dark:group-hover:decoration-gray-300">Auto-converted</span> to Parquet
					</a>
				<button class="btn shadow-xs flex cursor-pointer items-center rounded-sm border px-1 py-0.5 text-xs font-normal text-gray-700 hover:text-gray-800 hover:shadow-inner dark:hover:text-gray-200"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="transform: rotate(360deg);"><path d="M31 16l-7 7l-1.41-1.41L28.17 16l-5.58-5.59L24 9l7 7z" fill="currentColor"></path><path d="M1 16l7-7l1.41 1.41L3.83 16l5.58 5.59L8 23l-7-7z" fill="currentColor"></path><path d="M12.419 25.484L17.639 6l1.932.518L14.35 26z" fill="currentColor"></path></svg>API</button>
					<button class="btn shadow-xs flex cursor-pointer items-center rounded-sm border px-1 py-0.5 text-xs font-normal text-gray-700 hover:text-gray-800 hover:shadow-inner dark:hover:text-gray-200"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path d="M9.80603 2.86737H3.56107C3.37704 2.86737 3.20055 2.94048 3.07042 3.0706C2.94029 3.20073 2.86719 3.37723 2.86719 3.56126V9.80622C2.86719 9.99025 2.94029 10.1667 3.07042 10.2969C3.20055 10.427 3.37704 10.5001 3.56107 10.5001H9.80603C9.99006 10.5001 10.1666 10.427 10.2967 10.2969C10.4268 10.1667 10.4999 9.99025 10.4999 9.80622V3.56126C10.4999 3.37723 10.4268 3.20073 10.2967 3.0706C10.1666 2.94048 9.99006 2.86737 9.80603 2.86737Z" fill="currentColor" fill-opacity="0.3"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M2.40942 1.66191C2.05175 1.66191 1.7618 1.95186 1.7618 2.30953V6.76191H1.43799V2.30953C1.43799 1.77303 1.87291 1.3381 2.40942 1.3381H6.45704V1.66191H2.40942Z" fill="currentColor"></path></svg>Embed</button>

					<button class="bg-linear-to-b shadow-xs flex items-center gap-1.5 rounded-full border from-white to-red-100/90 px-2 py-0.5 text-xs font-medium text-[#2D3648] transition-shadow hover:shadow-inner dark:from-gray-900 dark:to-red-800/30 dark:text-gray-100 dark:hover:shadow-inner dark:hover:shadow-red-800/30" ><svg class="h-3.5 w-3.5 text-red-500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill="currentColor" d="M2.5 2h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Zm0 2v2h3V4h-3Zm4 0v2h3V4h-3Zm-4 3v2h3V7h-3Zm4 0v2h3V7h-3Z"></path></svg>
						<span>Data Studio</span></button></div>
		<div class="flex flex-1 flex-col overflow-hidden -mx-2.5"><div class="flex flex-1 flex-col overflow-hidden"><div class="flex min-h-0 flex-1"><div class="flex flex-1 flex-col overflow-hidden"><div class="md:-mx-2.5 flex min-w-0 flex-wrap border-t"><div class="flex min-w-0 flex-1 flex-wrap"><div class="grid flex-1 grid-cols-1 overflow-hidden text-sm md:grid-cols-2 md:place-content-center sm:mx-2.5"><label class="relative block flex-1 px-3 py-2 hover:bg-gray-50 dark:border-gray-850 dark:hover:bg-gray-950 md:border-r md:border-r-0 hidden" title="default"><span class="text-gray-500">Subset (1)</span>
			<div class="flex items-center whitespace-nowrap"><span class="truncate">default</span>
				<span class="mx-2 text-gray-500">Â·</span>
					<span class="text-gray-500">3.32k rows</span>
				<svg class="ml-auto min-w-6 pl-2" width="1em" height="1em" viewBox="0 0 12 7" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L6 6L11 1" stroke="currentColor"></path></svg></div>
			<select class="absolute inset-0 z-10 w-full cursor-pointer border-0 bg-white text-base opacity-0"><optgroup label="Subset (1)"><option value="default" selected>default (3.32k rows)</option></optgroup></select></label>
		<label class="relative block flex-1 px-3 py-2 hover:bg-gray-50 dark:border-gray-850 dark:hover:bg-gray-900 md:border-r md:border-r" title="validation"><div class="text-gray-500">Split (1)</div>
				<div class="flex items-center overflow-hidden whitespace-nowrap"><span class="truncate">validation</span>
					<span class="mx-2 text-gray-500">Â·</span>
						<span class="text-gray-500">3.32k rows</span>
					<svg class="ml-auto min-w-6 pl-2" width="1em" height="1em" viewBox="0 0 12 7" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L6 6L11 1" stroke="currentColor"></path></svg></div>
				<select class="absolute inset-0 z-10 w-full cursor-pointer border-0 bg-white text-base opacity-0"><optgroup label="Split (1)"><option value="validation" selected>validation (3.32k rows)</option></optgroup></select></label></div></div>
								</div>

							<div class="flex min-h-0 flex-1 flex-col ">
	<div class="bg-linear-to-r text-smd relative flex items-center dark:border-gray-900 dark:bg-gray-950 false border-t [&amp;:has(:focus)]:from-gray-50 [&amp;:has(:focus)]:to-transparent [&amp;:has(:focus)]:to-20% dark:[&amp;:has(:focus)]:from-gray-900"><form class="flex-1"><svg class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M30 28.59L22.45 21A11 11 0 1 0 21 22.45L28.59 30zM5 14a9 9 0 1 1 9 9a9 9 0 0 1-9-9z" fill="currentColor"></path></svg>
				<input disabled class="outline-hidden h-9 w-full border-none bg-transparent px-1 pl-9 pr-3 placeholder:text-gray-400 " placeholder="Search this dataset" dir="auto"></form>
			<div class="flex items-center gap-2 px-2 py-1"><button type="button" class="hover:bg-yellow-200/70 flex items-center gap-1 rounded-md border border-yellow-200 bg-yellow-100 pl-0.5 pr-1 text-[.8rem] leading-normal text-gray-700 dark:border-orange-500/25 dark:bg-orange-500/20 dark:text-gray-300 dark:hover:brightness-110 hidden"><div class="rounded-sm bg-yellow-300 px-1 font-mono text-[.7rem] font-bold text-black dark:bg-yellow-700 dark:text-gray-200">SQL
	</div>
	Console
</button></div></div>


<div class="flex flex-1 flex-col overflow-hidden min-h-64 border-t">
		

<div class="max-h-96 relative overflow-auto"><table class="w-full table-auto rounded-lg font-mono text-xs text-gray-900"><thead class="shadow-xs sticky left-0 right-0 top-0 z-1 bg-white align-top"><tr class="space-y-54 h-full min-w-fit divide-x border-b text-left"><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">repo_name
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">lengths</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><g><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="0" y="18.24245423057892" width="11.2" height="11.757545769421078" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="13.2" y="0" width="11.2" height="30" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="26.4" y="18.757050964868878" width="11.2" height="11.242949035131122" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="39.599999999999994" y="24.803562592775855" width="11.2" height="5.196437407224146" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="52.8" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="66" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="79.19999999999999" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="92.39999999999999" y="26" width="11.2" height="4" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="105.6" y="26" width="11.2" height="4" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="118.8" y="25" width="11.2" height="5" fill-opacity="1"></rect></g><rect class="fill-white dark:fill-gray-900" x="0" y="26" width="130" height="2" stroke-opacity="1"></rect><line class="stroke-gray-100 dark:stroke-gray-500/20" x1="0" y1="27.5" x2="130" y2="27.5" stroke-opacity="1"></line><g><rect class="fill-indigo-500 cursor-pointer" x="-1" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="12.2" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="25.4" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="38.599999999999994" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="51.8" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="65" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="78.19999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="91.39999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="104.6" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="117.8" y="0" width="13.2" height="30" fill-opacity="0"></rect></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 overflow-hidden text-ellipsis whitespace-nowrap" style="max-width: 60px">7</div>
			<div class="absolute overflow-hidden text-ellipsis whitespace-nowrap" style="right: 0px; max-width: 60px">92</div>
			</div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">path
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">lengths</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><g><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="0" y="16.227430555555557" width="11.2" height="13.772569444444445" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="13.2" y="0" width="11.2" height="30" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="26.4" y="1.4895833333333321" width="11.2" height="28.510416666666668" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="39.599999999999994" y="17.333333333333336" width="11.2" height="12.666666666666666" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="52.8" y="21.960069444444443" width="11.2" height="8.039930555555555" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="66" y="24.645833333333332" width="11.2" height="5.354166666666667" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="79.19999999999999" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="92.39999999999999" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="105.6" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="118.8" y="25" width="11.2" height="5" fill-opacity="1"></rect></g><rect class="fill-white dark:fill-gray-900" x="0" y="26" width="130" height="2" stroke-opacity="1"></rect><line class="stroke-gray-100 dark:stroke-gray-500/20" x1="0" y1="27.5" x2="130" y2="27.5" stroke-opacity="1"></line><g><rect class="fill-indigo-500 cursor-pointer" x="-1" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="12.2" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="25.4" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="38.599999999999994" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="51.8" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="65" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="78.19999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="91.39999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="104.6" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="117.8" y="0" width="13.2" height="30" fill-opacity="0"></rect></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 overflow-hidden text-ellipsis whitespace-nowrap" style="max-width: 60px">5</div>
			<div class="absolute overflow-hidden text-ellipsis whitespace-nowrap" style="right: 0px; max-width: 60px">149</div>
			</div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">copies
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">lengths</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><g><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="0" y="0" width="42" height="30" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="44" y="15.747967479674797" width="42" height="14.252032520325203" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="88" y="18.36382113821138" width="42" height="11.636178861788618" fill-opacity="1"></rect></g><rect class="fill-white dark:fill-gray-900" x="0" y="26" width="130" height="2" stroke-opacity="1"></rect><line class="stroke-gray-100 dark:stroke-gray-500/20" x1="0" y1="27.5" x2="130" y2="27.5" stroke-opacity="1"></line><g><rect class="fill-indigo-500 cursor-pointer" x="-1" y="0" width="44" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="43" y="0" width="44" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="87" y="0" width="44" height="30" fill-opacity="0"></rect></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 overflow-hidden text-ellipsis whitespace-nowrap" style="max-width: 60px">1</div>
			<div class="absolute overflow-hidden text-ellipsis whitespace-nowrap" style="right: 0px; max-width: 60px">3</div>
			</div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">size
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">lengths</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><g><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="0" y="0" width="42" height="30" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="44" y="14.644201312910285" width="42" height="15.355798687089715" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="88" y="25" width="42" height="5" fill-opacity="1"></rect></g><rect class="fill-white dark:fill-gray-900" x="0" y="26" width="130" height="2" stroke-opacity="1"></rect><line class="stroke-gray-100 dark:stroke-gray-500/20" x1="0" y1="27.5" x2="130" y2="27.5" stroke-opacity="1"></line><g><rect class="fill-indigo-500 cursor-pointer" x="-1" y="0" width="44" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="43" y="0" width="44" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="87" y="0" width="44" height="30" fill-opacity="0"></rect></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 overflow-hidden text-ellipsis whitespace-nowrap" style="max-width: 60px">4</div>
			<div class="absolute overflow-hidden text-ellipsis whitespace-nowrap" style="right: 0px; max-width: 60px">6</div>
			</div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">content
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">lengths</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><g><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="0" y="0" width="11.2" height="30" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="13.2" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="26.4" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="39.599999999999994" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="52.8" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="66" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="79.19999999999999" y="26" width="11.2" height="4" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="92.39999999999999" y="25" width="11.2" height="5" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="105.6" y="26" width="11.2" height="4" fill-opacity="1"></rect><rect class="fill-gray-400 dark:fill-gray-500/80" rx="2" x="118.8" y="25" width="11.2" height="5" fill-opacity="1"></rect></g><rect class="fill-white dark:fill-gray-900" x="0" y="26" width="130" height="2" stroke-opacity="1"></rect><line class="stroke-gray-100 dark:stroke-gray-500/20" x1="0" y1="27.5" x2="130" y2="27.5" stroke-opacity="1"></line><g><rect class="fill-indigo-500 cursor-pointer" x="-1" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="12.2" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="25.4" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="38.599999999999994" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="51.8" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="65" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="78.19999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="91.39999999999999" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="104.6" y="0" width="13.2" height="30" fill-opacity="0"></rect><rect class="fill-indigo-500 cursor-pointer" x="117.8" y="0" width="13.2" height="30" fill-opacity="0"></rect></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 overflow-hidden text-ellipsis whitespace-nowrap" style="max-width: 60px">911</div>
			<div class="absolute overflow-hidden text-ellipsis whitespace-nowrap" style="right: 0px; max-width: 60px">693k</div>
			</div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th><th class="h-full max-w-sm p-2 text-left  relative w-auto"><div class="flex h-full flex-col flex-nowrap justify-between"><div><div class="flex items-center justify-between">license
				<form class="flex flex-col"><button id="asc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="-rotate-180 transform text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button>
						<button id="desc" class="-mr-1 ml-2 h-[0.4rem] w-[0.8rem] transition ease-in-out"><svg class="text-gray-300 hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 64 256 128" fill="currentColor" aria-hidden="true"><path d="M213.65674,101.657l-80,79.99976a7.99945,7.99945,0,0,1-11.31348,0l-80-79.99976A8,8,0,0,1,48,88H208a8,8,0,0,1,5.65674,13.657Z"></path></svg></button></form></div>

			<div class="mb-2 whitespace-nowrap text-xs font-normal text-gray-500"><span>string</span><span class="italic text-gray-400 before:mx-1 before:content-['Â·']">classes</span></div></div>

		<div><div class="" style="height: 40px; padding-top: 2px"><svg width="130" height="28"><defs><clipPath id="rounded-bar"><rect x="0" y="0" width="130" height="8" rx="4"></rect></clipPath><pattern id="hatching" patternUnits="userSpaceOnUse" patternTransform="rotate(-45)" height="1" width="5"><line y1="0" class="stroke-gray-400 dark:stroke-gray-500/80" stroke-width="3" y2="1" x1="2" x2="2"></line></pattern><pattern id="hatching-faded" patternUnits="userSpaceOnUse" patternTransform="rotate(-45)" height="1" width="5"><line y1="0" class="stroke-gray-100 dark:stroke-gray-500/20" stroke-width="3" y2="1" x1="2" x2="2"></line></pattern></defs><g height="8" style="transform: translateY(20px)" clip-path="url(#rounded-bar)"><g style="transform: scaleX(1.0153846153846153) translateX(-1px)"><g><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="1" y="0" width="55.25165562913907" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="58.25165562913907" y="0" width="25.275737507525587" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="85.52739313666466" y="0" width="14.044551475015052" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="101.57194461167971" y="0" width="11.970499698976521" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="115.54244431065624" y="0" width="4.222155328115592" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="121.76459963877183" y="0" width="0.7784467188440698" height="8" fill-opacity="1"></rect><rect class="fill-indigo-500 dark:fill-indigo-600/80" x="124.54304635761589" y="0" width="0.1914509331727876" height="8" fill-opacity="1"></rect></g></g></g><g style="transform: scaleX(1.0153846153846153) translateX(-1px)"><g><rect class="fill-white cursor-pointer" x="0" y="0" width="57.25165562913907" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="57.25165562913907" y="0" width="27.275737507525587" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="84.52739313666466" y="0" width="16.04455147501505" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="100.57194461167971" y="0" width="13.970499698976521" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="114.54244431065624" y="0" width="6.222155328115592" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="120.76459963877183" y="0" width="2.77844671884407" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="123.54304635761589" y="0" width="2.1914509331727876" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="125.73449729078868" y="0" width="1.1348585189644793" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="126.86935580975316" y="0" width="1.0174593618302228" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="127.88681517158338" y="0" width="0.7826610475617098" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="128.66947621914508" y="0" width="0.3913305237808549" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="129.06080674292593" y="0" width="0.3521974714027694" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="129.4130042143287" y="0" width="0.3521974714027694" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="129.76520168573148" y="0" width="0.15653220951234195" height="28" fill-opacity="0"></rect><rect class="fill-white cursor-pointer" x="129.92173389524382" y="0" width="0.07826610475617098" height="28" fill-opacity="0"></rect></g></g></svg>
	<div class="relative font-light text-gray-400" style="height: 10px; width: 130px;"><div class="absolute left-0 max-w-full overflow-hidden text-ellipsis whitespace-nowrap">15
				values</div></div></div></div></div>
	<div class="absolute right-0 top-0 z-10 h-full w-1 cursor-col-resize hover:bg-indigo-100 active:bg-indigo-500 dark:hover:bg-indigo-800 dark:active:bg-indigo-600/80"><div class="absolute right-0 top-0 h-full w-1"></div>
								</div>
						</th></tr></thead>
			<tbody class="h-16 overflow-scroll"><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="0"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">ratnania/pigasus</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">doc/manual/include/demo/test_neumann_quartcircle.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">1</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2730</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#! /usr/bin/python

# ...
try:
    from matplotlib import pyplot as plt
    PLOT=True
except ImportError:
    PLOT=False
# ...
import numpy                as np
from pigasus.gallery.poisson import *
import sys
import inspect
filename = inspect.getfile(inspect.currentframe()) # script filename (usually with path)

# ...
sin = np.sin ; cos = np.cos ; pi = np.pi ; exp = np.exp
# ...

#-----------------------------------
try:
    nx = int(sys.argv[1])
except:
    nx = 31

try:
    ny = int(sys.argv[2])
except:
    ny = 31

try:
    px = int(sys.argv[3])
except:
    px = 2

try:
    py = int(sys.argv[4])
except:
    py = 2

from igakit.cad_geometry import quart_circle as domain
geo = domain(n=[nx,ny],p=[px,py])
#-----------------------------------

# ...
# exact solution
# ...
R = 1.
r = 0.5
c = 1. # for neumann
#c = pi / (R**2-r**2) # for all dirichlet bc
u = lambda x,y : [ x * y * sin ( c * (R**2 - x**2 - y**2 )) ]
# ...

# ...
# rhs
# ...
f = lambda x,y : [4*c**2*x**3*y*sin(c*(R**2 - x**2 - y**2)) \
                  + 4*c**2*x*y**3*sin(c*(R**2 - x**2 - y**2)) \
                  + 12*c*x*y*cos(c*(R**2 - x**2 - y**2)) ]
# ...

# ...
# values of gradu.n at the boundary
# ...
gradu   = lambda x,y : [-2*c*x**2*y*cos(c*(R**2 - x**2 - y**2)) + y*sin(c*(R**2
                                                                           -
                                                                           x**2
                                                                           -
                                                                           y**2)) \
                       ,-2*c*x*y**2*cos(c*(R**2 - x**2 - y**2)) + x*sin(c*(R**2 - x**2 - y**2)) ]

def func_g (x,y) :
    du  = gradu (x, y)
    return [ du[0] , du[1] ]
# ...

# ...
# values of u at the boundary
# ...

bc_neumann={}

bc_neumann [0,0] = func_g
Dirichlet = [[1,2,3]]

#AllDirichlet = True
# ...

# ...
try:
    bc_dirichlet
except NameError:
    bc_dirichlet = None
else:
    pass

try:
    bc_neumann
except NameError:
    bc_neumann = None
else:
    pass

try:
    AllDirichlet
except NameError:
    AllDirichlet = None
else:
    pass

try:
    Dirichlet
except NameError:
    Dirichlet = None
else:
    pass

try:
    Metric
except NameError:
    Metric = None
else:
    pass
# ...

# ...
PDE = poisson(geometry=geo, bc_dirichlet=bc_dirichlet, bc_neumann=bc_neumann,
              AllDirichlet=AllDirichlet, Dirichlet=Dirichlet,metric=Metric)
# ...

# ...
PDE.assembly(f=f)
PDE.solve()
# ...

# ...
normU = PDE.norm(exact=u)
print "norm U   = ", normU
# ...

# ...
if PLOT:
    PDE.plot()  ; plt.colorbar(); plt.title('$u_h$')
    plt.savefig(filename.split('.py')[0]+'.png', format='png')
    plt.clf()
# ...

PDE.free()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">mit</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="1"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">devanshdalal/scikit-learn</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">examples/gaussian_process/plot_gpr_noisy_targets.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">64</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">3706</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">"""
=========================================================
Gaussian Processes regression: basic introductory example
=========================================================

A simple one-dimensional regression example computed in two different ways:

1. A noise-free case
2. A noisy case with known noise-level per datapoint

In both cases, the kernel's parameters are estimated using the maximum
likelihood principle.

The figures illustrate the interpolating property of the Gaussian Process
model as well as its probabilistic nature in the form of a pointwise 95%
confidence interval.

Note that the parameter ``alpha`` is applied as a Tikhonov
regularization of the assumed covariance between the training points.
"""
print(__doc__)

# Author: Vincent Dubourg &lt;vincent.dubourg@gmail.com>
#         Jake Vanderplas &lt;vanderplas@astro.washington.edu>
#         Jan Hendrik Metzen &lt;jhm@informatik.uni-bremen.de>s
# License: BSD 3 clause

import numpy as np
from matplotlib import pyplot as plt

from sklearn.gaussian_process import GaussianProcessRegressor
from sklearn.gaussian_process.kernels import RBF, ConstantKernel as C

np.random.seed(1)


def f(x):
    """The function to predict."""
    return x * np.sin(x)

# ----------------------------------------------------------------------
#  First the noiseless case
X = np.atleast_2d([1., 3., 5., 6., 7., 8.]).T

# Observations
y = f(X).ravel()

# Mesh the input space for evaluations of the real function, the prediction and
# its MSE
x = np.atleast_2d(np.linspace(0, 10, 1000)).T

# Instanciate a Gaussian Process model
kernel = C(1.0, (1e-3, 1e3)) * RBF(10, (1e-2, 1e2))
gp = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=9)

# Fit to data using Maximum Likelihood Estimation of the parameters
gp.fit(X, y)

# Make the prediction on the meshed x-axis (ask for MSE as well)
y_pred, sigma = gp.predict(x, return_std=True)

# Plot the function, the prediction and the 95% confidence interval based on
# the MSE
fig = plt.figure()
plt.plot(x, f(x), 'r:', label=u'$f(x) = x\,\sin(x)$')
plt.plot(X, y, 'r.', markersize=10, label=u'Observations')
plt.plot(x, y_pred, 'b-', label=u'Prediction')
plt.fill(np.concatenate([x, x[::-1]]),
         np.concatenate([y_pred - 1.9600 * sigma,
                        (y_pred + 1.9600 * sigma)[::-1]]),
         alpha=.5, fc='b', ec='None', label='95% confidence interval')
plt.xlabel('$x$')
plt.ylabel('$f(x)$')
plt.ylim(-10, 20)
plt.legend(loc='upper left')

# ----------------------------------------------------------------------
# now the noisy case
X = np.linspace(0.1, 9.9, 20)
X = np.atleast_2d(X).T

# Observations and noise
y = f(X).ravel()
dy = 0.5 + 1.0 * np.random.random(y.shape)
noise = np.random.normal(0, dy)
y += noise

# Instanciate a Gaussian Process model
gp = GaussianProcessRegressor(kernel=kernel, alpha=(dy / y) ** 2,
                              n_restarts_optimizer=10)

# Fit to data using Maximum Likelihood Estimation of the parameters
gp.fit(X, y)

# Make the prediction on the meshed x-axis (ask for MSE as well)
y_pred, sigma = gp.predict(x, return_std=True)

# Plot the function, the prediction and the 95% confidence interval based on
# the MSE
fig = plt.figure()
plt.plot(x, f(x), 'r:', label=u'$f(x) = x\,\sin(x)$')
plt.errorbar(X.ravel(), y, dy, fmt='r.', markersize=10, label=u'Observations')
plt.plot(x, y_pred, 'b-', label=u'Prediction')
plt.fill(np.concatenate([x, x[::-1]]),
         np.concatenate([y_pred - 1.9600 * sigma,
                        (y_pred + 1.9600 * sigma)[::-1]]),
         alpha=.5, fc='b', ec='None', label='95% confidence interval')
plt.xlabel('$x$')
plt.ylabel('$f(x)$')
plt.ylim(-10, 20)
plt.legend(loc='upper left')

plt.show()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">bsd-3-clause</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="2"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">lordkman/burnman</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">examples/example_geotherms.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">4</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">4049</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class=""># This file is part of BurnMan - a thermoelastic and thermodynamic toolkit for the Earth and Planetary Sciences
# Copyright (C) 2012 - 2015 by the BurnMan team, released under the GNU
# GPL v2 or later.


"""
example_geotherms
-----------------

This example shows each of the geotherms currently possible with BurnMan.
These are:

1. Brown and Shankland, 1981 :cite:`Brown1981`
2. Anderson, 1982 :cite:`anderson1982earth`
3. Watson and Baxter, 2007 :cite:`Watson2007`
4. linear extrapolation
5. Read in from file from user
6. Adiabatic from potential temperature and choice of mineral

*Uses:*

* :func:`burnman.geotherm.brown_shankland`
* :func:`burnman.geotherm.anderson`
* input geotherm file *input_geotherm/example_geotherm.txt* (optional)
* :class:`burnman.composite.Composite` for adiabat

*Demonstrates:*

* the available geotherms

"""
from __future__ import absolute_import

import os
import sys
import numpy as np
import matplotlib.pyplot as plt
# hack to allow scripts to be placed in subdirectories next to burnman:
if not os.path.exists('burnman') and os.path.exists('../burnman'):
    sys.path.insert(1, os.path.abspath('..'))

import burnman
from burnman import minerals

if __name__ == "__main__":
    # we want to evaluate several geotherms at these values
    pressures = np.arange(9.0e9, 128e9, 3e9)
    seismic_model = burnman.seismic.PREM()
    depths = seismic_model.depth(pressures)
    # load two builtin geotherms and evaluate the temperatures at all pressures
    temperature1 = burnman.geotherm.brown_shankland(depths)
    temperature2 = burnman.geotherm.anderson(depths)

    # a geotherm is actually just a function that returns a list of temperatures given pressures in Pa
    # so we can just write our own function
    my_geotherm_function = lambda p: [1500 + (2500 - 1500) * x / 128e9 for x in p]
    temperature3 = my_geotherm_function(pressures)

    # what about a geotherm defined from datapoints given in a file (our
    # inline)?
    table = [[1e9, 1600], [30e9, 1700], [130e9, 2700]]
    # this could also be loaded from a file, just uncomment this
    # table = burnman.tools.read_table("input_geotherm/example_geotherm.txt")

    table_pressure = np.array(table)[:, 0]
    table_temperature = np.array(table)[:, 1]

    my_geotherm_interpolate = lambda p: [np.interp(x, table_pressure,
                                                    table_temperature) for x in p]

    temperature4 = my_geotherm_interpolate(pressures)

    # finally, we can also calculate a self consistent
    # geotherm for an assemblage of minerals
    # based on self compression of the composite rock.
    # First we need to define an assemblage
    amount_perovskite = 0.8
    fe_pv = 0.05
    fe_pc = 0.2
    pv = minerals.SLB_2011.mg_fe_perovskite()
    pc = minerals.SLB_2011.ferropericlase()
    pv.set_composition([1. - fe_pv, fe_pv, 0.])
    pc.set_composition([1. - fe_pc, fe_pc])
    example_rock = burnman.Composite(
        [pv, pc], [amount_perovskite, 1.0 - amount_perovskite])

    # next, define an anchor temperature at which we are starting.
    # Perhaps 1500 K for the upper mantle
    T0 = 1500.
    # then generate temperature values using the self consistent function.
    # This takes more time than the above methods
    temperature5 = burnman.geotherm.adiabatic(pressures, T0, example_rock)

    # you can also look at burnman/geotherm.py to see how the geotherms are
    # implemented

    plt.plot(pressures / 1e9, temperature1, '-r', label="Brown, Shankland")
    plt.plot(pressures / 1e9, temperature2, '-c', label="Anderson")
    plt.plot(pressures / 1e9, temperature3, '-b', label="handwritten linear")
    plt.plot(pressures / 1e9, temperature4,
             '-k', label="handwritten from table")
    plt.plot(pressures / 1e9, temperature5, '-m',
             label="Adiabat with pv (70%) and fp(30%)")

    plt.legend(loc='lower right')
    plt.xlim([8.5, 130])
    plt.xlabel('Pressure/GPa')
    plt.ylabel('Temperature')
    plt.savefig("output_figures/example_geotherm.png")
    plt.show()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">gpl-2.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="3"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">francesco-mannella/dmp-esn</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">parametric/parametric_dmp/bin/tr_datasets/e_cursive_curves_angles_start_none/results/plot.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">18</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">1043</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#!/usr/bin/env python

import glob 
import numpy as np
import matplotlib.pyplot as plt

import os
import sys


pathname = os.path.dirname(sys.argv[0])
if pathname:
    os.chdir(pathname)

n_dim = None
trains = []
for fname in glob.glob("tl*"):
    t = np.loadtxt(fname)
    trains.append(t)

tests = []
for fname in glob.glob("tt*"):
    t = np.loadtxt(fname)
    tests.append(t)

trial_results= []
for fname in glob.glob("rtl*"):
    t = np.loadtxt(fname)
    trial_results.append(t)

test_results= []
for fname in glob.glob("rtt*"):
    t = np.loadtxt(fname)
    test_results.append(t)

fig = plt.figure()
ax = fig.add_subplot(111, aspect="equal")
for d in trains:
    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color="blue", lw=3, alpha=0.5)
for d in tests: 
    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color="red",  lw=3, alpha=0.5)
for d in trial_results:
    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=[0,0,.5],  lw=2)
for d in test_results:
    ax.plot(d[:,1] +d[:,7]*6, d[:,2] +d[:,8]*6, color=[.5,0,0],  lw=2)
plt.show()

</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">gpl-2.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="4"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">flowersteam/SESM</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">SESM/pykinect.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">3387</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">import zmq
import numpy
import threading

from collections import namedtuple

Point2D = namedtuple('Point2D', ('x', 'y'))
Point3D = namedtuple('Point3D', ('x', 'y', 'z'))
Quaternion = namedtuple('Quaternion', ('x', 'y', 'z', 'w'))

torso_joints = ('hip_center', 'spine', 'shoulder_center', 'head')
left_arm_joints = ('shoulder_left', 'elbow_left', 'wrist_left', 'hand_left')
right_arm_joints = ('shoulder_right', 'elbow_right', 'wrist_right', 'hand_right')
left_leg_joints = ('hip_left', 'knee_left', 'ankle_left', 'foot_left')
right_leg_joints = ('hip_right', 'knee_right', 'ankle_right', 'foot_right')
skeleton_joints = torso_joints + left_arm_joints + right_arm_joints + left_leg_joints + right_leg_joints


class Skeleton(namedtuple('Skeleton', ('timestamp', 'user_id') + skeleton_joints)):
    joints = skeleton_joints

    @property
    def to_np(self):
        l = []
        
        for j in self.joints:
            p = getattr(self, j).position
            l.append((p.x, p.y, p.z))
            
        return numpy.array(l)
            
Joint = namedtuple('Joint', ('position', 'orientation', 'pixel_coordinate'))


class KinectSensor(object):
    def __init__(self, addr, port):
        self._lock = threading.Lock()
        self._skeleton = None

        context = zmq.Context()
        self.socket = context.socket(zmq.REQ)
        self.socket.connect('tcp://{}:{}'.format(addr, port))

        t = threading.Thread(target=self.get_skeleton)
        t.daemon = True
        t.start()

    @property
    def tracked_skeleton(self):
        with self._lock:
            return self._skeleton

    @tracked_skeleton.setter
    def tracked_skeleton(self, skeleton):
        with self._lock:
            self._skeleton = skeleton

    def get_skeleton(self):
        while True:
            self.socket.send('Hello')

            md = self.socket.recv_json()
            msg = self.socket.recv()

            skeleton_array = numpy.frombuffer(buffer(msg), dtype=md['dtype'])
            skeleton_array = skeleton_array.reshape(md['shape'])

            joints = []
            for i in range(len(skeleton_joints)):
                x, y, z, w = skeleton_array[i][0:4]
                position = Point3D(x / w, y / w, z / w)
                pixel_coord = Point2D(*skeleton_array[i][4:6])
                orientation = Quaternion(*skeleton_array[i][6:10])
                joints.append(Joint(position, orientation, pixel_coord))

            self.tracked_skeleton = Skeleton(md['timestamp'], md['user_index'], *joints)


def draw_position(skel, ax):
    xy, zy = [], []

    if not skel:
        return

    for j in skeleton_joints:
        p = getattr(skel, j).position
        xy.append((p.x, p.y))
        zy.append((p.z, p.y))

    ax.set_xlim(-2, 5)
    ax.set_ylim(-1.5, 1.5)
    ax.scatter(zip(*xy)[0], zip(*xy)[1], 30, 'b')
    ax.scatter(zip(*zy)[0], zip(*zy)[1], 30, 'r')


if __name__ == '__main__':
    import time

    import matplotlib.pyplot as plt
    plt.ion()
    fig = plt.figure()
    ax = fig.add_subplot(111)

    kinect_sensor = KinectSensor('193.50.110.210', 9999)

    import skelangle

    kinect_angle = skelangle.AngleFromSkel()

    try:
        while True:
            ax.clear()
            draw_position(kinect_sensor.tracked_skeleton, ax)
            plt.draw()
            time.sleep(0.1)
    except KeyboardInterrupt:
        plt.close('all')
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">gpl-3.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="5"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">gwparikh/cvgui</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">grouping_calibration.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">9402</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#!/usr/bin/env python

import os, sys, subprocess
import argparse
import subprocess
import threading
import timeit
from multiprocessing import Queue, Lock
from configobj import ConfigObj
from numpy import loadtxt
from numpy.linalg import inv
import matplotlib.pyplot as plt
import moving
from cvguipy import trajstorage, cvgenetic, cvconfig

""" 
Grouping Calibration By Genetic Algorithm.
This script uses genetic algorithm to search for the best configuration.

It does not monitor RAM usage, therefore, CPU thrashing might be happened when number of parents (selection size) is too large. 
"""
# class for genetic algorithm
class GeneticCompare(object):
    def __init__(self, motalist, motplist, IDlist, cfg_list, lock):
        self.motalist = motalist
        self.motplist = motplist
        self.IDlist = IDlist
        self.cfg_list = cfg_list
        self.lock = lock
    
    # This is used for calculte fitness of individual in genetic algorithn.
    # It is modified to create sqlite and cfg file before tuning computeClearMOT.
    # NOTE errors show up when loading two same ID
    def computeMOT(self, i):
        
        # create sqlite and cfg file with id i
        cfg_name = config_files +str(i)+'.cfg'
        sql_name = sqlite_files +str(i)+'.sqlite'
        open(cfg_name,'w').close()
        config = ConfigObj(cfg_name)
        cfg_list.write_config(i ,config)
        command = ['cp', 'tracking_only.sqlite', sql_name]
        process = subprocess.Popen(command)
        process.wait()
        command = ['trajextract.py', args.inputVideo, '-o', args.homography, '-t', cfg_name, '-d', sql_name, '--gf']
        # suppress output of grouping extraction
        devnull = open(os.devnull, 'wb')
        process = subprocess.Popen(command, stdout = devnull)
        process.wait()
        
        obj = trajstorage.CVsqlite(sql_name)
        print "loading", i
        obj.loadObjects()
        motp, mota, mt, mme, fpt, gt = moving.computeClearMOT(cdb.annotations, obj.objects, args.matchDistance, firstFrame, lastFrame)
        if motp is None:
            motp = 0
        self.lock.acquire()
        self.IDlist.put(i)
        self.motplist.put(motp)
        self.motalist.put(mota)
        obj.close()
        if args.PrintMOTA:
            print("ID: mota:{} motp:{}".format(mota, motp))
        self.lock.release()
            
        return mota
        
if __name__ == '__main__' :
    parser = argparse.ArgumentParser(description="compare all sqlites that are created by cfg_combination.py to the Annotated version to find the ID of the best configuration")
    parser.add_argument('inputVideo', help= "input video filename")
    parser.add_argument('-r', '--configuration-file', dest='range_cfg', help= "the configuration-file contain the range of configuration")
    parser.add_argument('-t', '--traffintel-config', dest='traffintelConfig', help= "the TrafficIntelligence file to use for running the first extraction.")
    parser.add_argument('-m', '--mask-File', dest='maskFilename', help="Name of the mask-File for trajextract")
    parser.add_argument('-d', '--database-file', dest ='databaseFile', help ="Name of the databaseFile.")
    parser.add_argument('-o', '--homography-file', dest ='homography', help = "Name of the homography file.", required = True)
    parser.add_argument('-md', '--matching-distance', dest='matchDistance', help = "matchDistance", default = 10, type = float)
    parser.add_argument('-a', '--accuracy', dest = 'accuracy', help = "accuracy parameter for genetic algorithm", type = int)
    parser.add_argument('-p', '--population', dest = 'population', help = "population parameter for genetic algorithm", required = True, type = int)
    parser.add_argument('-np', '--num-of-parents', dest = 'num_of_parents', help = "Number of parents that are selected each generation", type = int)
    parser.add_argument('-mota', '--print-MOTA', dest='PrintMOTA', action = 'store_true', help = "Print MOTA for each ID.")
    args = parser.parse_args()
    
    os.mkdir('cfg_files')
    os.mkdir('sql_files')
    sqlite_files = "sql_files/Sqlite_ID_"
    config_files = "cfg_files/Cfg_ID_"
    
    # ------------------initialize annotated version if not existed ---------- #
    # inputVideo check
    if not os.path.exists(args.inputVideo):
        print("Input video {} does not exist! Exiting...".format(args.inputVideo))
        sys.exit(1)

    # configuration file check
    if args.range_cfg is None:
        config = ConfigObj('range.cfg')
    else:
        config = ConfigObj(args.range_cfg)

    # get configuration and put them to a List
    cfg_list = cvconfig.CVConfigList()
    thread_cfgtolist = threading.Thread(target = cvconfig.config_to_list, args = (cfg_list, config))
    thread_cfgtolist.start();
    # check if dbfile name is entered
    if args.databaseFile is None:
        print("Database-file is not entered, running trajextract and cvplayer.")
        if not os.path.exists(args.homography):
            print("Homography file does not exist! Exiting...")
            sys.exit(1)
        else:
            videofile=args.inputVideo
            if 'avi' in videofile:
                if args.maskFilename is not None:
                    command = ['trajextract.py',args.inputVideo,'-m', args.maskFilename,'-o', args.homography]
                else:
                    command = ['trajextract.py',args.inputVideo,'-o', args.homography]
                process = subprocess.Popen(command)
                process.wait()
                databaseFile = videofile.replace('avi','sqlite')
                command = ['cvplayer.py',args.inputVideo,'-d',databaseFile,'-o',args.homography]
                process = subprocess.Popen(command)
                process.wait()
            else:
                print("Input video {} is not 'avi' type. Exiting...".format(args.inputVideo))
                sys.exit(1)
    else:
        databaseFile = args.databaseFile
    thread_cfgtolist.join()
    # ------------------Done initialization for annotation-------------------- #
    
    # create first tracking only database template.
    print("creating the first tracking only database template.")
    if args.maskFilename is not None:
        command = map(str, ['trajextract.py',args.inputVideo, '-d', 'tracking_only.sqlite', '-t', args.traffintelConfig, '-o', args.homography, '-m', args.maskFilename, '--tf'])
    else:
        command = map(str, ['trajextract.py',args.inputVideo, '-d', sql_name, '-t', args.traffintelConfig, '-o', args.homography, '--tf'])
    process = subprocess.Popen(command)
    process.wait()
    # ----start using genetic algorithm to search for best configuration-------#
    start = timeit.default_timer()
    
    dbfile = databaseFile;
    homography = loadtxt(args.homography)
    
    cdb = trajstorage.CVsqlite(dbfile)
    cdb.open()
    cdb.getLatestAnnotation()
    cdb.createBoundingBoxTable(cdb.latestannotations, inv(homography))
    cdb.loadAnnotaion()
    for a in cdb.annotations:
        a.computeCentroidTrajectory(homography)
    print "Latest Annotaions in "+dbfile+": ", cdb.latestannotations
    
    cdb.frameNumbers = cdb.getFrameList()
    firstFrame = cdb.frameNumbers[0]
    lastFrame = cdb.frameNumbers[-1]
    
    foundmota = Queue()
    foundmotp = Queue()
    IDs = Queue()
    lock = Lock()
    
    Comp = GeneticCompare(foundmota, foundmotp, IDs, cfg_list, lock)
    if args.accuracy != None:
        GeneticCal = cvgenetic.CVGenetic(args.population, cfg_list, Comp.computeMOT, args.accuracy)
    else:
        GeneticCal = cvgenetic.CVGenetic(args.population, cfg_list, Comp.computeMOT)
    if args.num_of_parents != None:
        GeneticCal.run_thread(args.num_of_parents)
    else:
        GeneticCal.run_thread()
    
    # tranform queues to lists
    foundmota = cvgenetic.Queue_to_list(foundmota)
    foundmotp = cvgenetic.Queue_to_list(foundmotp)
    IDs = cvgenetic.Queue_to_list(IDs)

    for i in range(len(foundmotp)):
        foundmotp[i] /= args.matchDistance
    Best_mota = max(foundmota)
    Best_ID = IDs[foundmota.index(Best_mota)]
    print "Best multiple object tracking accuracy (MOTA)", Best_mota
    print "ID:", Best_ID
    stop = timeit.default_timer()
    print str(stop-start) + "s"
    
    total = []
    for i in range(len(foundmota)):
        total.append(foundmota[i]- 0.1 * foundmotp[i])
    Best_total = max(total)
    Best_total_ID = IDs[total.index(Best_total)]
    # ------------------------------Done searching----------------------------#
    # use matplot to plot a graph of all calculated IDs along with thier mota
    plt.figure(1)
    plt.plot(foundmota ,IDs ,'bo')
    plt.plot(foundmotp ,IDs ,'yo')
    plt.plot(Best_mota, Best_ID, 'ro')
    plt.axis([-1, 1, -1, cfg_list.get_total_combination()])
    plt.xlabel('mota')
    plt.ylabel('ID')
    plt.title(b'Best MOTA: '+str(Best_mota) +'\nwith ID: '+str(Best_ID))
    plotFile = os.path.splitext(dbfile)[0] + '_CalibrationResult_mota.png'
    plt.savefig(plotFile)
    
    plt.figure(2)
    plt.plot(total, IDs, 'bo')
    plt.plot(Best_total, Best_total_ID, 'ro')
    plt.xlabel('mota + motp')
    plt.ylabel('ID')
    plt.title(b'Best total: '+str(Best_total) +'\nwith ID: '+str(Best_total_ID))
    
    # save the plot
    plotFile = os.path.splitext(dbfile)[0] + '_CalibrationResult_motp.png'
    plt.savefig(plotFile)
    
    plt.show()
    
    cdb.close()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">mit</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="6"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">keflavich/pyspeckit-obsolete</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">pyspeckit/spectrum/models/ammonia.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">1</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">28836</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">"""
========================================
Ammonia inversion transition TKIN fitter
========================================

Ammonia inversion transition TKIN fitter translated from Erik Rosolowsky's
http://svn.ok.ubc.ca/svn/signals/nh3fit/

.. moduleauthor:: Adam Ginsburg &lt;adam.g.ginsburg@gmail.com>

Module API
^^^^^^^^^^

"""
import numpy as np
from pyspeckit.mpfit import mpfit
from pyspeckit.spectrum.parinfo import ParinfoList,Parinfo
import fitter
import matplotlib.cbook as mpcb
import copy
import model


line_names = ['oneone','twotwo','threethree','fourfour']

freq_dict = { 
    'oneone':     23.694506e9,
    'twotwo':     23.722633335e9,
    'threethree': 23.8701296e9,
    'fourfour':   24.1394169e9,
    }
aval_dict = {
    'oneone':     1.712e-7,  #64*!pi**4/(3*h*c**3)*nu11**3*mu0**2*(1/2.)
    'twotwo':     2.291e-7,  #64*!pi**4/(3*h*c**3)*nu22**3*mu0**2*(2/3.)
    'threethree': 2.625e-7,  #64*!pi**4/(3*h*c**3)*nu33**3*mu0**2*(3/4.)
    'fourfour':   3.167e-7,  #64*!pi**4/(3*h*c**3)*nu44**3*mu0**2*(4/5.)
    }
ortho_dict = {
    'oneone':     False,
    'twotwo':     False,
    'threethree': True,
    'fourfour':   False,
    }
n_ortho = np.arange(0,28,3) # 0..3..27
n_para = np.array([x for x in range(28) if x % 3 != 0])

voff_lines_dict = {
    'oneone': [19.8513, 19.3159, 7.88669, 7.46967, 7.35132, 0.460409, 0.322042,
        -0.0751680, -0.213003, 0.311034, 0.192266, -0.132382, -0.250923, -7.23349,
        -7.37280, -7.81526, -19.4117, -19.5500],
    'twotwo':[26.5263, 26.0111, 25.9505, 16.3917, 16.3793, 15.8642, 0.562503,
        0.528408, 0.523745, 0.0132820, -0.00379100, -0.0132820, -0.501831,
        -0.531340, -0.589080, -15.8547, -16.3698, -16.3822, -25.9505, -26.0111,
        -26.5263],
    'threethree':[29.195098, 29.044147, 28.941877, 28.911408, 21.234827,
        21.214619, 21.136387, 21.087456, 1.005122, 0.806082, 0.778062,
        0.628569, 0.016754, -0.005589, -0.013401, -0.639734, -0.744554,
        -1.031924, -21.125222, -21.203441, -21.223649, -21.076291, -28.908067,
        -28.938523, -29.040794, -29.191744],
    'fourfour':[  0.        , -30.49783692,  30.49783692,   0., 24.25907811,
        -24.25907811,   0.        ]
                      }

tau_wts_dict = {
    'oneone': [0.0740740, 0.148148, 0.0925930, 0.166667, 0.0185190, 0.0370370,
        0.0185190, 0.0185190, 0.0925930, 0.0333330, 0.300000, 0.466667,
        0.0333330, 0.0925930, 0.0185190, 0.166667, 0.0740740, 0.148148],
    'twotwo': [0.00418600, 0.0376740, 0.0209300, 0.0372090, 0.0260470,
        0.00186000, 0.0209300, 0.0116280, 0.0106310, 0.267442, 0.499668,
        0.146512, 0.0116280, 0.0106310, 0.0209300, 0.00186000, 0.0260470,
        0.0372090, 0.0209300, 0.0376740, 0.00418600],
    'threethree': [0.012263, 0.008409, 0.003434, 0.005494, 0.006652, 0.008852,
        0.004967, 0.011589, 0.019228, 0.010387, 0.010820, 0.009482, 0.293302,
        0.459109, 0.177372, 0.009482, 0.010820, 0.019228, 0.004967, 0.008852,
        0.006652, 0.011589, 0.005494, 0.003434, 0.008409, 0.012263],
    'fourfour': [0.2431, 0.0162, 0.0162, 0.3008, 0.0163, 0.0163, 0.3911]}

def ammonia(xarr, tkin=20, tex=None, ntot=1e14, width=1,
        xoff_v=0.0, fortho=0.0, tau=None, fillingfraction=None, return_tau=False,
        thin=False, verbose=False, return_components=False, debug=False ):
    """
    Generate a model Ammonia spectrum based on input temperatures, column, and
    gaussian parameters

    ntot can be specified as a column density (e.g., 10^15) or a log-column-density (e.g., 15)

    tex can be specified or can be assumed LTE if unspecified, if tex>tkin, or if "thin"
        is specified

    "thin" uses a different parametetrization and requires only the optical depth, width, offset,
        and tkin to be specified.  In the 'thin' approximation, tex is not used in computation of
        the partition function - LTE is implicitly assumed

    If tau is specified, ntot is NOT fit but is set to a fixed value
    fillingfraction is an arbitrary scaling factor to apply to the model
    fortho is the ortho/(ortho+para) fraction.  The default is to assume all ortho.
    xoff_v is the velocity offset in km/s 

    tau refers to the optical depth of the 1-1 line.  The optical depths of the
    other lines are fixed relative to tau_oneone

    (not implemented) if tau is specified, ntot is ignored
    """

    # Convert X-units to frequency in GHz
    xarr = xarr.as_unit('GHz')

    if tex is not None:
        if tex > tkin: # cannot have Tex > Tkin
            tex = tkin 
        elif thin: # tex is not used in this case
            tex = tkin
    else:
        tex = tkin

    if thin:
        ntot = 1e15
    elif 5 &lt; ntot &lt; 25: 
        # allow ntot to be specified as a logarithm.  This is
        # safe because ntot &lt; 1e10 gives a spectrum of all zeros, and the
        # plausible range of columns is not outside the specified range
        ntot = 10**ntot
    elif (25 &lt; ntot &lt; 1e5) or (ntot &lt; 5):
        # these are totally invalid for log/non-log
        return 0

    # fillingfraction is an arbitrary scaling for the data
    # The model will be (normal model) * fillingfraction
    if fillingfraction is None:
        fillingfraction = 1.0

    ckms = 2.99792458e5
    ccms = ckms*1e5
    g1 = 1                
    g2 = 1                
    h = 6.6260693e-27     
    kb = 1.3806505e-16     
    mu0 = 1.476e-18               # Dipole Moment in cgs (1.476 Debeye)
  
    # Generate Partition Functions  
    nlevs = 51
    jv=np.arange(nlevs)
    ortho = jv % 3 == 0
    para = True-ortho
    Jpara = jv[para]
    Jortho = jv[ortho]
    Brot = 298117.06e6
    Crot = 186726.36e6

    runspec = np.zeros(len(xarr))
    
    tau_dict = {}
    para_count = 0
    ortho_count = 1 # ignore 0-0

    if tau is not None and thin:
        """
        Use optical depth in the 1-1 line as a free parameter
        The optical depths of the other lines are then set by the kinetic temperature
        Tex is still a free parameter in the final spectrum calculation at the bottom
        (technically, I think this process assumes LTE; Tex should come into play in
        these equations, not just the final one)
        """
        dT0 = 41.5                    # Energy diff between (2,2) and (1,1) in K
        trot = tkin/(1+tkin/dT0*np.log(1+0.6*np.exp(-15.7/tkin)))
        tau_dict['oneone']     = tau
        tau_dict['twotwo']     = tau*(23.722/23.694)**2*4/3.*5/3.*np.exp(-41.5/trot)
        tau_dict['threethree'] = tau*(23.8701279/23.694)**2*3/2.*14./3.*np.exp(-101.1/trot)
        tau_dict['fourfour']   = tau*(24.1394169/23.694)**2*8/5.*9/3.*np.exp(-177.34/trot)
    else:
        """
        Column density is the free parameter.  It is used in conjunction with
        the full partition function to compute the optical depth in each band
        Given the complexity of these equations, it would be worth my while to
        comment each step carefully.  
        """
        Zpara = (2*Jpara+1)*np.exp(-h*(Brot*Jpara*(Jpara+1)+
            (Crot-Brot)*Jpara**2)/(kb*tkin))
        Zortho = 2*(2*Jortho+1)*np.exp(-h*(Brot*Jortho*(Jortho+1)+
            (Crot-Brot)*Jortho**2)/(kb*tkin))
        for linename in line_names:
            if ortho_dict[linename]:
                orthoparafrac = fortho
                Z = Zortho 
                count = ortho_count
                ortho_count += 1
            else:
                orthoparafrac = 1.0-fortho
                Z = Zpara
                count = para_count # need to treat partition function separately
                para_count += 1
            tau_dict[linename] = (ntot * orthoparafrac * Z[count]/(Z.sum()) / ( 1
                + np.exp(-h*freq_dict[linename]/(kb*tkin) )) * ccms**2 /
                (8*np.pi*freq_dict[linename]**2) * aval_dict[linename]*
                (1-np.exp(-h*freq_dict[linename]/(kb*tex))) /
                (width/ckms*freq_dict[linename]*np.sqrt(2*np.pi)) )

    # allow tau(11) to be specified instead of ntot
    # in the thin case, this is not needed: ntot plays no role
    # this process allows you to specify tau without using the approximate equations specified
    # above.  It should remove ntot from the calculations anyway...
    if tau is not None and not thin:
        tau11_temp = tau_dict['oneone']
        # re-scale all optical depths so that tau is as specified, but the relative taus
        # are sest by the kinetic temperature and partition functions
        for linename,t in tau_dict.iteritems():
            tau_dict[linename] = t * tau/tau11_temp

    components =[]
    for linename in line_names:
        voff_lines = np.array(voff_lines_dict[linename])
        tau_wts = np.array(tau_wts_dict[linename])
  
        lines = (1-voff_lines/ckms)*freq_dict[linename]/1e9
        tau_wts = tau_wts / (tau_wts).sum()
        nuwidth = np.abs(width/ckms*lines)
        nuoff = xoff_v/ckms*lines
  
        # tau array
        tauprof = np.zeros(len(xarr))
        for kk,no in enumerate(nuoff):
            tauprof += (tau_dict[linename] * tau_wts[kk] *
                    np.exp(-(xarr+no-lines[kk])**2 / (2.0*nuwidth[kk]**2)) *
                    fillingfraction)
            components.append( tauprof )
  
        T0 = (h*xarr*1e9/kb) # "temperature" of wavelength
        if tau is not None and thin:
            #runspec = tauprof+runspec
            # is there ever a case where you want to ignore the optical depth function? I think no
            runspec = (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-tauprof))+runspec
        else:
            runspec = (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-tauprof))+runspec
        if runspec.min() &lt; 0:
            raise ValueError("Model dropped below zero.  That is not possible normally.  Here are the input values: "+
                    ("tex: %f " % tex) + 
                    ("tkin: %f " % tkin) + 
                    ("ntot: %f " % ntot) + 
                    ("width: %f " % width) + 
                    ("xoff_v: %f " % xoff_v) + 
                    ("fortho: %f " % fortho)
                    )

    if verbose or debug:
        print "tkin: %g  tex: %g  ntot: %g  width: %g  xoff_v: %g  fortho: %g  fillingfraction: %g" % (tkin,tex,ntot,width,xoff_v,fortho,fillingfraction)

    if return_components:
        return (T0/(np.exp(T0/tex)-1)-T0/(np.exp(T0/2.73)-1))*(1-np.exp(-1*np.array(components)))

    if return_tau:
        return tau_dict
  
    return runspec

class ammonia_model(model.SpectralModel):

    def __init__(self,npeaks=1,npars=6,multisingle='multi',**kwargs):
        self.npeaks = npeaks
        self.npars = npars
        self._default_parnames = ['tkin','tex','ntot','width','xoff_v','fortho']
        self.parnames = copy.copy(self._default_parnames)

        # all fitters must have declared modelfuncs, which should take the fitted pars...
        self.modelfunc = ammonia
        self.n_modelfunc = self.n_ammonia

        # for fitting ammonia simultaneously with a flat background
        self.onepeakammonia = fitter.vheightmodel(ammonia)
        #self.onepeakammoniafit = self._fourparfitter(self.onepeakammonia)

        if multisingle in ('multi','single'):
            self.multisingle = multisingle
        else:
            raise Exception("multisingle must be multi or single")

        self.default_parinfo = None
        self.default_parinfo, kwargs = self._make_parinfo(**kwargs)

        # enforce ammonia-specific parameter limits
        for par in self.default_parinfo:
            if 'tex' in par.parname.lower():
                par.limited = (True,par.limited[1])
                par.limits = (max(par.limits[0],2.73), par.limits[1])
            if 'tkin' in par.parname.lower():
                par.limited = (True,par.limited[1])
                par.limits = (max(par.limits[0],2.73), par.limits[1])
            if 'width' in par.parname.lower():
                par.limited = (True,par.limited[1])
                par.limits = (max(par.limits[0],0), par.limits[1])
            if 'fortho' in par.parname.lower():
                par.limited = (True,True)
                if par.limits[1] != 0:
                    par.limits = (max(par.limits[0],0), min(par.limits[1],1))
                else:
                    par.limits = (max(par.limits[0],0), 1)
            if 'ntot' in par.parname.lower():
                par.limited = (True,par.limited[1])
                par.limits = (max(par.limits[0],0), par.limits[1])

        self.parinfo = copy.copy(self.default_parinfo)


        self.modelfunc_kwargs = kwargs
        # lower case? self.modelfunc_kwargs.update({'parnames':self.parinfo.parnames})

    def __call__(self,*args,**kwargs):
        #if 'use_lmfit' in kwargs: kwargs.pop('use_lmfit')
        use_lmfit = kwargs.pop('use_lmfit') if 'use_lmfit' in kwargs else self.use_lmfit
        if use_lmfit:
            return self.lmfitter(*args,**kwargs)
        if self.multisingle == 'single':
            return self.onepeakammoniafit(*args,**kwargs)
        elif self.multisingle == 'multi':
            return self.multinh3fit(*args,**kwargs)

    def n_ammonia(self, pars=None, parnames=None, **kwargs):
        """
        Returns a function that sums over N ammonia line profiles, where N is the length of
        tkin,tex,ntot,width,xoff_v,fortho *OR* N = len(pars) / 6

        The background "height" is assumed to be zero (you must "baseline" your
        spectrum before fitting)

        *pars* [ list ]
            a list with len(pars) = (6-nfixed)n, assuming
            tkin,tex,ntot,width,xoff_v,fortho repeated

        *parnames* [ list ] 
            len(parnames) must = len(pars).  parnames determine how the ammonia
            function parses the arguments
        """
        if hasattr(pars,'values'):
            # important to treat as Dictionary, since lmfit params &amp; parinfo both have .items
            parnames,parvals = zip(*pars.items())
            parnames = [p.lower() for p in parnames]
            parvals = [p.value for p in parvals]
        elif parnames is None:
            parvals = pars
            parnames = self.parnames
        else:
            parvals = pars
        if len(pars) != len(parnames):
            # this should only be needed when other codes are changing the number of peaks
            # during a copy, as opposed to letting them be set by a __call__
            # (n_modelfuncs = n_ammonia can be called directly)
            # n_modelfuncs doesn't care how many peaks there are
            if len(pars) % len(parnames) == 0:
                parnames = [p for ii in range(len(pars)/len(parnames)) for p in parnames]
                npars = len(parvals) / self.npeaks
            else:
                raise ValueError("Wrong array lengths passed to n_ammonia!")
        else:
            npars = len(parvals) / self.npeaks


        self._components = []
        def L(x):
            v = np.zeros(len(x))
            for jj in xrange(self.npeaks):
                modelkwargs = kwargs.copy()
                for ii in xrange(npars):
                    name = parnames[ii+jj*npars].strip('0123456789').lower()
                    modelkwargs.update({name:parvals[ii+jj*npars]})
                v += ammonia(x,**modelkwargs)
            return v
        return L

    def components(self, xarr, pars, hyperfine=False):
        """
        Ammonia components don't follow the default, since in Galactic astronomy the hyperfine components should be well-separated.
        If you want to see the individual components overlaid, you'll need to pass hyperfine to the plot_fit call
        """

        comps=[]
        for ii in xrange(self.npeaks):
            if hyperfine:
                modelkwargs = dict(zip(self.parnames[ii*self.npars:(ii+1)*self.npars],pars[ii*self.npars:(ii+1)*self.npars]))
                comps.append( ammonia(xarr,return_components=True,**modelkwargs) )
            else:
                modelkwargs = dict(zip(self.parnames[ii*self.npars:(ii+1)*self.npars],pars[ii*self.npars:(ii+1)*self.npars]))
                comps.append( [ammonia(xarr,return_components=False,**modelkwargs)] )

        modelcomponents = np.concatenate(comps)

        return modelcomponents


    def multinh3fit(self, xax, data, npeaks=1, err=None, 
            params=(20,20,14,1.0,0.0,0.5),
            parnames=None,
            fixed=(False,False,False,False,False,False),
            limitedmin=(True,True,True,True,False,True),
            limitedmax=(False,False,False,False,False,True), minpars=(2.73,2.73,0,0,0,0),
            parinfo=None,
            maxpars=(0,0,0,0,0,1), quiet=True, shh=True, veryverbose=False, **kwargs):
        """
        Fit multiple nh3 profiles (multiple can be 1)

        Inputs:
           xax - x axis
           data - y axis
           npeaks - How many nh3 profiles to fit?  Default 1 (this could supersede onedgaussfit)
           err - error corresponding to data

         These parameters need to have length = 6*npeaks.  If npeaks > 1 and length = 6, they will
         be replicated npeaks times, otherwise they will be reset to defaults:
           params - Fit parameters: [tkin, tex, ntot (or tau), width, offset, ortho fraction] * npeaks
                  If len(params) % 6 == 0, npeaks will be set to len(params) / 6
           fixed - Is parameter fixed?
           limitedmin/minpars - set lower limits on each parameter (default: width>0, Tex and Tkin > Tcmb)
           limitedmax/maxpars - set upper limits on each parameter
           parnames - default parameter names, important for setting kwargs in model ['tkin','tex','ntot','width','xoff_v','fortho']

           quiet - should MPFIT output each iteration?
           shh - output final parameters?

        Returns:
           Fit parameters
           Model
           Fit errors
           chi2
        """

        if parinfo is None:
            self.npars = len(params) / npeaks

            if len(params) != npeaks and (len(params) / self.npars) > npeaks:
                npeaks = len(params) / self.npars 
            self.npeaks = npeaks

            if isinstance(params,np.ndarray): params=params.tolist()
            # this is actually a hack, even though it's decently elegant
            # somehow, parnames was being changed WITHOUT being passed as a variable
            # this doesn't make sense - at all - but it happened.
            # (it is possible for self.parnames to have npars*npeaks elements where
            # npeaks > 1 coming into this function even though only 6 pars are specified;
            # _default_parnames is the workaround)
            if parnames is None: parnames = copy.copy(self._default_parnames)

            partype_dict = dict(zip(['params','parnames','fixed','limitedmin','limitedmax','minpars','maxpars'],
                    [params,parnames,fixed,limitedmin,limitedmax,minpars,maxpars]))

            # make sure all various things are the right length; if they're not, fix them using the defaults
            for partype,parlist in partype_dict.iteritems():
                if len(parlist) != self.npars*self.npeaks:
                    # if you leave the defaults, or enter something that can be multiplied by npars to get to the
                    # right number of gaussians, it will just replicate
                    if len(parlist) == self.npars: 
                        partype_dict[partype] *= npeaks 
                    elif len(parlist) > self.npars:
                        # DANGER:  THIS SHOULD NOT HAPPEN!
                        print "WARNING!  Input parameters were longer than allowed for variable ",parlist
                        partype_dict[partype] = partype_dict[partype][:self.npars]
                    elif parlist==params: # this instance shouldn't really be possible
                        partype_dict[partype] = [20,20,1e10,1.0,0.0,0.5] * npeaks
                    elif parlist==fixed:
                        partype_dict[partype] = [False] * len(params)
                    elif parlist==limitedmax: # only fortho, fillingfraction have upper limits
                        partype_dict[partype] = (np.array(parnames) == 'fortho') + (np.array(parnames) == 'fillingfraction')
                    elif parlist==limitedmin: # no physical values can be negative except velocity
                        partype_dict[partype] = (np.array(parnames) != 'xoff_v')
                    elif parlist==minpars: # all have minima of zero except kinetic temperature, which can't be below CMB.  Excitation temperature technically can be, but not in this model
                        partype_dict[partype] = ((np.array(parnames) == 'tkin') + (np.array(parnames) == 'tex')) * 2.73
                    elif parlist==maxpars: # fractions have upper limits of 1.0
                        partype_dict[partype] = ((np.array(parnames) == 'fortho') + (np.array(parnames) == 'fillingfraction')).astype('float')
                    elif parlist==parnames: # assumes the right number of parnames (essential)
                        partype_dict[partype] = list(parnames) * self.npeaks 

            if len(parnames) != len(partype_dict['params']):
                raise ValueError("Wrong array lengths AFTER fixing them")

            # used in components.  Is this just a hack?
            self.parnames = partype_dict['parnames']

            parinfo = [ {'n':ii, 'value':partype_dict['params'][ii],
                'limits':[partype_dict['minpars'][ii],partype_dict['maxpars'][ii]],
                'limited':[partype_dict['limitedmin'][ii],partype_dict['limitedmax'][ii]], 'fixed':partype_dict['fixed'][ii],
                'parname':partype_dict['parnames'][ii]+str(ii/self.npars),
                'mpmaxstep':float(partype_dict['parnames'][ii] in ('tex','tkin')), # must force small steps in temperature (True = 1.0)
                'error': 0} 
                for ii in xrange(len(partype_dict['params'])) ]

            # hack: remove 'fixed' pars
            parinfo_with_fixed = parinfo
            parinfo = [p for p in parinfo_with_fixed if not p['fixed']]
            fixed_kwargs = dict((p['parname'].strip("0123456789").lower(),p['value']) for p in parinfo_with_fixed if p['fixed'])
            # don't do this - it breaks the NEXT call because npars != len(parnames) self.parnames = [p['parname'] for p in parinfo]
            # this is OK - not a permanent change
            parnames = [p['parname'] for p in parinfo]
            # not OK self.npars = len(parinfo)/self.npeaks
            parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True)
            #import pdb; pdb.set_trace()
        else: 
            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True) 
            parinfo_with_fixed = None
            fixed_kwargs = {}

        fitfun_kwargs = dict(kwargs.items()+fixed_kwargs.items())

        npars = len(parinfo)/self.npeaks

        # (fortho0 is not fortho)
        # this doesn't work if parinfo_with_fixed is not None:
        # this doesn't work     for p in parinfo_with_fixed:
        # this doesn't work         # users can change the defaults while holding them fixed 
        # this doesn't work         if p['fixed']:
        # this doesn't work             kwargs.update({p['parname']:p['value']})

        def mpfitfun(x,y,err):
            if err is None:
                def f(p,fjac=None): return [0,(y-self.n_ammonia(pars=p, parnames=parinfo.parnames, **fitfun_kwargs)(x))]
            else:
                def f(p,fjac=None): return [0,(y-self.n_ammonia(pars=p, parnames=parinfo.parnames, **fitfun_kwargs)(x))/err]
            return f

        if veryverbose:
            print "GUESSES: "
            print "\n".join(["%s: %s" % (p['parname'],p['value']) for p in parinfo])

        mp = mpfit(mpfitfun(xax,data,err),parinfo=parinfo,quiet=quiet)
        mpp = mp.params
        if mp.perror is not None: mpperr = mp.perror
        else: mpperr = mpp*0
        chi2 = mp.fnorm

        if mp.status == 0:
            raise Exception(mp.errmsg)

        for i,p in enumerate(mpp):
            parinfo[i]['value'] = p
            parinfo[i]['error'] = mpperr[i]

        if not shh:
            print "Fit status: ",mp.status
            print "Fit message: ",mp.errmsg
            print "Final fit values: "
            for i,p in enumerate(mpp):
                print parinfo[i]['parname'],p," +/- ",mpperr[i]
            print "Chi2: ",mp.fnorm," Reduced Chi2: ",mp.fnorm/len(data)," DOF:",len(data)-len(mpp)

        if any(['tex' in s for s in parnames]) and any(['tkin' in s for s in parnames]):
            texnum = (i for i,s in enumerate(parnames) if 'tex' in s)
            tkinnum = (i for i,s in enumerate(parnames) if 'tkin' in s)
            for txn,tkn in zip(texnum,tkinnum):
                if mpp[txn] > mpp[tkn]: mpp[txn] = mpp[tkn]  # force Tex>Tkin to Tex=Tkin (already done in n_ammonia)
        self.mp = mp

        if parinfo_with_fixed is not None:
            # self self.parinfo preserving the 'fixed' parameters 
            # ORDER MATTERS!
            for p in parinfo:
                parinfo_with_fixed[p['n']] = p
            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo_with_fixed], preserve_order=True)
        else:
            self.parinfo = parinfo
            self.parinfo = ParinfoList([Parinfo(p) for p in parinfo], preserve_order=True)

        # I don't THINK these are necessary?
        #self.parinfo = parinfo
        #self.parinfo = ParinfoList([Parinfo(p) for p in self.parinfo])

        # need to restore the fixed parameters....
        # though the above commented out section indicates that I've done and undone this dozens of times now
        # (a test has been added to test_nh3.py)
        # this was NEVER included or tested because it breaks the order
        #for par in parinfo_with_fixed:
        #    if par.parname not in self.parinfo.keys():
        #        self.parinfo.append(par)

        self.mpp = self.parinfo.values
        self.mpperr = self.parinfo.errors
        self.mppnames = self.parinfo.names
        self.model = self.n_ammonia(pars=self.mpp, parnames=self.mppnames, **kwargs)(xax)
        #if self.model.sum() == 0:
        #    print "DON'T FORGET TO REMOVE THIS ERROR!"
        #    raise ValueError("Model is zeros.")

        indiv_parinfo = [self.parinfo[jj*self.npars:(jj+1)*self.npars] for jj in xrange(len(self.parinfo)/self.npars)]
        modelkwargs = [
                dict([(p['parname'].strip("0123456789").lower(),p['value']) for p in pi])
                for pi in indiv_parinfo]
        self.tau_list = [ammonia(xax,return_tau=True,**mk) for mk in modelkwargs]

        return self.mpp,self.model,self.mpperr,chi2

    def moments(self, Xax, data, negamp=None, veryverbose=False,  **kwargs):
        """
        Returns a very simple and likely incorrect guess
        """

        # TKIN, TEX, ntot, width, center, ortho fraction
        return [20,10, 1e15, 1.0, 0.0, 1.0]

    def annotations(self):
        from decimal import Decimal # for formatting
        tex_key = {'tkin':'T_K','tex':'T_{ex}','ntot':'N','fortho':'F_o','width':'\\sigma','xoff_v':'v','fillingfraction':'FF','tau':'\\tau_{1-1}'}
        # small hack below: don't quantize if error > value.  We want to see the values.
        label_list = []
        for pinfo in self.parinfo:
            parname = tex_key[pinfo['parname'].strip("0123456789").lower()]
            parnum = int(pinfo['parname'][-1])
            if pinfo['fixed']:
                formatted_value = "%s" % pinfo['value']
                pm = ""
                formatted_error=""
            else:
                formatted_value = Decimal("%g" % pinfo['value']).quantize(Decimal("%0.2g" % (min(pinfo['error'],pinfo['value']))))
                pm = "$\\pm$"
                formatted_error = Decimal("%g" % pinfo['error']).quantize(Decimal("%0.2g" % pinfo['error']))
            label =  "$%s(%i)$=%8s %s %8s" % (parname, parnum, formatted_value, pm, formatted_error)
            label_list.append(label)
        labels = tuple(mpcb.flatten(label_list))
        return labels

class ammonia_model_vtau(ammonia_model):
    def __init__(self,**kwargs):
        super(ammonia_model_vtau,self).__init__()
        self.parnames = ['tkin','tex','tau','width','xoff_v','fortho']

    def moments(self, Xax, data, negamp=None, veryverbose=False,  **kwargs):
        """
        Returns a very simple and likely incorrect guess
        """

        # TKIN, TEX, ntot, width, center, ortho fraction
        return [20,10, 1, 1.0, 0.0, 1.0]

    def __call__(self,*args,**kwargs):
        if self.multisingle == 'single':
            return self.onepeakammoniafit(*args,**kwargs)
        elif self.multisingle == 'multi':
            return self.multinh3fit(*args,**kwargs)

</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">mit</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="7"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">jakevdp/seaborn</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">doc/sphinxext/ipython_directive.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">37</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">37557</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class=""># -*- coding: utf-8 -*-
"""
Sphinx directive to support embedded IPython code.

This directive allows pasting of entire interactive IPython sessions, prompts
and all, and their code will actually get re-executed at doc build time, with
all prompts renumbered sequentially. It also allows you to input code as a pure
python input by giving the argument python to the directive. The output looks
like an interactive ipython section.

To enable this directive, simply list it in your Sphinx ``conf.py`` file
(making sure the directory where you placed it is visible to sphinx, as is
needed for all Sphinx directives). For example, to enable syntax highlighting
and the IPython directive::

    extensions = ['IPython.sphinxext.ipython_console_highlighting',
                  'IPython.sphinxext.ipython_directive']

The IPython directive outputs code-blocks with the language 'ipython'. So
if you do not have the syntax highlighting extension enabled as well, then
all rendered code-blocks will be uncolored. By default this directive assumes
that your prompts are unchanged IPython ones, but this can be customized.
The configurable options that can be placed in conf.py are:

ipython_savefig_dir:
    The directory in which to save the figures. This is relative to the
    Sphinx source directory. The default is `html_static_path`.
ipython_rgxin:
    The compiled regular expression to denote the start of IPython input
    lines. The default is re.compile('In \[(\d+)\]:\s?(.*)\s*'). You
    shouldn't need to change this.
ipython_rgxout:
    The compiled regular expression to denote the start of IPython output
    lines. The default is re.compile('Out\[(\d+)\]:\s?(.*)\s*'). You
    shouldn't need to change this.
ipython_promptin:
    The string to represent the IPython input prompt in the generated ReST.
    The default is 'In [%d]:'. This expects that the line numbers are used
    in the prompt.
ipython_promptout:
    The string to represent the IPython prompt in the generated ReST. The
    default is 'Out [%d]:'. This expects that the line numbers are used
    in the prompt.
ipython_mplbackend:
    The string which specifies if the embedded Sphinx shell should import
    Matplotlib and set the backend. The value specifies a backend that is
    passed to `matplotlib.use()` before any lines in `ipython_execlines` are
    executed. If not specified in conf.py, then the default value of 'agg' is
    used. To use the IPython directive without matplotlib as a dependency, set
    the value to `None`. It may end up that matplotlib is still imported
    if the user specifies so in `ipython_execlines` or makes use of the
    @savefig pseudo decorator.
ipython_execlines:
    A list of strings to be exec'd in the embedded Sphinx shell. Typical
    usage is to make certain packages always available. Set this to an empty
    list if you wish to have no imports always available. If specified in
    conf.py as `None`, then it has the effect of making no imports available.
    If omitted from conf.py altogether, then the default value of
    ['import numpy as np', 'import matplotlib.pyplot as plt'] is used.
ipython_holdcount
    When the @suppress pseudo-decorator is used, the execution count can be
    incremented or not. The default behavior is to hold the execution count,
    corresponding to a value of `True`. Set this to `False` to increment
    the execution count after each suppressed command.

As an example, to use the IPython directive when `matplotlib` is not available,
one sets the backend to `None`::

    ipython_mplbackend = None

An example usage of the directive is:

.. code-block:: rst

    .. ipython::

        In [1]: x = 1

        In [2]: y = x**2

        In [3]: print(y)

See http://matplotlib.org/sampledoc/ipython_directive.html for additional
documentation.

ToDo
----

- Turn the ad-hoc test() function into a real test suite.
- Break up ipython-specific functionality from matplotlib stuff into better
  separated code.

Authors
-------

- John D Hunter: orignal author.
- Fernando Perez: refactoring, documentation, cleanups, port to 0.11.
- VÃ¡clavÅ milauer &lt;eudoxos-AT-arcig.cz>: Prompt generalizations.
- Skipper Seabold, refactoring, cleanups, pure python addition
"""
from __future__ import print_function
from __future__ import unicode_literals

#-----------------------------------------------------------------------------
# Imports
#-----------------------------------------------------------------------------

# Stdlib
import os
import re
import sys
import tempfile
import ast
from pandas.compat import zip, range, map, lmap, u, cStringIO as StringIO
import warnings

# To keep compatibility with various python versions
try:
    from hashlib import md5
except ImportError:
    from md5 import md5

# Third-party
import sphinx
from docutils.parsers.rst import directives
from docutils import nodes
from sphinx.util.compat import Directive

# Our own
from IPython import Config, InteractiveShell
from IPython.core.profiledir import ProfileDir
from IPython.utils import io
from IPython.utils.py3compat import PY3

if PY3:
    from io import StringIO
    text_type = str
else:
    from StringIO import StringIO
    text_type = unicode

#-----------------------------------------------------------------------------
# Globals
#-----------------------------------------------------------------------------
# for tokenizing blocks
COMMENT, INPUT, OUTPUT =  range(3)

#-----------------------------------------------------------------------------
# Functions and class declarations
#-----------------------------------------------------------------------------

def block_parser(part, rgxin, rgxout, fmtin, fmtout):
    """
    part is a string of ipython text, comprised of at most one
    input, one ouput, comments, and blank lines.  The block parser
    parses the text into a list of::

      blocks = [ (TOKEN0, data0), (TOKEN1, data1), ...]

    where TOKEN is one of [COMMENT | INPUT | OUTPUT ] and
    data is, depending on the type of token::

      COMMENT : the comment string

      INPUT: the (DECORATOR, INPUT_LINE, REST) where
         DECORATOR: the input decorator (or None)
         INPUT_LINE: the input as string (possibly multi-line)
         REST : any stdout generated by the input line (not OUTPUT)

      OUTPUT: the output string, possibly multi-line

    """
    block = []
    lines = part.split('\n')
    N = len(lines)
    i = 0
    decorator = None
    while 1:

        if i==N:
            # nothing left to parse -- the last line
            break

        line = lines[i]
        i += 1
        line_stripped = line.strip()
        if line_stripped.startswith('#'):
            block.append((COMMENT, line))
            continue

        if line_stripped.startswith('@'):
            # we're assuming at most one decorator -- may need to
            # rethink
            decorator = line_stripped
            continue

        # does this look like an input line?
        matchin = rgxin.match(line)
        if matchin:
            lineno, inputline = int(matchin.group(1)), matchin.group(2)

            # the ....: continuation string
            continuation = '   %s:'%''.join(['.']*(len(str(lineno))+2))
            Nc = len(continuation)
            # input lines can continue on for more than one line, if
            # we have a '\' line continuation char or a function call
            # echo line 'print'.  The input line can only be
            # terminated by the end of the block or an output line, so
            # we parse out the rest of the input line if it is
            # multiline as well as any echo text

            rest = []
            while i&lt;N:

                # look ahead; if the next line is blank, or a comment, or
                # an output line, we're done

                nextline = lines[i]
                matchout = rgxout.match(nextline)
                #print "nextline=%s, continuation=%s, starts=%s"%(nextline, continuation, nextline.startswith(continuation))
                if matchout or nextline.startswith('#'):
                    break
                elif nextline.startswith(continuation):
                    nextline = nextline[Nc:]
                    if nextline and nextline[0] == ' ':
                        nextline = nextline[1:]

                    inputline += '\n' +  nextline

                else:
                    rest.append(nextline)
                i+= 1

            block.append((INPUT, (decorator, inputline, '\n'.join(rest))))
            continue

        # if it looks like an output line grab all the text to the end
        # of the block
        matchout = rgxout.match(line)
        if matchout:
            lineno, output = int(matchout.group(1)), matchout.group(2)
            if i&lt;N-1:
                output = '\n'.join([output] + lines[i:])

            block.append((OUTPUT, output))
            break

    return block


class DecodingStringIO(StringIO, object):
    def __init__(self,buf='',encodings=('utf8',), *args, **kwds):
        super(DecodingStringIO, self).__init__(buf, *args, **kwds)
        self.set_encodings(encodings)

    def set_encodings(self, encodings):
        self.encodings = encodings

    def write(self,data):
        if isinstance(data, text_type):
            return super(DecodingStringIO, self).write(data)
        else:
            for enc in self.encodings:
                try:
                    data = data.decode(enc)
                    return super(DecodingStringIO, self).write(data)
                except :
                    pass
        # default to brute utf8 if no encoding succeded
            return super(DecodingStringIO, self).write(data.decode('utf8', 'replace'))


class EmbeddedSphinxShell(object):
    """An embedded IPython instance to run inside Sphinx"""

    def __init__(self, exec_lines=None,state=None):

        self.cout = DecodingStringIO(u'')

        if exec_lines is None:
            exec_lines = []

        self.state = state

        # Create config object for IPython
        config = Config()
        config.InteractiveShell.autocall = False
        config.InteractiveShell.autoindent = False
        config.InteractiveShell.colors = 'NoColor'

        # create a profile so instance history isn't saved
        tmp_profile_dir = tempfile.mkdtemp(prefix='profile_')
        profname = 'auto_profile_sphinx_build'
        pdir = os.path.join(tmp_profile_dir,profname)
        profile = ProfileDir.create_profile_dir(pdir)

        # Create and initialize global ipython, but don't start its mainloop.
        # This will persist across different EmbededSphinxShell instances.
        IP = InteractiveShell.instance(config=config, profile_dir=profile)

        # io.stdout redirect must be done after instantiating InteractiveShell
        io.stdout = self.cout
        io.stderr = self.cout

        # For debugging, so we can see normal output, use this:
        #from IPython.utils.io import Tee
        #io.stdout = Tee(self.cout, channel='stdout') # dbg
        #io.stderr = Tee(self.cout, channel='stderr') # dbg

        # Store a few parts of IPython we'll need.
        self.IP = IP
        self.user_ns = self.IP.user_ns
        self.user_global_ns = self.IP.user_global_ns

        self.input = ''
        self.output = ''

        self.is_verbatim = False
        self.is_doctest = False
        self.is_suppress = False

        # Optionally, provide more detailed information to shell.
        self.directive = None

        # on the first call to the savefig decorator, we'll import
        # pyplot as plt so we can make a call to the plt.gcf().savefig
        self._pyplot_imported = False

        # Prepopulate the namespace.
        for line in exec_lines:
            self.process_input_line(line, store_history=False)

    def clear_cout(self):
        self.cout.seek(0)
        self.cout.truncate(0)

    def process_input_line(self, line, store_history=True):
        """process the input, capturing stdout"""

        stdout = sys.stdout
        splitter = self.IP.input_splitter
        try:
            sys.stdout = self.cout
            splitter.push(line)
            more = splitter.push_accepts_more()
            if not more:
                try:
                    source_raw = splitter.source_raw_reset()[1]
                except:
                    # recent ipython #4504
                    source_raw = splitter.raw_reset()
                self.IP.run_cell(source_raw, store_history=store_history)
        finally:
            sys.stdout = stdout

    def process_image(self, decorator):
        """
        # build out an image directive like
        # .. image:: somefile.png
        #    :width 4in
        #
        # from an input like
        # savefig somefile.png width=4in
        """
        savefig_dir = self.savefig_dir
        source_dir = self.source_dir
        saveargs = decorator.split(' ')
        filename = saveargs[1]
        # insert relative path to image file in source
        outfile = os.path.relpath(os.path.join(savefig_dir,filename),
                    source_dir)

        imagerows = ['.. image:: %s'%outfile]

        for kwarg in saveargs[2:]:
            arg, val = kwarg.split('=')
            arg = arg.strip()
            val = val.strip()
            imagerows.append('   :%s: %s'%(arg, val))

        image_file = os.path.basename(outfile) # only return file name
        image_directive = '\n'.join(imagerows)
        return image_file, image_directive

    # Callbacks for each type of token
    def process_input(self, data, input_prompt, lineno):
        """
        Process data block for INPUT token.

        """
        decorator, input, rest = data
        image_file = None
        image_directive = None

        is_verbatim = decorator=='@verbatim' or self.is_verbatim
        is_doctest = (decorator is not None and \
                     decorator.startswith('@doctest')) or self.is_doctest
        is_suppress = decorator=='@suppress' or self.is_suppress
        is_okexcept = decorator=='@okexcept' or self.is_okexcept
        is_okwarning = decorator=='@okwarning' or self.is_okwarning
        is_savefig = decorator is not None and \
                     decorator.startswith('@savefig')

        # set the encodings to be used by DecodingStringIO
        # to convert the execution output into unicode if
        # needed. this attrib is set by IpythonDirective.run()
        # based on the specified block options, defaulting to ['ut
        self.cout.set_encodings(self.output_encoding)

        input_lines = input.split('\n')

        if len(input_lines) > 1:
           if input_lines[-1] != "":
               input_lines.append('') # make sure there's a blank line
                                       # so splitter buffer gets reset

        continuation = '   %s:'%''.join(['.']*(len(str(lineno))+2))

        if is_savefig:
            image_file, image_directive = self.process_image(decorator)

        ret = []
        is_semicolon = False

        # Hold the execution count, if requested to do so.
        if is_suppress and self.hold_count:
            store_history = False
        else:
            store_history = True

        # Note: catch_warnings is not thread safe
        with warnings.catch_warnings(record=True) as ws:
            for i, line in enumerate(input_lines):
                if line.endswith(';'):
                    is_semicolon = True

                if i == 0:
                    # process the first input line
                    if is_verbatim:
                        self.process_input_line('')
                        self.IP.execution_count += 1 # increment it anyway
                    else:
                        # only submit the line in non-verbatim mode
                        self.process_input_line(line, store_history=store_history)
                    formatted_line = '%s %s'%(input_prompt, line)
                else:
                    # process a continuation line
                    if not is_verbatim:
                        self.process_input_line(line, store_history=store_history)

                    formatted_line = '%s %s'%(continuation, line)

                if not is_suppress:
                    ret.append(formatted_line)

        if not is_suppress and len(rest.strip()) and is_verbatim:
            # the "rest" is the standard output of the
            # input, which needs to be added in
            # verbatim mode
            ret.append(rest)

        self.cout.seek(0)
        output = self.cout.read()
        if not is_suppress and not is_semicolon:
            ret.append(output)
        elif is_semicolon: # get spacing right
            ret.append('')

        # context information
        filename = self.state.document.current_source
        lineno = self.state.document.current_line

        # output any exceptions raised during execution to stdout
        # unless :okexcept: has been specified.
        if not is_okexcept and "Traceback" in output:
            s =  "\nException in %s at block ending on line %s\n" % (filename, lineno)
            s += "Specify :okexcept: as an option in the ipython:: block to suppress this message\n"
            sys.stdout.write('\n\n>>>' + ('-' * 73))
            sys.stdout.write(s)
            sys.stdout.write(output)
            sys.stdout.write('&lt;&lt;&lt;' + ('-' * 73) + '\n\n')

        # output any warning raised during execution to stdout
        # unless :okwarning: has been specified.
        if not is_okwarning:
            for w in ws:
                s =  "\nWarning in %s at block ending on line %s\n" % (filename, lineno)
                s += "Specify :okwarning: as an option in the ipython:: block to suppress this message\n"
                sys.stdout.write('\n\n>>>' + ('-' * 73))
                sys.stdout.write(s)
                sys.stdout.write('-' * 76 + '\n')
                s=warnings.formatwarning(w.message, w.category,
                                         w.filename, w.lineno, w.line)
                sys.stdout.write(s)
                sys.stdout.write('&lt;&lt;&lt;' + ('-' * 73) + '\n')

        self.cout.truncate(0)
        return (ret, input_lines, output, is_doctest, decorator, image_file,
                    image_directive)


    def process_output(self, data, output_prompt,
                       input_lines, output, is_doctest, decorator, image_file):
        """
        Process data block for OUTPUT token.

        """
        TAB = ' ' * 4

        if is_doctest and output is not None:

            found = output
            found = found.strip()
            submitted = data.strip()

            if self.directive is None:
                source = 'Unavailable'
                content = 'Unavailable'
            else:
                source = self.directive.state.document.current_source
                content = self.directive.content
                # Add tabs and join into a single string.
                content = '\n'.join([TAB + line for line in content])

            # Make sure the output contains the output prompt.
            ind = found.find(output_prompt)
            if ind &lt; 0:
                e = ('output does not contain output prompt\n\n'
                     'Document source: {0}\n\n'
                     'Raw content: \n{1}\n\n'
                     'Input line(s):\n{TAB}{2}\n\n'
                     'Output line(s):\n{TAB}{3}\n\n')
                e = e.format(source, content, '\n'.join(input_lines),
                             repr(found), TAB=TAB)
                raise RuntimeError(e)
            found = found[len(output_prompt):].strip()

            # Handle the actual doctest comparison.
            if decorator.strip() == '@doctest':
                # Standard doctest
                if found != submitted:
                    e = ('doctest failure\n\n'
                         'Document source: {0}\n\n'
                         'Raw content: \n{1}\n\n'
                         'On input line(s):\n{TAB}{2}\n\n'
                         'we found output:\n{TAB}{3}\n\n'
                         'instead of the expected:\n{TAB}{4}\n\n')
                    e = e.format(source, content, '\n'.join(input_lines),
                                 repr(found), repr(submitted), TAB=TAB)
                    raise RuntimeError(e)
            else:
                self.custom_doctest(decorator, input_lines, found, submitted)

    def process_comment(self, data):
        """Process data fPblock for COMMENT token."""
        if not self.is_suppress:
            return [data]

    def save_image(self, image_file):
        """
        Saves the image file to disk.
        """
        self.ensure_pyplot()
        command = ('plt.gcf().savefig("%s", bbox_inches="tight", '
                   'dpi=100)' % image_file)

        #print 'SAVEFIG', command  # dbg
        self.process_input_line('bookmark ipy_thisdir', store_history=False)
        self.process_input_line('cd -b ipy_savedir', store_history=False)
        self.process_input_line(command, store_history=False)
        self.process_input_line('cd -b ipy_thisdir', store_history=False)
        self.process_input_line('bookmark -d ipy_thisdir', store_history=False)
        self.clear_cout()

    def process_block(self, block):
        """
        process block from the block_parser and return a list of processed lines
        """
        ret = []
        output = None
        input_lines = None
        lineno = self.IP.execution_count

        input_prompt = self.promptin % lineno
        output_prompt = self.promptout % lineno
        image_file = None
        image_directive = None

        for token, data in block:
            if token == COMMENT:
                out_data = self.process_comment(data)
            elif token == INPUT:
                (out_data, input_lines, output, is_doctest, decorator,
                    image_file, image_directive) = \
                          self.process_input(data, input_prompt, lineno)
            elif token == OUTPUT:
                out_data = \
                    self.process_output(data, output_prompt,
                                        input_lines, output, is_doctest,
                                        decorator, image_file)
            if out_data:
                ret.extend(out_data)

        # save the image files
        if image_file is not None:
            self.save_image(image_file)

        return ret, image_directive

    def ensure_pyplot(self):
        """
        Ensures that pyplot has been imported into the embedded IPython shell.

        Also, makes sure to set the backend appropriately if not set already.

        """
        # We are here if the @figure pseudo decorator was used. Thus, it's
        # possible that we could be here even if python_mplbackend were set to
        # `None`. That's also strange and perhaps worthy of raising an
        # exception, but for now, we just set the backend to 'agg'.

        if not self._pyplot_imported:
            if 'matplotlib.backends' not in sys.modules:
                # Then ipython_matplotlib was set to None but there was a
                # call to the @figure decorator (and ipython_execlines did
                # not set a backend).
                #raise Exception("No backend was set, but @figure was used!")
                import matplotlib
                matplotlib.use('agg')

            # Always import pyplot into embedded shell.
            self.process_input_line('import matplotlib.pyplot as plt',
                                    store_history=False)
            self._pyplot_imported = True

    def process_pure_python(self, content):
        """
        content is a list of strings. it is unedited directive content

        This runs it line by line in the InteractiveShell, prepends
        prompts as needed capturing stderr and stdout, then returns
        the content as a list as if it were ipython code
        """
        output = []
        savefig = False # keep up with this to clear figure
        multiline = False # to handle line continuation
        multiline_start = None
        fmtin = self.promptin

        ct = 0

        for lineno, line in enumerate(content):

            line_stripped = line.strip()
            if not len(line):
                output.append(line)
                continue

            # handle decorators
            if line_stripped.startswith('@'):
                output.extend([line])
                if 'savefig' in line:
                    savefig = True # and need to clear figure
                continue

            # handle comments
            if line_stripped.startswith('#'):
                output.extend([line])
                continue

            # deal with lines checking for multiline
            continuation  = u'   %s:'% ''.join(['.']*(len(str(ct))+2))
            if not multiline:
                modified = u"%s %s" % (fmtin % ct, line_stripped)
                output.append(modified)
                ct += 1
                try:
                    ast.parse(line_stripped)
                    output.append(u'')
                except Exception: # on a multiline
                    multiline = True
                    multiline_start = lineno
            else: # still on a multiline
                modified = u'%s %s' % (continuation, line)
                output.append(modified)

                # if the next line is indented, it should be part of multiline
                if len(content) > lineno + 1:
                    nextline = content[lineno + 1]
                    if len(nextline) - len(nextline.lstrip()) > 3:
                        continue
                try:
                    mod = ast.parse(
                            '\n'.join(content[multiline_start:lineno+1]))
                    if isinstance(mod.body[0], ast.FunctionDef):
                        # check to see if we have the whole function
                        for element in mod.body[0].body:
                            if isinstance(element, ast.Return):
                                multiline = False
                    else:
                        output.append(u'')
                        multiline = False
                except Exception:
                    pass

            if savefig: # clear figure if plotted
                self.ensure_pyplot()
                self.process_input_line('plt.clf()', store_history=False)
                self.clear_cout()
                savefig = False

        return output

    def custom_doctest(self, decorator, input_lines, found, submitted):
        """
        Perform a specialized doctest.

        """
        from .custom_doctests import doctests

        args = decorator.split()
        doctest_type = args[1]
        if doctest_type in doctests:
            doctests[doctest_type](self, args, input_lines, found, submitted)
        else:
            e = "Invalid option to @doctest: {0}".format(doctest_type)
            raise Exception(e)


class IPythonDirective(Directive):

    has_content = True
    required_arguments = 0
    optional_arguments = 4 # python, suppress, verbatim, doctest
    final_argumuent_whitespace = True
    option_spec = { 'python': directives.unchanged,
                    'suppress' : directives.flag,
                    'verbatim' : directives.flag,
                    'doctest' : directives.flag,
                    'okexcept': directives.flag,
                    'okwarning': directives.flag,
                    'output_encoding': directives.unchanged_required
                  }

    shell = None

    seen_docs = set()

    def get_config_options(self):
        # contains sphinx configuration variables
        config = self.state.document.settings.env.config

        # get config variables to set figure output directory
        confdir = self.state.document.settings.env.app.confdir
        savefig_dir = config.ipython_savefig_dir
        source_dir = os.path.dirname(self.state.document.current_source)
        if savefig_dir is None:
            savefig_dir = config.html_static_path
        if isinstance(savefig_dir, list):
            savefig_dir = savefig_dir[0] # safe to assume only one path?
        savefig_dir = os.path.join(confdir, savefig_dir)

        # get regex and prompt stuff
        rgxin      = config.ipython_rgxin
        rgxout     = config.ipython_rgxout
        promptin   = config.ipython_promptin
        promptout  = config.ipython_promptout
        mplbackend = config.ipython_mplbackend
        exec_lines = config.ipython_execlines
        hold_count = config.ipython_holdcount

        return (savefig_dir, source_dir, rgxin, rgxout,
                promptin, promptout, mplbackend, exec_lines, hold_count)

    def setup(self):
        # Get configuration values.
        (savefig_dir, source_dir, rgxin, rgxout, promptin, promptout,
         mplbackend, exec_lines, hold_count) = self.get_config_options()

        if self.shell is None:
            # We will be here many times.  However, when the
            # EmbeddedSphinxShell is created, its interactive shell member
            # is the same for each instance.

            if mplbackend:
                import matplotlib
                # Repeated calls to use() will not hurt us since `mplbackend`
                # is the same each time.
                matplotlib.use(mplbackend)

            # Must be called after (potentially) importing matplotlib and
            # setting its backend since exec_lines might import pylab.
            self.shell = EmbeddedSphinxShell(exec_lines, self.state)

            # Store IPython directive to enable better error messages
            self.shell.directive = self

        # reset the execution count if we haven't processed this doc
        #NOTE: this may be borked if there are multiple seen_doc tmp files
        #check time stamp?
        if not self.state.document.current_source in self.seen_docs:
            self.shell.IP.history_manager.reset()
            self.shell.IP.execution_count = 1
            self.shell.IP.prompt_manager.width = 0
            self.seen_docs.add(self.state.document.current_source)

        # and attach to shell so we don't have to pass them around
        self.shell.rgxin = rgxin
        self.shell.rgxout = rgxout
        self.shell.promptin = promptin
        self.shell.promptout = promptout
        self.shell.savefig_dir = savefig_dir
        self.shell.source_dir = source_dir
        self.shell.hold_count = hold_count

        # setup bookmark for saving figures directory
        self.shell.process_input_line('bookmark ipy_savedir %s'%savefig_dir,
                                      store_history=False)
        self.shell.clear_cout()

        return rgxin, rgxout, promptin, promptout

    def teardown(self):
        # delete last bookmark
        self.shell.process_input_line('bookmark -d ipy_savedir',
                                      store_history=False)
        self.shell.clear_cout()

    def run(self):
        debug = False

        #TODO, any reason block_parser can't be a method of embeddable shell
        # then we wouldn't have to carry these around
        rgxin, rgxout, promptin, promptout = self.setup()

        options = self.options
        self.shell.is_suppress = 'suppress' in options
        self.shell.is_doctest = 'doctest' in options
        self.shell.is_verbatim = 'verbatim' in options
        self.shell.is_okexcept = 'okexcept' in options
        self.shell.is_okwarning = 'okwarning' in options

        self.shell.output_encoding = [options.get('output_encoding', 'utf8')]

        # handle pure python code
        if 'python' in self.arguments:
            content = self.content
            self.content = self.shell.process_pure_python(content)

        parts = '\n'.join(self.content).split('\n\n')

        lines = ['.. code-block:: ipython', '']
        figures = []

        for part in parts:
            block = block_parser(part, rgxin, rgxout, promptin, promptout)
            if len(block):
                rows, figure = self.shell.process_block(block)
                for row in rows:
                    lines.extend(['   %s'%line for line in row.split('\n')])

                if figure is not None:
                    figures.append(figure)

        for figure in figures:
            lines.append('')
            lines.extend(figure.split('\n'))
            lines.append('')

        if len(lines)>2:
            if debug:
                print('\n'.join(lines))
            else:
                # This has to do with input, not output. But if we comment
                # these lines out, then no IPython code will appear in the
                # final output.
                self.state_machine.insert_input(
                    lines, self.state_machine.input_lines.source(0))

        # cleanup
        self.teardown()

        return []

# Enable as a proper Sphinx directive
def setup(app):
    setup.app = app

    app.add_directive('ipython', IPythonDirective)
    app.add_config_value('ipython_savefig_dir', None, 'env')
    app.add_config_value('ipython_rgxin',
                         re.compile('In \[(\d+)\]:\s?(.*)\s*'), 'env')
    app.add_config_value('ipython_rgxout',
                         re.compile('Out\[(\d+)\]:\s?(.*)\s*'), 'env')
    app.add_config_value('ipython_promptin', 'In [%d]:', 'env')
    app.add_config_value('ipython_promptout', 'Out[%d]:', 'env')

    # We could just let matplotlib pick whatever is specified as the default
    # backend in the matplotlibrc file, but this would cause issues if the
    # backend didn't work in headless environments. For this reason, 'agg'
    # is a good default backend choice.
    app.add_config_value('ipython_mplbackend', 'agg', 'env')

    # If the user sets this config value to `None`, then EmbeddedSphinxShell's
    # __init__ method will treat it as [].
    execlines = ['import numpy as np', 'import matplotlib.pyplot as plt']
    app.add_config_value('ipython_execlines', execlines, 'env')

    app.add_config_value('ipython_holdcount', True, 'env')

# Simple smoke test, needs to be converted to a proper automatic test.
def test():

    examples = [
        r"""
In [9]: pwd
Out[9]: '/home/jdhunter/py4science/book'

In [10]: cd bookdata/
/home/jdhunter/py4science/book/bookdata

In [2]: from pylab import *

In [2]: ion()

In [3]: im = imread('stinkbug.png')

@savefig mystinkbug.png width=4in
In [4]: imshow(im)
Out[4]: &lt;matplotlib.image.AxesImage object at 0x39ea850>

""",
        r"""

In [1]: x = 'hello world'

# string methods can be
# used to alter the string
@doctest
In [2]: x.upper()
Out[2]: 'HELLO WORLD'

@verbatim
In [3]: x.st&lt;TAB>
x.startswith  x.strip
""",
    r"""

In [130]: url = 'http://ichart.finance.yahoo.com/table.csv?s=CROX\
   .....: &amp;d=9&amp;e=22&amp;f=2009&amp;g=d&amp;a=1&amp;br=8&amp;c=2006&amp;ignore=.csv'

In [131]: print url.split('&amp;')
['http://ichart.finance.yahoo.com/table.csv?s=CROX', 'd=9', 'e=22', 'f=2009', 'g=d', 'a=1', 'b=8', 'c=2006', 'ignore=.csv']

In [60]: import urllib

""",
    r"""\

In [133]: import numpy.random

@suppress
In [134]: numpy.random.seed(2358)

@doctest
In [135]: numpy.random.rand(10,2)
Out[135]:
array([[ 0.64524308,  0.59943846],
       [ 0.47102322,  0.8715456 ],
       [ 0.29370834,  0.74776844],
       [ 0.99539577,  0.1313423 ],
       [ 0.16250302,  0.21103583],
       [ 0.81626524,  0.1312433 ],
       [ 0.67338089,  0.72302393],
       [ 0.7566368 ,  0.07033696],
       [ 0.22591016,  0.77731835],
       [ 0.0072729 ,  0.34273127]])

""",

    r"""
In [106]: print x
jdh

In [109]: for i in range(10):
   .....:     print i
   .....:
   .....:
0
1
2
3
4
5
6
7
8
9
""",

        r"""

In [144]: from pylab import *

In [145]: ion()

# use a semicolon to suppress the output
@savefig test_hist.png width=4in
In [151]: hist(np.random.randn(10000), 100);


@savefig test_plot.png width=4in
In [151]: plot(np.random.randn(10000), 'o');
   """,

        r"""
# use a semicolon to suppress the output
In [151]: plt.clf()

@savefig plot_simple.png width=4in
In [151]: plot([1,2,3])

@savefig hist_simple.png width=4in
In [151]: hist(np.random.randn(10000), 100);

""",
     r"""
# update the current fig
In [151]: ylabel('number')

In [152]: title('normal distribution')


@savefig hist_with_text.png
In [153]: grid(True)

@doctest float
In [154]: 0.1 + 0.2
Out[154]: 0.3

@doctest float
In [155]: np.arange(16).reshape(4,4)
Out[155]:
array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15]])

In [1]: x = np.arange(16, dtype=float).reshape(4,4)

In [2]: x[0,0] = np.inf

In [3]: x[0,1] = np.nan

@doctest float
In [4]: x
Out[4]:
array([[ inf,  nan,   2.,   3.],
       [  4.,   5.,   6.,   7.],
       [  8.,   9.,  10.,  11.],
       [ 12.,  13.,  14.,  15.]])


        """,
        ]
    # skip local-file depending first example:
    examples = examples[1:]

    #ipython_directive.DEBUG = True  # dbg
    #options = dict(suppress=True)  # dbg
    options = dict()
    for example in examples:
        content = example.split('\n')
        IPythonDirective('debug', arguments=None, options=options,
                          content=content, lineno=0,
                          content_offset=None, block_text=None,
                          state=None, state_machine=None,
                          )

# Run test suite as a script
if __name__=='__main__':
    if not os.path.isdir('_static'):
        os.mkdir('_static')
    test()
    print('All OK? Check figures in _static/')
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">bsd-3-clause</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="8"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">INCF/BIDS2ISATab</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">setup.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">1</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2176</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">from setuptools import setup
import os

here = os.path.abspath(os.path.dirname(__file__))

setup(
    name="BIDS2ISATab",

    # Versions should comply with PEP440.  For a discussion on single-sourcing
    # the version across setup.py and the project code, see
    # http://packaging.python.org/en/latest/tutorial.html#version
    version='0.1.0',

    description="Command line tool generating ISA-Tab compatible description from a Brain Imaging Data Structure "
                "compatible dataset.",
    long_description="Command line tool generating ISA-Tab compatible description from a Brain Imaging Data Structure "
                     "compatible dataset.",

    # The project URL.
    url='https://github.com/INCF/BIDS2ISATab',

    # Choose your license
    license='BSD',

    classifiers=[
        # How mature is this project? Common values are
        #   3 - Alpha
        #   4 - Beta
        #   5 - Production/Stable
        'Development Status :: 4 - Beta',

        # Pick your license as you wish (should match "license" above)
        'License :: OSI Approved :: BSD License',

        # Specify the Python versions you support here. In particular, ensure
        # that you indicate whether you support Python 2, Python 3 or both.
        'Programming Language :: Python :: 2.7',
        'Programming Language :: Python :: 3.5',
    ],

    # What does your project relate to?
    keywords='bids isatab',

    # You can just specify the packages manually here if your project is
    # simple. Or you can use find_packages.
    packages=["bids2isatab"],

    # List run-time dependencies here.  These will be installed by pip when your
    # project is installed.
    install_requires = ["future",
                        "pandas",
                        'nibabel'],

    include_package_data=True,

    # To provide executable scripts, use entry points in preference to the
    # "scripts" keyword. Entry points provide cross-platform support and allow
    # pip to create the appropriate form of executable for the target platform.
    entry_points={
        'console_scripts': [
            'bids2isatab=bids2isatab.main:main',
        ],
    },
)
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">apache-2.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="9"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">zooniverse/aggregation</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">experimental/clusteringAlg/adaptiveDBSCAN.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">4734</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#!/usr/bin/env python
__author__ = 'greg'
from sklearn.cluster import DBSCAN
import numpy as np
import math

def dist(c1,c2):
    return math.sqrt((c1[0]-c2[0])**2 + (c1[1]-c2[1])**2)

class CannotSplit(Exception):
    def __init__(self,value):
        self.value = value
    def __str__(self):
        return ""
samples_needed = 3

def adaptiveDBSCAN(XYpts,user_ids):
    if XYpts == []:
        return []

    pts_in_each_cluster = []
    users_in_each_cluster = []
    cluster_centers = []

    #increase the epsilon until we don't have any nearby clusters corresponding to non-overlapping
    #sets of users
    X = np.array(XYpts)
    #for epsilon in [5,10,15,20,25,30]:
    for first_epsilon in [100,200,300,400]:
        db = DBSCAN(eps=first_epsilon, min_samples=samples_needed).fit(X)

        labels = db.labels_
        pts_in_each_cluster = []
        users_in_each_cluster = []
        cluster_centers = []

        for k in sorted(set(labels)):
            if k == -1:
                continue

            class_member_mask = (labels == k)
            pts_in_cluster = list(X[class_member_mask])
            xSet,ySet = zip(*pts_in_cluster)

            cluster_centers.append((np.mean(xSet),np.mean(ySet)))
            pts_in_each_cluster.append(pts_in_cluster[:])
            users_in_each_cluster.append([u for u,l in zip(user_ids,labels) if l == k])

        #do we have any adjacent clusters with non-overlapping sets of users
        #if so, we should merge them by increasing the epsilon value
        cluster_compare = []
        for cluster_index, (c1,users) in enumerate(zip(cluster_centers,users_in_each_cluster)):
            for cluster_index, (c2,users2) in enumerate(zip(cluster_centers[cluster_index+1:],users_in_each_cluster[cluster_index+1:])):
                overlappingUsers = [u for u in users if u in users2]
                cluster_compare.append((dist(c1,c2),overlappingUsers))

        cluster_compare.sort(key = lambda x:x[0])
        needToMerge = [] in [c[1] for c in cluster_compare[:10]]
        if not(needToMerge):
            break
    #print epsilon
    #print [c[1] for c in cluster_compare[:10]]
    centers_to_return = []
    assert not(needToMerge)


    #do we need to split any clusters?
    for cluster_index in range(len(cluster_centers)):
        #print "splitting"
        needToSplit = (sorted(users_in_each_cluster[cluster_index]) != sorted(list(set(users_in_each_cluster[cluster_index]))))
        if needToSplit:
            subcluster_centers = []
            stillToSplit = []
            X = np.array(pts_in_each_cluster[cluster_index])
            #for epsilon in [30,25,20,15,10,5,1,0.1,0.01]:
            for second_epsilon in range(200,1,-2):#[400,300,200,100,80,75,65,60,50,25,24,23,22,21,20,19,18,17,16,15,14,13,10,5,1]:
                db = DBSCAN(eps=second_epsilon, min_samples=samples_needed).fit(X)

                labels = db.labels_
                subcluster_centers = []

                needToSplit = False

                for k in sorted(set(labels)):
                    if k == -1:
                        continue

                    class_member_mask = (labels == k)
                    users_in_subcluster = [u for u,l in zip(users_in_each_cluster[cluster_index],labels) if l == k]
                    needToSplit =  (sorted(users_in_subcluster) != sorted(list(set(users_in_subcluster))))
                    if needToSplit:
                        stillToSplit = list(X[class_member_mask])
                        break

                    pts_in_cluster = list(X[class_member_mask])
                    xSet,ySet = zip(*pts_in_cluster)
                    subcluster_centers.append((np.mean(xSet),np.mean(ySet)))

                if not(needToSplit):
                    break


            if needToSplit:
                print "second is " + str(second_epsilon)
                print stillToSplit
                for i in range(len(stillToSplit)):
                    p1 = stillToSplit[i]
                    for j in range(len(stillToSplit[i+1:])):
                        p2 = stillToSplit[j+i+1]
                        print math.sqrt((p1[0]-p2[0])**2 + (p1[1]-p2[1])**2),
                        #print (i,j+i+1),
                    print
                print X
                print users_in_each_cluster[cluster_index]
                raise CannotSplit(pts_in_each_cluster[cluster_index])
            centers_to_return.extend(subcluster_centers)

            #if needToSplit:
            #    print pts_in_each_cluster[cluster_index]
            #    print users_in_each_cluster[cluster_index]
            #else:

        else:
            centers_to_return.append(cluster_centers[cluster_index])



    return centers_to_return</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">apache-2.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="10"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">jrleja/bsfh</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">misc/timings_pyfsps.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">3</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">4274</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#compare a lookup table of spectra at ages and metallicities to
#calls to fsps.sps.get_spectrum() for different metallicities
import time, os, subprocess, re, sys
import numpy as np
#import matplotlib.pyplot as pl
import fsps
from prospect import sources as sps_basis
from prospect.models import sedmodel


def run_command(cmd):
    """
    Open a child process, and return its exit status and stdout.

    """
    child = subprocess.Popen(cmd, shell=True, stderr=subprocess.PIPE,
                             stdin=subprocess.PIPE, stdout=subprocess.PIPE)
    out = [s for s in child.stdout]
    w = child.wait()
    return os.WEXITSTATUS(w), out


# Check to make sure that the required environment variable is present.
try:
    ev = os.environ["SPS_HOME"]
except KeyError:
    raise ImportError("You need to have the SPS_HOME environment variable")

# Check the SVN revision number.
cmd = ["svnversion", ev]
stat, out = run_command(" ".join(cmd))
fsps_vers = int(re.match("^([0-9])+", out[0]).group(0))


sps = fsps.StellarPopulation(zcontinuous=True)
print('FSPS version = {}'.format(fsps_vers))
print('Zs={0}, N_lambda={1}'.format(sps.zlegend, len(sps.wavelengths)))
print('single age')

def spec_from_fsps(z, t, s):
    t0 = time.time()
    sps.params['logzsol'] = z
    sps.params['sigma_smooth'] = s
    sps.params['tage'] = t
    wave, spec  = sps.get_spectrum(peraa=True, tage = sps.params['tage'])
    #print(spec.shape)
    return time.time()-t0

def mags_from_fsps(z, t, s):
    t0 = time.time()
    sps.params['zred']=t
    sps.params['logzsol'] = z
    sps.params['sigma_smooth'] = s
    sps.params['tage'] = t
    mags  = sps.get_mags(tage = sps.params['tage'], redshift=0.0)
    #print(spec.shape)
    return time.time()-t0


def spec_from_ztinterp(z, t, s):
    t0 = time.time()
    sps.params['logzsol'] = z
    sps.params['sigma_smooth'] = s
    sps.params['tage'] = t
    sps.params['imf3'] = s
    spec, m, l  = sps.ztinterp(sps.params['logzsol'], sps.params['tage'], peraa=True)
    #print(spec.shape)
    return time.time()-t0
  

if sys.argv[1] == 'mags':
    from_fsps = mags_from_fsps
    print('timing get_mags')
    print('nbands = {}'.format(len(sps.get_mags(tage=1.0))))
elif sys.argv[1] == 'spec':
    from_fsps = spec_from_fsps
    print('timing get_spectrum')
elif sys.argv[1] == 'ztinterp':
    from_fsps = spec_from_ztinterp
    print('timing get_spectrum')
elif sys.argv[1] == 'sedpy':
    from sedpy import observate
    nbands = len(sps.get_mags(tage=1.0))
    fnames = nbands * ['sdss_r0']
    filters = observate.load_filters(fnames)
    
    def mags_from_sedpy(z, t, s):
        t0 = time.time()
        sps.params['logzsol'] = z
        sps.params['sigma_smooth'] = s
        sps.params['tage'] = t
        wave, spec  = sps.get_spectrum(peraa=True,
                                       tage = sps.params['tage'])
        mags = observate.getSED(wave, spec, filters)
        return time.time()-t0
    
    from_fsps = mags_from_sedpy
    
sps.params['add_neb_emission'] = False
sps.params['smooth_velocity'] = True
sps.params['sfh'] = 0

ntry = 30
zz = np.random.uniform(-1,0,ntry)
tt = np.random.uniform(0.1,4,ntry)
ss = np.random.uniform(1,2.5,ntry)

#make sure all z's already compiled
_ =[from_fsps(z, 1.0, 0.0) for z in [-1, -0.8, -0.6, -0.4, -0.2, 0.0]]
all_dur = []
print('no neb emission:')
dur_many = np.zeros(ntry)
for i in xrange(ntry):
    dur_many[i] = from_fsps(zz[i], tt[i], ss[i])
print('&lt;t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))
all_dur += [dur_many]

print('no neb emission, no smooth:')
dur_many = np.zeros(ntry)
for i in xrange(ntry):
    dur_many[i] = from_fsps(zz[i], tt[i], 0.0)
print('&lt;t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))
all_dur += [dur_many]

sps.params['add_neb_emission'] = True    
print('neb emission:')
dur_many = np.zeros(ntry)
for i in xrange(ntry):
    dur_many[i] = from_fsps(zz[i], tt[i], ss[i])
print('&lt;t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))
all_dur += [dur_many]
    
print('neb emission, no smooth:')
dur_many = np.zeros(ntry)
for i in xrange(ntry):
    dur_many[i] = from_fsps(zz[i], tt[i], 0.0)
print('&lt;t/call>={0}s, sigma_t={1}s'.format(dur_many.mean(), dur_many.std()))
all_dur += [dur_many]


</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">mit</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="11"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">ClinicalGraphics/scikit-image</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">doc/examples/xx_applications/plot_morphology.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">6</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">8329</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">"""
=======================
Morphological Filtering
=======================

Morphological image processing is a collection of non-linear operations related
to the shape or morphology of features in an image, such as boundaries,
skeletons, etc. In any given technique, we probe an image with a small shape or
template called a structuring element, which defines the region of interest or
neighborhood around a pixel.

In this document we outline the following basic morphological operations:

1. Erosion
2. Dilation
3. Opening
4. Closing
5. White Tophat
6. Black Tophat
7. Skeletonize
8. Convex Hull


To get started, let's load an image using ``io.imread``. Note that morphology
functions only work on gray-scale or binary images, so we set ``as_grey=True``.
"""

import matplotlib.pyplot as plt
from skimage.data import data_dir
from skimage.util import img_as_ubyte
from skimage import io

phantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))
fig, ax = plt.subplots()
ax.imshow(phantom, cmap=plt.cm.gray)

"""
.. image:: PLOT2RST.current_figure

Let's also define a convenience function for plotting comparisons:
"""

def plot_comparison(original, filtered, filter_name):

    fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(8, 4), sharex=True, sharey=True)
    ax1.imshow(original, cmap=plt.cm.gray)
    ax1.set_title('original')
    ax1.axis('off')
    ax1.set_adjustable('box-forced')
    ax2.imshow(filtered, cmap=plt.cm.gray)
    ax2.set_title(filter_name)
    ax2.axis('off')
    ax2.set_adjustable('box-forced')

"""
Erosion
=======

Morphological ``erosion`` sets a pixel at (i, j) to the *minimum over all
pixels in the neighborhood centered at (i, j)*. The structuring element,
``selem``, passed to ``erosion`` is a boolean array that describes this
neighborhood. Below, we use ``disk`` to create a circular structuring element,
which we use for most of the following examples.
"""

from skimage.morphology import erosion, dilation, opening, closing, white_tophat
from skimage.morphology import black_tophat, skeletonize, convex_hull_image
from skimage.morphology import disk

selem = disk(6)
eroded = erosion(phantom, selem)
plot_comparison(phantom, eroded, 'erosion')

"""
.. image:: PLOT2RST.current_figure

Notice how the white boundary of the image disappears or gets eroded as we
increase the size of the disk. Also notice the increase in size of the two
black ellipses in the center and the disappearance of the 3 light grey
patches in the lower part of the image.


Dilation
========

Morphological ``dilation`` sets a pixel at (i, j) to the *maximum over all
pixels in the neighborhood centered at (i, j)*. Dilation enlarges bright
regions and shrinks dark regions.
"""

dilated = dilation(phantom, selem)
plot_comparison(phantom, dilated, 'dilation')

"""
.. image:: PLOT2RST.current_figure

Notice how the white boundary of the image thickens, or gets dilated, as we
increase the size of the disk. Also notice the decrease in size of the two
black ellipses in the centre, and the thickening of the light grey circle in
the center and the 3 patches in the lower part of the image.


Opening
=======

Morphological ``opening`` on an image is defined as an *erosion followed by a
dilation*. Opening can remove small bright spots (i.e. "salt") and connect
small dark cracks.
"""

opened = opening(phantom, selem)
plot_comparison(phantom, opened, 'opening')

"""
.. image:: PLOT2RST.current_figure

Since ``opening`` an image starts with an erosion operation, light regions that
are *smaller* than the structuring element are removed. The dilation operation
that follows ensures that light regions that are *larger* than the structuring
element retain their original size. Notice how the light and dark shapes in the
center their original thickness but the 3 lighter patches in the bottom get
completely eroded. The size dependence is highlighted by the outer white ring:
The parts of the ring thinner than the structuring element were completely
erased, while the thicker region at the top retains its original thickness.


Closing
=======

Morphological ``closing`` on an image is defined as a *dilation followed by an
erosion*. Closing can remove small dark spots (i.e. "pepper") and connect
small bright cracks.

To illustrate this more clearly, let's add a small crack to the white border:
"""

phantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))
phantom[10:30, 200:210] = 0

closed = closing(phantom, selem)
plot_comparison(phantom, closed, 'closing')

"""
.. image:: PLOT2RST.current_figure

Since ``closing`` an image starts with an dilation operation, dark regions
that are *smaller* than the structuring element are removed. The dilation
operation that follows ensures that dark regions that are *larger* than the
structuring element retain their original size. Notice how the white ellipses
at the bottom get connected because of dilation, but other dark region retain
their original sizes. Also notice how the crack we added is mostly removed.


White tophat
============

The ``white_tophat`` of an image is defined as the *image minus its
morphological opening*. This operation returns the bright spots of the image
that are smaller than the structuring element.

To make things interesting, we'll add bright and dark spots to the image:
"""

phantom = img_as_ubyte(io.imread(data_dir+'/phantom.png', as_grey=True))
phantom[340:350, 200:210] = 255
phantom[100:110, 200:210] = 0

w_tophat = white_tophat(phantom, selem)
plot_comparison(phantom, w_tophat, 'white tophat')

"""
.. image:: PLOT2RST.current_figure

As you can see, the 10-pixel wide white square is highlighted since it is
smaller than the structuring element. Also, the thin, white edges around most
of the ellipse are retained because they're smaller than the structuring
element, but the thicker region at the top disappears.


Black tophat
============

The ``black_tophat`` of an image is defined as its morphological **closing
minus the original image**. This operation returns the *dark spots of the
image that are smaller than the structuring element*.
"""

b_tophat = black_tophat(phantom, selem)
plot_comparison(phantom, b_tophat, 'black tophat')

"""
.. image:: PLOT2RST.current_figure

As you can see, the 10-pixel wide black square is highlighted since it is
smaller than the structuring element.


Duality
-------

As you should have noticed, many of these operations are simply the reverse
of another operation. This duality can be summarized as follows:

1. Erosion &lt;-> Dilation
2. Opening &lt;-> Closing
3. White tophat &lt;-> Black tophat


Skeletonize
===========

Thinning is used to reduce each connected component in a binary image to a
*single-pixel wide skeleton*. It is important to note that this is performed
on binary images only.

"""

from skimage import img_as_bool
horse = ~img_as_bool(io.imread(data_dir+'/horse.png', as_grey=True))

sk = skeletonize(horse)
plot_comparison(horse, sk, 'skeletonize')

"""
.. image:: PLOT2RST.current_figure

As the name suggests, this technique is used to thin the image to 1-pixel wide
skeleton by applying thinning successively.


Convex hull
===========

The ``convex_hull_image`` is the *set of pixels included in the smallest
convex polygon that surround all white pixels in the input image*. Again note
that this is also performed on binary images.

"""

hull1 = convex_hull_image(horse)
plot_comparison(horse, hull1, 'convex hull')

"""
.. image:: PLOT2RST.current_figure

As the figure illustrates, ``convex_hull_image`` gives the smallest polygon
which covers the white or True completely in the image.

If we add a small grain to the image, we can see how the convex hull adapts to
enclose that grain:
"""

import numpy as np

horse2 = np.copy(horse)
horse2[45:50, 75:80] = 1

hull2 = convex_hull_image(horse2)
plot_comparison(horse2, hull2, 'convex hull')

"""
.. image:: PLOT2RST.current_figure


Additional Resources
====================

1. `MathWorks tutorial on morphological processing
&lt;http://www.mathworks.com/help/images/morphology-fundamentals-dilation-and-erosion.html>`_
2. `Auckland university's tutorial on Morphological Image Processing
&lt;http://www.cs.auckland.ac.nz/courses/compsci773s1c/lectures/ImageProcessing-html/topic4.htm>`_
3. http://en.wikipedia.org/wiki/Mathematical_morphology

"""

plt.show()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">bsd-3-clause</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="12"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">codenote/chromium-test</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">ppapi/native_client/tests/breakpad_crash_test/crash_dump_tester.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">6</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">8213</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#!/usr/bin/python
# Copyright (c) 2012 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import os
import subprocess
import sys
import tempfile
import time

script_dir = os.path.dirname(__file__)
sys.path.append(os.path.join(script_dir,
                             '../../tools/browser_tester'))

import browser_tester
import browsertester.browserlauncher

# This script extends browser_tester to check for the presence of
# Breakpad crash dumps.


# This reads a file of lines containing 'key:value' pairs.
# The file contains entries like the following:
#   plat:Win32
#   prod:Chromium
#   ptype:nacl-loader
#   rept:crash svc
def ReadDumpTxtFile(filename):
  dump_info = {}
  fh = open(filename, 'r')
  for line in fh:
    if ':' in line:
      key, value = line.rstrip().split(':', 1)
      dump_info[key] = value
  fh.close()
  return dump_info


def StartCrashService(browser_path, dumps_dir, windows_pipe_name,
                      cleanup_funcs, crash_service_exe):
  # Find crash_service.exe relative to chrome.exe.  This is a bit icky.
  browser_dir = os.path.dirname(browser_path)
  proc = subprocess.Popen([os.path.join(browser_dir, crash_service_exe),
                           '--v=1',  # Verbose output for debugging failures
                           '--dumps-dir=%s' % dumps_dir,
                           '--pipe-name=%s' % windows_pipe_name])

  def Cleanup():
    # Note that if the process has already exited, this will raise
    # an 'Access is denied' WindowsError exception, but
    # crash_service.exe is not supposed to do this and such
    # behaviour should make the test fail.
    proc.terminate()
    status = proc.wait()
    sys.stdout.write('crash_dump_tester: %s exited with status %s\n'
                     % (crash_service_exe, status))

  cleanup_funcs.append(Cleanup)


def ListPathsInDir(dir_path):
  if os.path.exists(dir_path):
    return [os.path.join(dir_path, name)
            for name in os.listdir(dir_path)]
  else:
    return []


def GetDumpFiles(dumps_dirs):
  all_files = [filename
               for dumps_dir in dumps_dirs
               for filename in ListPathsInDir(dumps_dir)]
  sys.stdout.write('crash_dump_tester: Found %i files\n' % len(all_files))
  for dump_file in all_files:
    sys.stdout.write('  %s (size %i)\n'
                     % (dump_file, os.stat(dump_file).st_size))
  return [dump_file for dump_file in all_files
          if dump_file.endswith('.dmp')]


def Main(cleanup_funcs):
  parser = browser_tester.BuildArgParser()
  parser.add_option('--expected_crash_dumps', dest='expected_crash_dumps',
                    type=int, default=0,
                    help='The number of crash dumps that we should expect')
  parser.add_option('--expected_process_type_for_crash',
                    dest='expected_process_type_for_crash',
                    type=str, default='nacl-loader',
                    help='The type of Chromium process that we expect the '
                    'crash dump to be for')
  # Ideally we would just query the OS here to find out whether we are
  # running x86-32 or x86-64 Windows, but Python's win32api module
  # does not contain a wrapper for GetNativeSystemInfo(), which is
  # what NaCl uses to check this, or for IsWow64Process(), which is
  # what Chromium uses.  Instead, we just rely on the build system to
  # tell us.
  parser.add_option('--win64', dest='win64', action='store_true',
                    help='Pass this if we are running tests for x86-64 Windows')
  options, args = parser.parse_args()

  temp_dir = tempfile.mkdtemp(prefix='nacl_crash_dump_tester_')
  def CleanUpTempDir():
    browsertester.browserlauncher.RemoveDirectory(temp_dir)
  cleanup_funcs.append(CleanUpTempDir)

  # To get a guaranteed unique pipe name, use the base name of the
  # directory we just created.
  windows_pipe_name = r'\\.\pipe\%s_crash_service' % os.path.basename(temp_dir)

  # This environment variable enables Breakpad crash dumping in
  # non-official builds of Chromium.
  os.environ['CHROME_HEADLESS'] = '1'
  if sys.platform == 'win32':
    dumps_dir = temp_dir
    # Override the default (global) Windows pipe name that Chromium will
    # use for out-of-process crash reporting.
    os.environ['CHROME_BREAKPAD_PIPE_NAME'] = windows_pipe_name
    # Launch the x86-32 crash service so that we can handle crashes in
    # the browser process.
    StartCrashService(options.browser_path, dumps_dir, windows_pipe_name,
                      cleanup_funcs, 'crash_service.exe')
    if options.win64:
      # Launch the x86-64 crash service so that we can handle crashes
      # in the NaCl loader process (nacl64.exe).
      StartCrashService(options.browser_path, dumps_dir, windows_pipe_name,
                        cleanup_funcs, 'crash_service64.exe')
    # We add a delay because there is probably a race condition:
    # crash_service.exe might not have finished doing
    # CreateNamedPipe() before NaCl does a crash dump and tries to
    # connect to that pipe.
    # TODO(mseaborn): We could change crash_service.exe to report when
    # it has successfully created the named pipe.
    time.sleep(1)
  elif sys.platform == 'darwin':
    dumps_dir = temp_dir
    os.environ['BREAKPAD_DUMP_LOCATION'] = dumps_dir
  elif sys.platform.startswith('linux'):
    # The "--user-data-dir" option is not effective for the Breakpad
    # setup in Linux Chromium, because Breakpad is initialized before
    # "--user-data-dir" is read.  So we set HOME to redirect the crash
    # dumps to a temporary directory.
    home_dir = temp_dir
    os.environ['HOME'] = home_dir
    options.enable_crash_reporter = True

  result = browser_tester.Run(options.url, options)

  # Find crash dump results.
  if sys.platform.startswith('linux'):
    # Look in "~/.config/*/Crash Reports".  This will find crash
    # reports under ~/.config/chromium or ~/.config/google-chrome, or
    # under other subdirectories in case the branding is changed.
    dumps_dirs = [os.path.join(path, 'Crash Reports')
                  for path in ListPathsInDir(os.path.join(home_dir, '.config'))]
  else:
    dumps_dirs = [dumps_dir]
  dmp_files = GetDumpFiles(dumps_dirs)

  failed = False
  msg = ('crash_dump_tester: ERROR: Got %i crash dumps but expected %i\n' %
         (len(dmp_files), options.expected_crash_dumps))
  if len(dmp_files) != options.expected_crash_dumps:
    sys.stdout.write(msg)
    failed = True

  for dump_file in dmp_files:
    # Sanity check: Make sure dumping did not fail after opening the file.
    msg = 'crash_dump_tester: ERROR: Dump file is empty\n'
    if os.stat(dump_file).st_size == 0:
      sys.stdout.write(msg)
      failed = True

    # On Windows, the crash dumps should come in pairs of a .dmp and
    # .txt file.
    if sys.platform == 'win32':
      second_file = dump_file[:-4] + '.txt'
      msg = ('crash_dump_tester: ERROR: File %r is missing a corresponding '
             '%r file\n' % (dump_file, second_file))
      if not os.path.exists(second_file):
        sys.stdout.write(msg)
        failed = True
        continue
      # Check that the crash dump comes from the NaCl process.
      dump_info = ReadDumpTxtFile(second_file)
      if 'ptype' in dump_info:
        msg = ('crash_dump_tester: ERROR: Unexpected ptype value: %r != %r\n'
               % (dump_info['ptype'], options.expected_process_type_for_crash))
        if dump_info['ptype'] != options.expected_process_type_for_crash:
          sys.stdout.write(msg)
          failed = True
      else:
        sys.stdout.write('crash_dump_tester: ERROR: Missing ptype field\n')
        failed = True
    # TODO(mseaborn): Ideally we would also check that a backtrace
    # containing an expected function name can be extracted from the
    # crash dump.

  if failed:
    sys.stdout.write('crash_dump_tester: FAILED\n')
    result = 1
  else:
    sys.stdout.write('crash_dump_tester: PASSED\n')

  return result


def MainWrapper():
  cleanup_funcs = []
  try:
    return Main(cleanup_funcs)
  finally:
    for func in cleanup_funcs:
      func()


if __name__ == '__main__':
  sys.exit(MainWrapper())
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">bsd-3-clause</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="13"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">hainm/dask</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">dask/dataframe/shuffle.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">4</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">2967</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">from itertools import count
from collections import Iterator
from math import ceil
from toolz import merge, accumulate, merge_sorted
import toolz
from operator import getitem, setitem
import pandas as pd
import numpy as np
from pframe import pframe

from .. import threaded
from .core import DataFrame, Series, get, names
from ..compatibility import unicode
from ..utils import ignoring


tokens = ('-%d' % i for i in count(1))


def set_index(f, index, npartitions=None, **kwargs):
    """ Set DataFrame index to new column

    Sorts index and realigns Dataframe to new sorted order.  This shuffles and
    repartitions your data.
    """
    npartitions = npartitions or f.npartitions
    if not isinstance(index, Series):
        index2 = f[index]
    else:
        index2 = index

    divisions = (index2
                  .quantiles(np.linspace(0, 100, npartitions+1)[1:-1])
                  .compute())
    return f.set_partition(index, divisions, **kwargs)


partition_names = ('set_partition-%d' % i for i in count(1))

def set_partition(f, index, divisions, get=threaded.get, **kwargs):
    """ Set new partitioning along index given divisions """
    divisions = unique(divisions)
    name = next(names)
    if isinstance(index, Series):
        assert index.divisions == f.divisions
        dsk = dict(((name, i), (f._partition_type.set_index, block, ind))
                for i, (block, ind) in enumerate(zip(f._keys(), index._keys())))
        f2 = type(f)(merge(f.dask, index.dask, dsk), name,
                       f.column_info, f.divisions)
    else:
        dsk = dict(((name, i), (f._partition_type.set_index, block, index))
                for i, block in enumerate(f._keys()))
        f2 = type(f)(merge(f.dask, dsk), name, f.column_info, f.divisions)

    head = f2.head()
    pf = pframe(like=head, divisions=divisions, **kwargs)

    def append(block):
        pf.append(block)
        return 0

    f2.map_blocks(append).compute(get=get)
    pf.flush()

    return from_pframe(pf)


def from_pframe(pf):
    """ Load dask.array from pframe """
    name = next(names)
    dsk = dict(((name, i), (pframe.get_partition, pf, i))
                for i in range(pf.npartitions))

    return DataFrame(dsk, name, pf.columns, pf.divisions)


def unique(divisions):
    """ Polymorphic unique function

    >>> list(unique([1, 2, 3, 1, 2, 3]))
    [1, 2, 3]

    >>> unique(np.array([1, 2, 3, 1, 2, 3]))
    array([1, 2, 3])

    >>> unique(pd.Categorical(['Alice', 'Bob', 'Alice'], ordered=False))
    [Alice, Bob]
    Categories (2, object): [Alice, Bob]
    """
    if isinstance(divisions, np.ndarray):
        return np.unique(divisions)
    if isinstance(divisions, pd.Categorical):
        return pd.Categorical.from_codes(np.unique(divisions.codes),
                divisions.categories, divisions.ordered)
    if isinstance(divisions, (tuple, list, Iterator)):
        return tuple(toolz.unique(divisions))
    raise NotImplementedError()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">bsd-3-clause</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="14"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">allanino/nupic</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">external/linux32/lib/python2.6/site-packages/matplotlib/backends/backend_tkagg.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">69</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">24593</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class=""># Todd Miller   jmiller@stsci.edu

from __future__ import division

import os, sys, math

import Tkinter as Tk, FileDialog
import tkagg                 # Paint image to Tk photo blitter extension
from backend_agg import FigureCanvasAgg

import os.path

import matplotlib
from matplotlib.cbook import is_string_like
from matplotlib.backend_bases import RendererBase, GraphicsContextBase, \
     FigureManagerBase, FigureCanvasBase, NavigationToolbar2, cursors

from matplotlib.figure import Figure
from matplotlib._pylab_helpers import Gcf

import matplotlib.windowing as windowing
from matplotlib.widgets import SubplotTool

import matplotlib.cbook as cbook

rcParams = matplotlib.rcParams
verbose = matplotlib.verbose


backend_version = Tk.TkVersion

# the true dots per inch on the screen; should be display dependent
# see http://groups.google.com/groups?q=screen+dpi+x11&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;safe=off&amp;selm=7077.26e81ad5%40swift.cs.tcd.ie&amp;rnum=5 for some info about screen dpi
PIXELS_PER_INCH = 75

cursord = {
    cursors.MOVE: "fleur",
    cursors.HAND: "hand2",
    cursors.POINTER: "arrow",
    cursors.SELECT_REGION: "tcross",
    }


def round(x):
    return int(math.floor(x+0.5))

def raise_msg_to_str(msg):
    """msg is a return arg from a raise.  Join with new lines"""
    if not is_string_like(msg):
        msg = '\n'.join(map(str, msg))
    return msg

def error_msg_tkpaint(msg, parent=None):
    import tkMessageBox
    tkMessageBox.showerror("matplotlib", msg)

def draw_if_interactive():
    if matplotlib.is_interactive():
        figManager =  Gcf.get_active()
        if figManager is not None:
            figManager.show()


def show():
    """
    Show all the figures and enter the gtk mainloop

    This should be the last line of your script.  This function sets
    interactive mode to True, as detailed on
    http://matplotlib.sf.net/interactive.html
    """
    for manager in Gcf.get_all_fig_managers():
        manager.show()
    import matplotlib
    matplotlib.interactive(True)
    if rcParams['tk.pythoninspect']:
        os.environ['PYTHONINSPECT'] = '1'
    if show._needmain:
        Tk.mainloop()
        show._needmain = False
show._needmain = True

def new_figure_manager(num, *args, **kwargs):
    """
    Create a new figure manager instance
    """
    _focus = windowing.FocusManager()
    FigureClass = kwargs.pop('FigureClass', Figure)
    figure = FigureClass(*args, **kwargs)
    window = Tk.Tk()
    canvas = FigureCanvasTkAgg(figure, master=window)
    figManager = FigureManagerTkAgg(canvas, num, window)
    if matplotlib.is_interactive():
        figManager.show()
    return figManager


class FigureCanvasTkAgg(FigureCanvasAgg):
    keyvald = {65507 : 'control',
               65505 : 'shift',
               65513 : 'alt',
               65508 : 'control',
               65506 : 'shift',
               65514 : 'alt',
               65361 : 'left',
               65362 : 'up',
               65363 : 'right',
               65364 : 'down',
               65307 : 'escape',
               65470 : 'f1',
               65471 : 'f2',
               65472 : 'f3',
               65473 : 'f4',
               65474 : 'f5',
               65475 : 'f6',
               65476 : 'f7',
               65477 : 'f8',
               65478 : 'f9',
               65479 : 'f10',
               65480 : 'f11',
               65481 : 'f12',
               65300 : 'scroll_lock',
               65299 : 'break',
               65288 : 'backspace',
               65293 : 'enter',
               65379 : 'insert',
               65535 : 'delete',
               65360 : 'home',
               65367 : 'end',
               65365 : 'pageup',
               65366 : 'pagedown',
               65438 : '0',
               65436 : '1',
               65433 : '2',
               65435 : '3',
               65430 : '4',
               65437 : '5',
               65432 : '6',
               65429 : '7',
               65431 : '8',
               65434 : '9',
               65451 : '+',
               65453 : '-',
               65450 : '*',
               65455 : '/',
               65439 : 'dec',
               65421 : 'enter',
               }

    def __init__(self, figure, master=None, resize_callback=None):
        FigureCanvasAgg.__init__(self, figure)
        self._idle = True
        t1,t2,w,h = self.figure.bbox.bounds
        w, h = int(w), int(h)
        self._tkcanvas = Tk.Canvas(
            master=master, width=w, height=h, borderwidth=4)
        self._tkphoto = Tk.PhotoImage(
            master=self._tkcanvas, width=w, height=h)
        self._tkcanvas.create_image(w/2, h/2, image=self._tkphoto)
        self._resize_callback = resize_callback
        self._tkcanvas.bind("&lt;Configure>", self.resize)
        self._tkcanvas.bind("&lt;Key>", self.key_press)
        self._tkcanvas.bind("&lt;Motion>", self.motion_notify_event)
        self._tkcanvas.bind("&lt;KeyRelease>", self.key_release)
        for name in "&lt;Button-1>", "&lt;Button-2>", "&lt;Button-3>":
            self._tkcanvas.bind(name, self.button_press_event)
        for name in "&lt;ButtonRelease-1>", "&lt;ButtonRelease-2>", "&lt;ButtonRelease-3>":
            self._tkcanvas.bind(name, self.button_release_event)

        # Mouse wheel on Linux generates button 4/5 events
        for name in "&lt;Button-4>", "&lt;Button-5>":
            self._tkcanvas.bind(name, self.scroll_event)
        # Mouse wheel for windows goes to the window with the focus.
        # Since the canvas won't usually have the focus, bind the
        # event to the window containing the canvas instead.
        # See http://wiki.tcl.tk/3893 (mousewheel) for details
        root = self._tkcanvas.winfo_toplevel()
        root.bind("&lt;MouseWheel>", self.scroll_event_windows)

        self._master = master
        self._tkcanvas.focus_set()

        # a dict from func-> cbook.Scheduler threads
        self.sourced = dict()

        # call the idle handler
        def on_idle(*ignore):
            self.idle_event()
            return True

        # disable until you figure out how to handle threads and interrupts
        #t = cbook.Idle(on_idle)
        #self._tkcanvas.after_idle(lambda *ignore: t.start())

    def resize(self, event):
        width, height = event.width, event.height
        if self._resize_callback is not None:
            self._resize_callback(event)

        # compute desired figure size in inches
	dpival = self.figure.dpi
        winch = width/dpival
        hinch = height/dpival
        self.figure.set_size_inches(winch, hinch)


        self._tkcanvas.delete(self._tkphoto)
        self._tkphoto = Tk.PhotoImage(
            master=self._tkcanvas, width=width, height=height)
        self._tkcanvas.create_image(width/2,height/2,image=self._tkphoto)
        self.resize_event()
        self.show()

    def draw(self):
        FigureCanvasAgg.draw(self)
        tkagg.blit(self._tkphoto, self.renderer._renderer, colormode=2)
        self._master.update_idletasks()

    def blit(self, bbox=None):
        tkagg.blit(self._tkphoto, self.renderer._renderer, bbox=bbox, colormode=2)
        self._master.update_idletasks()

    show = draw

    def draw_idle(self):
        'update drawing area only if idle'
        d = self._idle
        self._idle = False
        def idle_draw(*args):
            self.draw()
            self._idle = True

        if d: self._tkcanvas.after_idle(idle_draw)

    def get_tk_widget(self):
        """returns the Tk widget used to implement FigureCanvasTkAgg.
        Although the initial implementation uses a Tk canvas,  this routine
        is intended to hide that fact.
        """
        return self._tkcanvas

    def motion_notify_event(self, event):
        x = event.x
        # flipy so y=0 is bottom of canvas
        y = self.figure.bbox.height - event.y
        FigureCanvasBase.motion_notify_event(self, x, y, guiEvent=event)


    def button_press_event(self, event):
        x = event.x
        # flipy so y=0 is bottom of canvas
        y = self.figure.bbox.height - event.y
        num = getattr(event, 'num', None)

        if sys.platform=='darwin':
            # 2 and 3 were reversed on the OSX platform I
            # tested under tkagg
            if   num==2: num=3
            elif num==3: num=2

        FigureCanvasBase.button_press_event(self, x, y, num, guiEvent=event)

    def button_release_event(self, event):
        x = event.x
        # flipy so y=0 is bottom of canvas
        y = self.figure.bbox.height - event.y

        num = getattr(event, 'num', None)

        if sys.platform=='darwin':
            # 2 and 3 were reversed on the OSX platform I
            # tested under tkagg
            if   num==2: num=3
            elif num==3: num=2

        FigureCanvasBase.button_release_event(self, x, y, num, guiEvent=event)

    def scroll_event(self, event):
        x = event.x
        y = self.figure.bbox.height - event.y
        num = getattr(event, 'num', None)
        if   num==4: step = -1
        elif num==5: step = +1
        else:        step =  0

        FigureCanvasBase.scroll_event(self, x, y, step, guiEvent=event)

    def scroll_event_windows(self, event):
        """MouseWheel event processor"""
        # need to find the window that contains the mouse
        w = event.widget.winfo_containing(event.x_root, event.y_root)
        if w == self._tkcanvas:
            x = event.x_root - w.winfo_rootx()
            y = event.y_root - w.winfo_rooty()
            y = self.figure.bbox.height - y
            step = event.delta/120.
            FigureCanvasBase.scroll_event(self, x, y, step, guiEvent=event)

    def _get_key(self, event):
        val = event.keysym_num
        if val in self.keyvald:
            key = self.keyvald[val]
        elif val&lt;256:
            key = chr(val)
        else:
            key = None
        return key


    def key_press(self, event):
        key = self._get_key(event)
        FigureCanvasBase.key_press_event(self, key, guiEvent=event)

    def key_release(self, event):
        key = self._get_key(event)
        FigureCanvasBase.key_release_event(self, key, guiEvent=event)

    def flush_events(self):
        self._master.update()

    def start_event_loop(self,timeout):
        FigureCanvasBase.start_event_loop_default(self,timeout)
    start_event_loop.__doc__=FigureCanvasBase.start_event_loop_default.__doc__

    def stop_event_loop(self):
        FigureCanvasBase.stop_event_loop_default(self)
    stop_event_loop.__doc__=FigureCanvasBase.stop_event_loop_default.__doc__

class FigureManagerTkAgg(FigureManagerBase):
    """
    Public attributes

    canvas      : The FigureCanvas instance
    num         : The Figure number
    toolbar     : The tk.Toolbar
    window      : The tk.Window
    """
    def __init__(self, canvas, num, window):
        FigureManagerBase.__init__(self, canvas, num)
        self.window = window
        self.window.withdraw()
        self.window.wm_title("Figure %d" % num)
        self.canvas = canvas
        self._num =  num
        t1,t2,w,h = canvas.figure.bbox.bounds
        w, h = int(w), int(h)
        self.window.minsize(int(w*3/4),int(h*3/4))
        if matplotlib.rcParams['toolbar']=='classic':
            self.toolbar = NavigationToolbar( canvas, self.window )
        elif matplotlib.rcParams['toolbar']=='toolbar2':
            self.toolbar = NavigationToolbar2TkAgg( canvas, self.window )
        else:
            self.toolbar = None
        if self.toolbar is not None:
            self.toolbar.update()
        self.canvas._tkcanvas.pack(side=Tk.TOP, fill=Tk.BOTH, expand=1)
        self._shown = False

        def notify_axes_change(fig):
            'this will be called whenever the current axes is changed'
            if self.toolbar != None: self.toolbar.update()
        self.canvas.figure.add_axobserver(notify_axes_change)



        # attach a show method to the figure for pylab ease of use
        self.canvas.figure.show = lambda *args: self.show()


    def resize(self, event):
        width, height = event.width, event.height
        self.toolbar.configure(width=width) # , height=height)


    def show(self):
        """
        this function doesn't segfault but causes the
        PyEval_RestoreThread: NULL state bug on win32
        """

        def destroy(*args):
            self.window = None
            Gcf.destroy(self._num)

        if not self._shown: self.canvas._tkcanvas.bind("&lt;Destroy>", destroy)
        _focus = windowing.FocusManager()
        if not self._shown:
            self.window.deiconify()
            # anim.py requires this
            if sys.platform=='win32' : self.window.update()
        else:
            self.canvas.draw()
        self._shown = True


    def destroy(self, *args):
        if Gcf.get_num_fig_managers()==0 and not matplotlib.is_interactive():
            if self.window is not None:
                self.window.quit()
        if self.window is not None:
            #self.toolbar.destroy()
            self.window.destroy()

            pass
        self.window = None

    def set_window_title(self, title):
        self.window.wm_title(title)

class AxisMenu:
    def __init__(self, master, naxes):
        self._master = master
        self._naxes = naxes
        self._mbar = Tk.Frame(master=master, relief=Tk.RAISED, borderwidth=2)
        self._mbar.pack(side=Tk.LEFT)
        self._mbutton = Tk.Menubutton(
            master=self._mbar, text="Axes", underline=0)
        self._mbutton.pack(side=Tk.LEFT, padx="2m")
        self._mbutton.menu = Tk.Menu(self._mbutton)
        self._mbutton.menu.add_command(
            label="Select All", command=self.select_all)
        self._mbutton.menu.add_command(
            label="Invert All", command=self.invert_all)
        self._axis_var = []
        self._checkbutton = []
        for i in range(naxes):
            self._axis_var.append(Tk.IntVar())
            self._axis_var[i].set(1)
            self._checkbutton.append(self._mbutton.menu.add_checkbutton(
                label = "Axis %d" % (i+1),
                variable=self._axis_var[i],
                command=self.set_active))
            self._mbutton.menu.invoke(self._mbutton.menu.index("Select All"))
        self._mbutton['menu'] = self._mbutton.menu
        self._mbar.tk_menuBar(self._mbutton)
        self.set_active()

    def adjust(self, naxes):
        if self._naxes &lt; naxes:
            for i in range(self._naxes, naxes):
                self._axis_var.append(Tk.IntVar())
                self._axis_var[i].set(1)
                self._checkbutton.append( self._mbutton.menu.add_checkbutton(
                    label = "Axis %d" % (i+1),
                    variable=self._axis_var[i],
                    command=self.set_active))
        elif self._naxes > naxes:
            for i in range(self._naxes-1, naxes-1, -1):
                del self._axis_var[i]
                self._mbutton.menu.forget(self._checkbutton[i])
                del self._checkbutton[i]
        self._naxes = naxes
        self.set_active()

    def get_indices(self):
        a = [i for i in range(len(self._axis_var)) if self._axis_var[i].get()]
        return a

    def set_active(self):
        self._master.set_active(self.get_indices())

    def invert_all(self):
        for a in self._axis_var:
            a.set(not a.get())
        self.set_active()

    def select_all(self):
        for a in self._axis_var:
            a.set(1)
        self.set_active()

class NavigationToolbar(Tk.Frame):
    """
    Public attriubutes

      canvas   - the FigureCanvas  (gtk.DrawingArea)
      win   - the gtk.Window

    """
    def _Button(self, text, file, command):
        file = os.path.join(rcParams['datapath'], 'images', file)
        im = Tk.PhotoImage(master=self, file=file)
        b = Tk.Button(
            master=self, text=text, padx=2, pady=2, image=im, command=command)
        b._ntimage = im
        b.pack(side=Tk.LEFT)
        return b

    def __init__(self, canvas, window):
        self.canvas = canvas
        self.window = window

        xmin, xmax = canvas.figure.bbox.intervalx
        height, width = 50, xmax-xmin
        Tk.Frame.__init__(self, master=self.window,
                          width=width, height=height,
                          borderwidth=2)

        self.update()  # Make axes menu

        self.bLeft = self._Button(
            text="Left", file="stock_left.ppm",
            command=lambda x=-1: self.panx(x))

        self.bRight = self._Button(
            text="Right", file="stock_right.ppm",
            command=lambda x=1: self.panx(x))

        self.bZoomInX = self._Button(
            text="ZoomInX",file="stock_zoom-in.ppm",
            command=lambda x=1: self.zoomx(x))

        self.bZoomOutX = self._Button(
            text="ZoomOutX", file="stock_zoom-out.ppm",
            command=lambda x=-1: self.zoomx(x))

        self.bUp = self._Button(
            text="Up", file="stock_up.ppm",
            command=lambda y=1: self.pany(y))

        self.bDown = self._Button(
            text="Down", file="stock_down.ppm",
            command=lambda y=-1: self.pany(y))

        self.bZoomInY = self._Button(
            text="ZoomInY", file="stock_zoom-in.ppm",
            command=lambda y=1: self.zoomy(y))

        self.bZoomOutY = self._Button(
            text="ZoomOutY",file="stock_zoom-out.ppm",
            command=lambda y=-1: self.zoomy(y))

        self.bSave = self._Button(
            text="Save", file="stock_save_as.ppm",
            command=self.save_figure)

        self.pack(side=Tk.BOTTOM, fill=Tk.X)


    def set_active(self, ind):
        self._ind = ind
        self._active = [ self._axes[i] for i in self._ind ]

    def panx(self, direction):
        for a in self._active:
            a.xaxis.pan(direction)
        self.canvas.draw()

    def pany(self, direction):
        for a in self._active:
            a.yaxis.pan(direction)
        self.canvas.draw()

    def zoomx(self, direction):

        for a in self._active:
            a.xaxis.zoom(direction)
        self.canvas.draw()

    def zoomy(self, direction):

        for a in self._active:
            a.yaxis.zoom(direction)
        self.canvas.draw()

    def save_figure(self):
        fs = FileDialog.SaveFileDialog(master=self.window,
                                       title='Save the figure')
        try:
            self.lastDir
        except AttributeError:
            self.lastDir = os.curdir

        fname = fs.go(dir_or_file=self.lastDir) # , pattern="*.png")
        if fname is None: # Cancel
            return

        self.lastDir = os.path.dirname(fname)
        try:
            self.canvas.print_figure(fname)
        except IOError, msg:
            err = '\n'.join(map(str, msg))
            msg = 'Failed to save %s: Error msg was\n\n%s' % (
                fname, err)
            error_msg_tkpaint(msg)

    def update(self):
        _focus = windowing.FocusManager()
        self._axes = self.canvas.figure.axes
        naxes = len(self._axes)
        if not hasattr(self, "omenu"):
            self.set_active(range(naxes))
            self.omenu = AxisMenu(master=self, naxes=naxes)
        else:
            self.omenu.adjust(naxes)

class NavigationToolbar2TkAgg(NavigationToolbar2, Tk.Frame):
    """
    Public attriubutes

      canvas   - the FigureCanvas  (gtk.DrawingArea)
      win   - the gtk.Window
    """
    def __init__(self, canvas, window):
        self.canvas = canvas
        self.window = window
        self._idle = True
        #Tk.Frame.__init__(self, master=self.canvas._tkcanvas)
        NavigationToolbar2.__init__(self, canvas)

    def destroy(self, *args):
        del self.message
        Tk.Frame.destroy(self, *args)

    def set_message(self, s):
        self.message.set(s)

    def draw_rubberband(self, event, x0, y0, x1, y1):
        height = self.canvas.figure.bbox.height
        y0 =  height-y0
        y1 =  height-y1
        try: self.lastrect
        except AttributeError: pass
        else: self.canvas._tkcanvas.delete(self.lastrect)
        self.lastrect = self.canvas._tkcanvas.create_rectangle(x0, y0, x1, y1)

        #self.canvas.draw()

    def release(self, event):
        try: self.lastrect
        except AttributeError: pass
        else:
            self.canvas._tkcanvas.delete(self.lastrect)
            del self.lastrect

    def set_cursor(self, cursor):
        self.window.configure(cursor=cursord[cursor])

    def _Button(self, text, file, command):
        file = os.path.join(rcParams['datapath'], 'images', file)
        im = Tk.PhotoImage(master=self, file=file)
        b = Tk.Button(
            master=self, text=text, padx=2, pady=2, image=im, command=command)
        b._ntimage = im
        b.pack(side=Tk.LEFT)
        return b

    def _init_toolbar(self):
        xmin, xmax = self.canvas.figure.bbox.intervalx
        height, width = 50, xmax-xmin
        Tk.Frame.__init__(self, master=self.window,
                          width=width, height=height,
                          borderwidth=2)

        self.update()  # Make axes menu

        self.bHome = self._Button( text="Home", file="home.ppm",
                                   command=self.home)

        self.bBack = self._Button( text="Back", file="back.ppm",
                                   command = self.back)

        self.bForward = self._Button(text="Forward", file="forward.ppm",
                                     command = self.forward)

        self.bPan = self._Button( text="Pan", file="move.ppm",
                                  command = self.pan)

        self.bZoom = self._Button( text="Zoom",
                                   file="zoom_to_rect.ppm",
                                   command = self.zoom)

        self.bsubplot = self._Button( text="Configure Subplots", file="subplots.ppm",
                                   command = self.configure_subplots)

        self.bsave = self._Button( text="Save", file="filesave.ppm",
                                   command = self.save_figure)
        self.message = Tk.StringVar(master=self)
        self._message_label = Tk.Label(master=self, textvariable=self.message)
        self._message_label.pack(side=Tk.RIGHT)
        self.pack(side=Tk.BOTTOM, fill=Tk.X)


    def configure_subplots(self):
        toolfig = Figure(figsize=(6,3))
        window = Tk.Tk()
        canvas = FigureCanvasTkAgg(toolfig, master=window)
        toolfig.subplots_adjust(top=0.9)
        tool =  SubplotTool(self.canvas.figure, toolfig)
        canvas.show()
        canvas.get_tk_widget().pack(side=Tk.TOP, fill=Tk.BOTH, expand=1)

    def save_figure(self):
        from tkFileDialog import asksaveasfilename
        from tkMessageBox import showerror
        filetypes = self.canvas.get_supported_filetypes().copy()
        default_filetype = self.canvas.get_default_filetype()

        # Tk doesn't provide a way to choose a default filetype,
        # so we just have to put it first
        default_filetype_name = filetypes[default_filetype]
        del filetypes[default_filetype]

        sorted_filetypes = filetypes.items()
        sorted_filetypes.sort()
        sorted_filetypes.insert(0, (default_filetype, default_filetype_name))

        tk_filetypes = [
            (name, '*.%s' % ext) for (ext, name) in sorted_filetypes]

        fname = asksaveasfilename(
            master=self.window,
            title='Save the figure',
            filetypes = tk_filetypes,
            defaultextension = self.canvas.get_default_filetype()
            )

        if fname == "" or fname == ():
            return
        else:
            try:
                # This method will handle the delegation to the correct type
                self.canvas.print_figure(fname)
            except Exception, e:
                showerror("Error saving file", str(e))

    def set_active(self, ind):
        self._ind = ind
        self._active = [ self._axes[i] for i in self._ind ]

    def update(self):
        _focus = windowing.FocusManager()
        self._axes = self.canvas.figure.axes
        naxes = len(self._axes)
        #if not hasattr(self, "omenu"):
        #    self.set_active(range(naxes))
        #    self.omenu = AxisMenu(master=self, naxes=naxes)
        #else:
        #    self.omenu.adjust(naxes)
        NavigationToolbar2.update(self)

    def dynamic_update(self):
        'update drawing area only if idle'
        # legacy method; new method is canvas.draw_idle
        self.canvas.draw_idle()


FigureManager = FigureManagerTkAgg

</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">agpl-3.0</span></div></div>
							</td>
					</tr><tr class="group cursor-pointer space-x-4 divide-x border-b outline-offset-[-2px] odd:bg-gray-50 hover:bg-gray-100 dark:odd:bg-gray-925 dark:hover:bg-gray-850  last:border-none" tabindex="0" data-row-idx="15"><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">mhoffman/kmos</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">kmos/cli.py</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">1</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">16514</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">#!/usr/bin/env python
"""Entry point module for the command-line
   interface. The kmos executable should be
   on the program path, import this modules
   main function and run it.

   To call kmos command as you would from the shell,
   use ::

       kmos.cli.main('...')

   Every command can be shortened as long as it is non-ambiguous, e.g. ::


    kmos ex &lt;xml-file>

   instead of ::

    kmos export &lt;xml-file>


   etc.

"""

#    Copyright 2009-2013 Max J. Hoffmann (mjhoffmann@gmail.com)
#    This file is part of kmos.
#
#    kmos is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    kmos is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with kmos.  If not, see &lt;http://www.gnu.org/licenses/>.

from __future__ import with_statement
import os
import shutil

usage = {}
usage['all'] = """kmos help all
    Display documentation for all commands.
                """
usage['benchmark'] = """kmos benchmark
    Run 1 mio. kMC steps on model in current directory
    and report runtime.
                     """

usage['build'] = """kmos build
    Build kmc_model.%s from *f90 files in the
    current directory.

    Additional Parameters ::
        -d/--debug
            Turn on assertion statements in F90 code

        -n/--no-compiler-optimization
            Do not send optimizing flags to compiler.
                 """ % ('pyd' if os.name == 'nt' else 'so')

usage['help'] = """kmos help &lt;command>
    Print usage information for the given command.
                """

usage['export'] = """kmos export &lt;xml-file> [&lt;export-path>]
    Take a kmos xml-file and export all generated
    source code to the export-path. There try to
    build the kmc_model.%s.

    Additional Parameters ::

        -s/--source-only
            Export source only and don't build binary

        -b/--backend (local_smart|lat_int)
            Choose backend. Default is "local_smart".
            lat_int is EXPERIMENTAL and not made
            for production, yet.

        -d/--debug
            Turn on assertion statements in F90 code.
            (Only active in compile step)

           --acf
            Build the modules base_acf.f90 and proclist_acf.f90. Default is false.
            This both modules contain functions to calculate ACF (autocorrelation function) and MSD (mean squared displacement). 
            
        -n/--no-compiler-optimization
            Do not send optimizing flags to compiler.
                    """ % ('pyd' if os.name == 'nt' else 'so')
          
usage['settings-export'] = """kmos settings-export &lt;xml-file> [&lt;export-path>]
    Take a kmos xml-file and export kmc_settings.py
    to the export-path.
                    """

usage['edit'] = """kmos edit &lt;xml-file>
    Open the kmos xml-file in a GUI to edit
    the model.
                """

usage['import'] = """kmos import &lt;xml-file>
    Take a kmos xml-file and open an ipython shell
    with the project_tree imported as pt.
                  """
usage['rebuild'] = """kmos rebuild
    Export code and rebuild binary module from XML
    information included in kmc_settings.py in
    current directory.

    Additional Parameters ::
        -d/--debug
            Turn on assertion statements in F90 code
                    """

usage['shell'] = """kmos shell
    Open an interactive shell and create a KMC_Model in it
               run == shell
               """
usage['run'] = """kmos run
    Open an interactive shell and create a KMC_Model in it
               run == shell
               """

usage['version'] = """kmos version
    Print version number and exit.
                   """

usage['view'] = """kmos view
    Take a kmc_model.%s and kmc_settings.py in the
    same directory and start to simulate the
    model visually.

    Additional Parameters ::
        -v/--steps-per-frame &lt;number>
            Number of steps per frame

                 """ % ('pyd' if os.name == 'nt' else 'so')

usage['xml'] = """kmos xml
    Print xml representation of model to stdout
               """


def get_options(args=None, get_parser=False):
    import optparse
    import os
    from glob import glob
    import kmos

    parser = optparse.OptionParser(
        'Usage: %prog [help] ('
        + '|'.join(sorted(usage.keys()))
        + ') [options]',
        version=kmos.__version__)

    parser.add_option('-s', '--source-only',
                      dest='source_only',
                      action='store_true',
                      default=False)

    parser.add_option('-p', '--path-to-f2py',
                      dest='path_to_f2py',
                      default='f2py')

    parser.add_option('-b', '--backend',
                      dest='backend',
                      default='local_smart')
    parser.add_option('-a', '--avoid-default-state',
                      dest='avoid_default_state',
                      action='store_true',
                      default=False,
                      )

    parser.add_option('-v', '--steps-per-frame',
                      dest='steps_per_frame',
                      type='int',
                      default='50000')

    parser.add_option('-d', '--debug',
                      default=False,
                      dest='debug',
                      action='store_true')

    parser.add_option('-n', '--no-compiler-optimization',
                      default=False,
                      dest='no_optimize',
                      action='store_true')

    parser.add_option('-o', '--overwrite',
                      default=False,
                      action='store_true')

    parser.add_option('-l', '--variable-length',
                      dest='variable_length',
                      default=95,
                      type='int')

    parser.add_option('-c', '--catmap',
                      default=False,
                      action='store_true')
    
    parser.add_option('--acf',
                      dest='acf',
                      action='store_true',
                      default=False,
                      )
   
    try:
        from numpy.distutils.fcompiler import get_default_fcompiler
        from numpy.distutils import log
        log.set_verbosity(-1, True)
        fcompiler = get_default_fcompiler()
    except:
        fcompiler = 'gfortran'

    parser.add_option('-f', '--fcompiler',
                      dest='fcompiler',
                      default=os.environ.get('F2PY_FCOMPILER', fcompiler))

    if args is not None:
        options, args = parser.parse_args(args.split())
    else:
        options, args = parser.parse_args()
    if len(args) &lt; 1:
        parser.error('Command expected')
    if get_parser:
        return options, args, parser
    else:
        return options, args


def match_keys(arg, usage, parser):
    """Try to match part of a command against
       the set of commands from usage. Throws
       an error if not successful.

    """
    possible_args = [key for key in usage if key.startswith(arg)]
    if len(possible_args) == 0:
        parser.error('Command "%s" not understood.' % arg)
    elif len(possible_args) > 1:
        parser.error(('Command "%s" ambiguous.\n'
                      'Could be one of %s\n\n') % (arg, possible_args))
    else:
        return possible_args[0]


def main(args=None):
    """The CLI main entry point function.

    The optional argument args, can be used to
    directly supply command line argument like

    $ kmos &lt;args>

    otherwise args will be taken from STDIN.

    """

    from glob import glob

    options, args, parser = get_options(args, get_parser=True)

    global model, pt, np, cm_model

    if not args[0] in usage.keys():
        args[0] = match_keys(args[0], usage, parser)

    if args[0] == 'benchmark':
        from sys import path
        path.append(os.path.abspath(os.curdir))
        nsteps = 1000000
        from time import time
        from kmos.run import KMC_Model
        model = KMC_Model(print_rates=False, banner=False)
        time0 = time()
        try:
            model.proclist.do_kmc_steps(nsteps)
        except:  # kmos &lt; 0.3 had no model.proclist.do_kmc_steps
            model.do_steps(nsteps)

        needed_time = time() - time0
        print('Using the [%s] backend.' % model.get_backend())
        print('%s steps took %.2f seconds' % (nsteps, needed_time))
        print('Or %.2e steps/s' % (1e6 / needed_time))
        model.deallocate()
    elif args[0] == 'build':
        from kmos.utils import build
        build(options)
    elif args[0] == 'edit':
        from kmos import gui
        gui.main()
    elif args[0] == 'settings-export':
        import kmos.types
        import kmos.io
        from kmos.io import ProcListWriter

        if len(args) &lt; 2:
            parser.error('XML file and export path expected.')
        if len(args) &lt; 3:
            out_dir = '%s_%s' % (os.path.splitext(args[1])[0], options.backend)
            print('No export path provided. Exporting to %s' % out_dir)
            args.append(out_dir)

        xml_file = args[1]
        export_dir = args[2]
        project = kmos.types.Project()
        project.import_file(xml_file)

        writer = ProcListWriter(project, export_dir)
        writer.write_settings()

    elif args[0] == 'export':
        import kmos.types
        import kmos.io
        from kmos.utils import build
        if len(args) &lt; 2:
            parser.error('XML file and export path expected.')
        if len(args) &lt; 3:
            out_dir = '%s_%s' % (os.path.splitext(args[1])[0], options.backend)

            print('No export path provided. Exporting to %s' % out_dir)
            args.append(out_dir)

        xml_file = args[1]
        export_dir = os.path.join(args[2], 'src')

        project = kmos.types.Project()
        project.import_file(xml_file)

        project.shorten_names(max_length=options.variable_length)

        kmos.io.export_source(project,
                              export_dir,
                              options=options)

        if ((os.name == 'posix'
           and os.uname()[0] in ['Linux', 'Darwin'])
           or os.name == 'nt') \
           and not options.source_only:
            os.chdir(export_dir)
            build(options)
            for out in glob('kmc_*'):
                if os.path.exists('../%s' % out) :
                    if options.overwrite :
                        overwrite = 'y'
                    else:
                        overwrite = raw_input(('Should I overwrite existing %s ?'
                                               '[y/N]  ') % out).lower()
                    if overwrite.startswith('y') :
                        print('Overwriting {out}'.format(**locals()))
                        os.remove('../%s' % out)
                        shutil.move(out, '..')
                    else :
                        print('Skipping {out}'.format(**locals()))
                else:
                    shutil.move(out, '..')

    elif args[0] == 'settings-export':
        import kmos.io
        pt = kmos.io.import_file(args[1])
        if len(args) &lt; 3:
            out_dir = os.path.splitext(args[1])[0]
            print('No export path provided. Exporting kmc_settings.py to %s'
                  % out_dir)
            args.append(out_dir)

        if not os.path.exists(args[2]):
            os.mkdir(args[2])
        elif not os.path.isdir(args[2]):
            raise UserWarning("Cannot overwrite %s; Exiting;" % args[2])
        writer = kmos.io.ProcListWriter(pt, args[2])
        writer.write_settings()

    elif args[0] == 'help':
        if len(args) &lt; 2:
            parser.error('Which help do you  want?')
        if args[1] == 'all':
            for command in sorted(usage):
                print(usage[command])
        elif args[1] in usage:
            print('Usage: %s\n' % usage[args[1]])
        else:
            arg = match_keys(args[1], usage, parser)
            print('Usage: %s\n' % usage[arg])

    elif args[0] == 'import':
        import kmos.io
        if not len(args) >= 2:
            raise UserWarning('XML file name expected.')
        pt = kmos.io.import_xml_file(args[1])
        if len(args) == 2:
            sh(banner='Note: pt = kmos.io.import_xml(\'%s\')' % args[1])
        elif len(args) == 3: # if optional 3rd argument is given, store model there and exit
            pt.save(args[2])

    elif args[0] == 'rebuild':
        from time import sleep
        print('Will rebuild model from kmc_settings.py in current directory')
        print('Please do not interrupt,'
              ' build process, as you will most likely')
        print('loose the current model files.')
        sleep(2.)
        from sys import path
        path.append(os.path.abspath(os.curdir))
        from tempfile import mktemp
        if not os.path.exists('kmc_model.so') \
           and not os.path.exists('kmc_model.pyd'):
            raise Exception('No kmc_model.so found.')
        if not os.path.exists('kmc_settings.py'):
            raise Exception('No kmc_settings.py found.')

        from kmos.run import KMC_Model

        model = KMC_Model(print_rates=False, banner=False)
        tempfile = mktemp()
        f = file(tempfile, 'w')
        f.write(model.xml())
        f.close()

        for kmc_model in glob('kmc_model.*'):
            os.remove(kmc_model)
        os.remove('kmc_settings.py')
        main('export %s -b %s .' % (tempfile, options.backend))
        os.remove(tempfile)
        model.deallocate()

    elif args[0] in ['run', 'shell']:
        from sys import path
        path.append(os.path.abspath(os.curdir))
        from kmos.run import KMC_Model

        # useful to have in interactive mode
        import numpy as np
        try:
            from matplotlib import pyplot as plt
        except:
            plt = None

        if options.catmap:
            import catmap
            import catmap.cli.kmc_runner
            seed = catmap.cli.kmc_runner.get_seed_from_path('.')
            cm_model = catmap.ReactionModel(setup_file='{seed}.mkm'.format(**locals()))
            catmap_message = '\nSide-loaded catmap_model {seed}.mkm into cm_model = ReactionModel(setup_file="{seed}.mkm")'.format(**locals())
        else:
            catmap_message = ''

        try:
            model = KMC_Model(print_rates=False)
        except:
            print("Warning: could not import kmc_model!"
                  " Please make sure you are in the right directory")
        sh(banner='Note: model = KMC_Model(print_rates=False){catmap_message}'.format(**locals()))
        try:
            model.deallocate()
        except:
            print("Warning: could not deallocate model. Was is allocated?")

    elif args[0] == 'version':
        from kmos import VERSION
        print(VERSION)

    elif args[0] == 'view':
        from sys import path
        path.append(os.path.abspath(os.curdir))
        from kmos import view
        view.main(steps_per_frame=options.steps_per_frame)

    elif args[0] == 'xml':
        from sys import path
        path.append(os.path.abspath(os.curdir))
        from kmos.run import KMC_Model
        model = KMC_Model(banner=False, print_rates=False)
        print(model.xml())

    else:
        parser.error('Command "%s" not understood.' % args[0])


def sh(banner):
    """Wrapper around interactive ipython shell
    that factors out ipython version depencies.

    """

    from distutils.version import LooseVersion
    import IPython
    if hasattr(IPython, 'release'):
        try:
            from IPython.terminal.embed import InteractiveShellEmbed
            InteractiveShellEmbed(banner1=banner)()

        except ImportError:
            try:
                from IPython.frontend.terminal.embed \
                    import InteractiveShellEmbed
                InteractiveShellEmbed(banner1=banner)()

            except ImportError:
                from IPython.Shell import IPShellEmbed
                IPShellEmbed(banner=banner)()
    else:
        from IPython.Shell import IPShellEmbed
        IPShellEmbed(banner=banner)()
</span></div></div>
							</td><td class="min-w-fit max-w-sm break-words p-2 "><div class="line-clamp-2 "><div class="" dir="auto"><span class="">gpl-3.0</span></div></div>
							</td>
					</tr></tbody></table>
		<div class="bg-linear-to-b sticky left-0 border-t border-dashed border-gray-300 from-gray-100 to-white py-3 text-center font-mono text-xs dark:border-gray-700 dark:from-gray-950 dark:to-gray-900">End of preview. <a href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation" class="group"><span class="underline decoration-gray-300 group-hover:decoration-gray-400 dark:decoration-gray-500 dark:group-hover:decoration-gray-300">Expand</span>
						in <svg class="text-lg mr-0.5 inline -translate-y-px text-red-500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill="currentColor" d="M2.5 2h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1Zm0 2v2h3V4h-3Zm4 0v2h3V4h-3Zm-4 3v2h3V7h-3Zm4 0v2h3V7h-3Z"></path></svg>Data Studio
					</a></div></div>




			<div class="bg-linear-to-b from-gray-100 to-white dark:from-gray-950 dark:to-gray-900 "><hr class="flex-none -translate-y-px border-t border-dashed border-gray-300 bg-white dark:border-gray-700 dark:bg-gray-950">
					<nav><ul class="flex select-none items-center justify-between space-x-2 text-gray-700 sm:justify-center py-1 text-center font-mono text-xs rounded-b-lg"><li><a class="flex items-center rounded-lg px-2.5 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 pointer-events-none cursor-default text-gray-400 hover:text-gray-700" href=""><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M10 16L20 6l1.4 1.4l-8.6 8.6l8.6 8.6L20 26z" fill="currentColor"></path></svg>
		Previous</a></li>
			<li class="hidden sm:block"><a class="rounded-lg px-2.5 py-1 bg-gray-50 font-semibold ring-1 ring-inset ring-gray-200 dark:bg-gray-900 dark:text-yellow-500 dark:ring-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800" href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation?p=0">1</a>
				</li><li class="hidden sm:block"><a class="rounded-lg px-2.5 py-1  hover:bg-gray-50 dark:hover:bg-gray-800" href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation?p=1">2</a>
				</li><li class="hidden sm:block"><a class="rounded-lg px-2.5 py-1  hover:bg-gray-50 dark:hover:bg-gray-800" href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation?p=2">3</a>
				</li><li class="hidden sm:block"><a class="rounded-lg px-2.5 py-1  pointer-events-none cursor-default" href="#">...</a>
				</li><li class="hidden sm:block"><a class="rounded-lg px-2.5 py-1  hover:bg-gray-50 dark:hover:bg-gray-800" href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation?p=33">34</a>
				</li>
			<li><a class="flex items-center rounded-lg px-2.5 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 " href="/datasets/huggingface-course/codeparrot-ds-valid/viewer/default/validation?p=1">Next
		<svg class="ml-1.5 transform rotate-180" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M10 16L20 6l1.4 1.4l-8.6 8.6l8.6 8.6L20 26z" fill="currentColor"></path></svg></a></li></ul></nav></div></div>






</div></div></div></div></div></div></div>

				<div class="from-gray-50-to-white bg-linear-to-t rounded-lg border border-dotted border-gray-200 py-24 text-center md:px-6"><p class="mb-1 mt-2">No dataset card yet</p>
						</div></section>
			
			<section class="pt-6 border-gray-100 md:pb-24 md:pl-6 md:w-64 lg:w-80 xl:w-96 flex-none order-first md:order-none md:border-l pt-3! md:pt-6!"><dl class="flex items-baseline justify-between"><dt class="text-sm text-gray-500">Downloads last month</dt><div class="mx-4 flex-1 border-b border-dotted"></div><dd class="font-semibold">1,404</dd></dl>
				
				<div class="divider-column-vertical"></div>
				<div class="grid grid-cols-2 gap-x-2 md:flex md:flex-row md:flex-wrap"><div class="SVELTE_HYDRATER contents" data-target="DatasetAndModelActionsDropdown" data-props="{&quot;classNames&quot;:&quot;order-last&quot;,&quot;discussionsDisabled&quot;:false,&quot;repo&quot;:{&quot;type&quot;:&quot;dataset&quot;,&quot;name&quot;:&quot;huggingface-course/codeparrot-ds-valid&quot;},&quot;canWrite&quot;:false,&quot;canDisable&quot;:false,&quot;repoIsPrivate&quot;:false,&quot;repoIsGated&quot;:false,&quot;repoIsDisabled&quot;:false,&quot;repoIsAdminFlaggedNFAA&quot;:false,&quot;repoHasBlockedOids&quot;:false}"><div class="order-last"><div class="relative ">
	<button class="btn px-1.5 py-1.5 " type="button">
		
			<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="p-0.5" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><circle cx="16" cy="7" r="3" fill="currentColor"></circle><circle cx="16" cy="16" r="3" fill="currentColor"></circle><circle cx="16" cy="25" r="3" fill="currentColor"></circle></svg>
		
		</button>
	
	
	</div></div>













</div>
					<div class="SVELTE_HYDRATER contents" data-target="DatasetLibrary" data-props="{&quot;classNames&quot;:&quot;md:w-full xl:w-auto xl:flex-none&quot;,&quot;libraries&quot;:[{&quot;language&quot;:&quot;python&quot;,&quot;library&quot;:&quot;datasets&quot;,&quot;function&quot;:&quot;load_dataset&quot;,&quot;loading_codes&quot;:[{&quot;config_name&quot;:&quot;default&quot;,&quot;arguments&quot;:{},&quot;code&quot;:&quot;from datasets import load_dataset\n\nds = load_dataset(\&quot;huggingface-course/codeparrot-ds-valid\&quot;)&quot;}]},{&quot;language&quot;:&quot;python&quot;,&quot;library&quot;:&quot;pandas&quot;,&quot;function&quot;:&quot;pd.read_json&quot;,&quot;loading_codes&quot;:[{&quot;config_name&quot;:&quot;default&quot;,&quot;arguments&quot;:{&quot;splits&quot;:{&quot;validation&quot;:&quot;codeparrot-ds-valid.jsonl&quot;},&quot;lines&quot;:true},&quot;code&quot;:&quot;import pandas as pd\n\ndf = pd.read_json(\&quot;hf://datasets/huggingface-course/codeparrot-ds-valid/codeparrot-ds-valid.jsonl\&quot;, lines=True)&quot;}]},{&quot;language&quot;:&quot;python&quot;,&quot;library&quot;:&quot;mlcroissant&quot;,&quot;function&quot;:&quot;Dataset&quot;,&quot;loading_codes&quot;:[{&quot;config_name&quot;:&quot;default&quot;,&quot;arguments&quot;:{&quot;record_set&quot;:&quot;default&quot;,&quot;partial&quot;:false},&quot;code&quot;:&quot;from mlcroissant import Dataset\n\nds = Dataset(jsonld=\&quot;https://huggingface.co/api/datasets/huggingface-course/codeparrot-ds-valid/croissant\&quot;)\nrecords = ds.records(\&quot;default\&quot;)&quot;}]},{&quot;language&quot;:&quot;python&quot;,&quot;library&quot;:&quot;polars&quot;,&quot;function&quot;:&quot;pl.read_ndjson&quot;,&quot;loading_codes&quot;:[{&quot;config_name&quot;:&quot;default&quot;,&quot;arguments&quot;:{&quot;splits&quot;:{&quot;validation&quot;:&quot;codeparrot-ds-valid.jsonl&quot;}},&quot;code&quot;:&quot;import polars as pl\n\ndf = pl.read_ndjson('hf://datasets/huggingface-course/codeparrot-ds-valid/codeparrot-ds-valid.jsonl')\n&quot;}]}]}"><div class="relative md:w-full xl:w-auto xl:flex-none">
	<button class="from-gray-800! to-black! max-xl:mb-2 text-white! gap-1! border-gray-800! dark:border-gray-900!  btn w-full cursor-pointer text-sm" type="button">
		<svg class="mr-1.5 mr-0.5! " xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" style="transform: rotate(360deg);"><path d="M31 16l-7 7l-1.41-1.41L28.17 16l-5.58-5.59L24 9l7 7z" fill="currentColor"></path><path d="M1 16l7-7l1.41 1.41L3.83 16l5.58 5.59L8 23l-7-7z" fill="currentColor"></path><path d="M12.419 25.484L17.639 6l1.932.518L14.35 26z" fill="currentColor"></path></svg>
			Use this dataset
		<svg class="-mr-1 text-gray-500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M16.293 9.293L12 13.586L7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z" fill="currentColor"></path></svg></button>
	
	
	</div>

</div>
					
					</div>
				<div class="divider-column-vertical"></div>
					<div class="flex flex-col flex-wrap xl:flex-row"><a class="bg-linear-to-r dark:via-none group mb-1.5 flex max-w-full flex-col overflow-hidden rounded-lg border border-gray-100 from-white via-white to-white px-2 py-1 hover:from-gray-50 dark:from-gray-900 dark:to-gray-925 dark:hover:to-gray-900 md:mr-1.5 pointer-events-none" rel="nofollow" target="_blank"><div class="truncate text-xs text-gray-400">Size of downloaded dataset files:</div>
		<div class="truncate text-sm ">
			<!-- HTML_TAG_START -->46.1 MB<!-- HTML_TAG_END --></div></a><a class="bg-linear-to-r dark:via-none group mb-1.5 flex max-w-full flex-col overflow-hidden rounded-lg border border-gray-100 from-white via-white to-white px-2 py-1 hover:from-gray-50 dark:from-gray-900 dark:to-gray-925 dark:hover:to-gray-900 md:mr-1.5 " href="/datasets/huggingface-course/codeparrot-ds-valid/tree/refs%2Fconvert%2Fparquet/" rel="nofollow" target="_blank"><div class="truncate text-xs text-gray-400">Size of the auto-converted Parquet files:</div>
		<div class="truncate text-sm group-hover:underline">
			<!-- HTML_TAG_START -->16.1 MB<!-- HTML_TAG_END --></div></a><a class="bg-linear-to-r dark:via-none group mb-1.5 flex max-w-full flex-col overflow-hidden rounded-lg border border-gray-100 from-white via-white to-white px-2 py-1 hover:from-gray-50 dark:from-gray-900 dark:to-gray-925 dark:hover:to-gray-900 md:mr-1.5 pointer-events-none" rel="nofollow" target="_blank"><div class="truncate text-xs text-gray-400">Number of rows:</div>
		<div class="truncate text-sm ">
			<!-- HTML_TAG_START -->3,322<!-- HTML_TAG_END --></div></a></div>
				
				
				<div class="divider-column-vertical"></div>
					<h2 class="text-smd mb-5 flex items-baseline overflow-hidden whitespace-nowrap font-semibold text-gray-800"><svg class="mr-1.5 text-sm inline self-center flex-none text-gray-400" style="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path class="uim-quaternary" d="M20.23 7.24L12 12L3.77 7.24a1.98 1.98 0 0 1 .7-.71L11 2.76c.62-.35 1.38-.35 2 0l6.53 3.77c.29.173.531.418.7.71z" opacity=".25" fill="currentColor"></path><path class="uim-tertiary" d="M12 12v9.5a2.09 2.09 0 0 1-.91-.21L4.5 17.48a2.003 2.003 0 0 1-1-1.73v-7.5a2.06 2.06 0 0 1 .27-1.01L12 12z" opacity=".5" fill="currentColor"></path><path class="uim-primary" d="M20.5 8.25v7.5a2.003 2.003 0 0 1-1 1.73l-6.62 3.82c-.275.13-.576.198-.88.2V12l8.23-4.76c.175.308.268.656.27 1.01z" fill="currentColor"></path></svg>
						Models trained or fine-tuned on
						<span class="ml-1 truncate font-mono text-[0.87rem] font-medium">huggingface-course/codeparrot-ds-valid</span></h2>

					<div class="space-y-3"><div class=""><article class="overview-card-wrapper group/repo  "><a class="flex items-center justify-between gap-4 p-2" href="/ashaduzzaman/gpt2-finetuned-codeparrot"><div class="w-full truncate"><header class="flex items-center mb-1" title="ashaduzzaman/gpt2-finetuned-codeparrot"><img alt="" class="w-3 h-3 rounded-full mr-1.5 flex-none flex-none" src="https://cdn-avatars.huggingface.co/v1/production/uploads/6655985674619891d8914c23/FWWW42d_BJ99A113bqsFO.jpeg" crossorigin="anonymous">
				<h4 class="text-md truncate font-mono text-black dark:group-hover/repo:text-yellow-500 group-hover/repo:text-indigo-600 text-sm">ashaduzzaman/gpt2-finetuned-codeparrot</h4>
				
				</header>
			<div class="mr-1 flex items-center overflow-hidden whitespace-nowrap text-sm leading-tight text-gray-400"><svg class="mr-1.5 text-[.8rem] flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 18 18"><path d="M16.2607 8.08202L14.468 6.28928C14.3063 6.12804 14.0873 6.03749 13.859 6.03749C13.6307 6.03749 13.4117 6.12804 13.25 6.28928L5.6375 13.904V16.9125H8.64607L16.2607 9.30002C16.422 9.13836 16.5125 8.91935 16.5125 8.69102C16.5125 8.4627 16.422 8.24369 16.2607 8.08202V8.08202ZM8.1953 15.825H6.725V14.3547L11.858 9.22118L13.3288 10.6915L8.1953 15.825ZM14.0982 9.92262L12.6279 8.45232L13.8606 7.21964L15.3309 8.68994L14.0982 9.92262Z"></path><path d="M6.18125 9.84373H7.26875V6.03748H8.9V4.94998H4.55V6.03748H6.18125V9.84373Z"></path><path d="M4.55 11.475H2.375V2.775H11.075V4.95H12.1625V2.775C12.1625 2.48658 12.0479 2.20997 11.844 2.00602C11.64 1.80208 11.3634 1.6875 11.075 1.6875H2.375C2.08658 1.6875 1.80997 1.80208 1.60602 2.00602C1.40207 2.20997 1.2875 2.48658 1.2875 2.775V11.475C1.2875 11.7634 1.40207 12.04 1.60602 12.244C1.80997 12.4479 2.08658 12.5625 2.375 12.5625H4.55V11.475Z"></path></svg>
			Text Generation
			<span class="px-1.5 text-gray-300 dark:text-gray-500">â€¢ </span>
	
				<span class="truncate">Updated
					<time datetime="2024-08-24T19:16:38" title="Sat, 24 Aug 2024 19:16:38 GMT">Aug 24, 2024</time></span>
				
				<span class="px-1.5 text-gray-300 dark:text-gray-500">â€¢ </span>
					<svg class="flex-none w-3 text-gray-400 mr-0.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M26 24v4H6v-4H4v4a2 2 0 0 0 2 2h20a2 2 0 0 0 2-2v-4zm0-10l-1.41-1.41L17 20.17V2h-2v18.17l-7.59-7.58L6 14l10 10l10-10z"></path></svg>
					80
				
	
				<span class="px-1.5 text-gray-300 dark:text-gray-500">â€¢ </span>
					<svg class="flex-none w-3 text-gray-400 mr-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" fill="currentColor"><path d="M22.45,6a5.47,5.47,0,0,1,3.91,1.64,5.7,5.7,0,0,1,0,8L16,26.13,5.64,15.64a5.7,5.7,0,0,1,0-8,5.48,5.48,0,0,1,7.82,0L16,10.24l2.53-2.58A5.44,5.44,0,0,1,22.45,6m0-2a7.47,7.47,0,0,0-5.34,2.24L16,7.36,14.89,6.24a7.49,7.49,0,0,0-10.68,0,7.72,7.72,0,0,0,0,10.82L16,29,27.79,17.06a7.72,7.72,0,0,0,0-10.82A7.49,7.49,0,0,0,22.45,4Z"></path></svg>
					1

				</div></div>
		
	</a></article>
							</div><div class=""><article class="overview-card-wrapper group/repo  "><a class="flex items-center justify-between gap-4 p-2" href="/kailasps/GPT2-codeparrot"><div class="w-full truncate"><header class="flex items-center mb-1" title="kailasps/GPT2-codeparrot"><img alt="" class="w-3 h-3 rounded-full mr-1.5 flex-none flex-none" src="https://cdn-avatars.huggingface.co/v1/production/uploads/65c523f8ea9e93984ae2da6f/N2TulZuHHCgWLFO7Z2vIU.jpeg" crossorigin="anonymous">
				<h4 class="text-md truncate font-mono text-black dark:group-hover/repo:text-yellow-500 group-hover/repo:text-indigo-600 text-sm">kailasps/GPT2-codeparrot</h4>
				
				</header>
			<div class="mr-1 flex items-center overflow-hidden whitespace-nowrap text-sm leading-tight text-gray-400"><svg class="mr-1.5 text-[.8rem] flex-none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 18 18"><path d="M16.2607 8.08202L14.468 6.28928C14.3063 6.12804 14.0873 6.03749 13.859 6.03749C13.6307 6.03749 13.4117 6.12804 13.25 6.28928L5.6375 13.904V16.9125H8.64607L16.2607 9.30002C16.422 9.13836 16.5125 8.91935 16.5125 8.69102C16.5125 8.4627 16.422 8.24369 16.2607 8.08202V8.08202ZM8.1953 15.825H6.725V14.3547L11.858 9.22118L13.3288 10.6915L8.1953 15.825ZM14.0982 9.92262L12.6279 8.45232L13.8606 7.21964L15.3309 8.68994L14.0982 9.92262Z"></path><path d="M6.18125 9.84373H7.26875V6.03748H8.9V4.94998H4.55V6.03748H6.18125V9.84373Z"></path><path d="M4.55 11.475H2.375V2.775H11.075V4.95H12.1625V2.775C12.1625 2.48658 12.0479 2.20997 11.844 2.00602C11.64 1.80208 11.3634 1.6875 11.075 1.6875H2.375C2.08658 1.6875 1.80997 1.80208 1.60602 2.00602C1.40207 2.20997 1.2875 2.48658 1.2875 2.775V11.475C1.2875 11.7634 1.40207 12.04 1.60602 12.244C1.80997 12.4479 2.08658 12.5625 2.375 12.5625H4.55V11.475Z"></path></svg>
			Text Generation
			<span class="px-1.5 text-gray-300 dark:text-gray-500">â€¢ </span>
	
				<span class="truncate">Updated
					<time datetime="2024-07-19T04:07:19" title="Fri, 19 Jul 2024 04:07:19 GMT">Jul 19, 2024</time></span>
				
				<span class="px-1.5 text-gray-300 dark:text-gray-500">â€¢ </span>
					<svg class="flex-none w-3 text-gray-400 mr-0.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" viewBox="0 0 32 32"><path fill="currentColor" d="M26 24v4H6v-4H4v4a2 2 0 0 0 2 2h20a2 2 0 0 0 2-2v-4zm0-10l-1.41-1.41L17 20.17V2h-2v18.17l-7.59-7.58L6 14l10 10l10-10z"></path></svg>
					71
				
	
				

				</div></div>
		
	</a></article>
							</div>
						</div>
				

				
				<div class="divider-column-vertical md:hidden"></div></section></div></main>

	<footer class="b-12 mb-2 flex border-t border-gray-100 md:h-14"><nav class="container relative flex flex-col justify-between space-y-2 py-6 text-gray-500 max-md:*:self-start md:flex-row md:items-center md:space-y-0 md:py-0 md:text-sm"><div class="SVELTE_HYDRATER contents" data-target="ThemeSwitcher" data-props="{&quot;theme&quot;:&quot;system&quot;,&quot;isLoggedIn&quot;:false,&quot;menuClassNames&quot;:&quot;md:-top-24&quot;,&quot;classNames&quot;:&quot;max-md:mb-5 max-md:*:self-start&quot;}">
<div class="relative inline-block max-md:mb-5 max-md:*:self-start">
	<button class="rounded-full border border-gray-100 pl-2 py-1 pr-2.5  flex items-center text-sm text-gray-500 bg-white hover:bg-purple-50 hover:border-purple-200 dark:hover:bg-gray-800 dark:hover:border-gray-950 dark:border-gray-800 " type="button">
		<svg class="mr-1.5 text-gray-500" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M29 25H3a1 1 0 1 0 0 2h26a1 1 0 1 0 0-2Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6 22.5h20a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v13.5a2 2 0 0 0 2 2ZM7 7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H7Z" fill="currentColor"></path><path d="M6 8a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8Z" fill="currentColor" fill-opacity=".4"></path><path d="M29 25H3a1 1 0 1 0 0 2h26a1 1 0 1 0 0-2Z" fill="currentColor"></path></svg>
			System theme
		</button>
	
	
	</div></div>
		<div class="font-semibold text-black md:hidden">Company</div>
		<a class="hover:underline" href="/terms-of-service">TOS</a>
		<a class="hover:underline" href="/privacy">Privacy</a>
		<a class="hover:underline" href="/huggingface">About</a>
		<a class="hover:underline" href="https://apply.workable.com/huggingface/">Jobs</a>
		<a href="/" class="max-md:mb-4! max-md:mt-8! group flex-none max-md:order-last"><svg class="h-7 w-7 transition-transform group-hover:-translate-y-px" viewBox="0 0 95 88" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M47.2119 76.5C66.4037 76.5 81.9619 60.9419 81.9619 41.75C81.9619 22.5581 66.4037 7 47.2119 7C28.02 7 12.4619 22.5581 12.4619 41.75C12.4619 60.9419 28.02 76.5 47.2119 76.5Z" fill="#FFD21E"></path><path d="M81.9619 41.75C81.9619 22.5581 66.4037 7 47.2119 7C28.02 7 12.4619 22.5581 12.4619 41.75C12.4619 60.9419 28.02 76.5 47.2119 76.5C66.4037 76.5 81.9619 60.9419 81.9619 41.75ZM8.46185 41.75C8.46185 20.349 25.8108 3 47.2119 3C68.6129 3 85.9619 20.349 85.9619 41.75C85.9619 63.151 68.6129 80.5 47.2119 80.5C25.8108 80.5 8.46185 63.151 8.46185 41.75Z" fill="#FF9D0B"></path><path d="M58.5024 32.2915C59.7768 32.7415 60.2839 35.3615 61.5713 34.6769C64.0095 33.3805 64.9351 30.353 63.6387 27.9148C62.3423 25.4767 59.3148 24.5511 56.8766 25.8475C54.4384 27.1439 53.5128 30.1714 54.8092 32.6096C55.4211 33.7604 57.3632 31.8892 58.5024 32.2915Z" fill="#3A3B45"></path><path d="M34.9454 32.2915C33.671 32.7415 33.164 35.3615 31.8766 34.6769C29.4384 33.3805 28.5128 30.353 29.8092 27.9148C31.1056 25.4767 34.1331 24.5511 36.5713 25.8475C39.0095 27.1439 39.9351 30.1714 38.6387 32.6096C38.0268 33.7604 36.0846 31.8892 34.9454 32.2915Z" fill="#3A3B45"></path><path d="M46.9619 56.289C56.7903 56.289 59.9619 47.5261 59.9619 43.0262C59.9619 40.6875 58.3898 41.4236 55.8718 42.6702C53.5449 43.8222 50.4102 45.4101 46.9619 45.4101C39.7822 45.4101 33.9619 38.5263 33.9619 43.0262C33.9619 47.5261 37.1334 56.289 46.9619 56.289Z" fill="#3A3B45"></path><mask id="mask0" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="33" y="41" width="27" height="16"><path d="M46.9619 56.289C56.7903 56.289 59.9619 47.5261 59.9619 43.0262C59.9619 40.6875 58.3898 41.4236 55.8718 42.6702C53.5449 43.8222 50.4102 45.4101 46.9619 45.4101C39.7822 45.4101 33.9619 38.5263 33.9619 43.0262C33.9619 47.5261 37.1334 56.289 46.9619 56.289Z" fill="white"></path></mask><g mask="url(#mask0)"><path d="M47.2119 66.5C52.0018 66.5 55.8848 62.617 55.8848 57.8271C55.8848 54.0962 53.5291 50.9156 50.224 49.6915C50.1023 49.6464 49.9794 49.604 49.8553 49.5643C49.0219 49.2979 48.1337 52.1623 47.2119 52.1623C46.3506 52.1623 45.5186 49.2797 44.7332 49.5135C41.151 50.5799 38.5389 53.8984 38.5389 57.8271C38.5389 62.617 42.4219 66.5 47.2119 66.5Z" fill="#F94040"></path></g><path d="M70.7119 37C72.5068 37 73.9619 35.5449 73.9619 33.75C73.9619 31.9551 72.5068 30.5 70.7119 30.5C68.9169 30.5 67.4619 31.9551 67.4619 33.75C67.4619 35.5449 68.9169 37 70.7119 37Z" fill="#FF9D0B"></path><path d="M24.2119 37C26.0068 37 27.4619 35.5449 27.4619 33.75C27.4619 31.9551 26.0068 30.5 24.2119 30.5C22.4169 30.5 20.9619 31.9551 20.9619 33.75C20.9619 35.5449 22.4169 37 24.2119 37Z" fill="#FF9D0B"></path><path class="origin-bottom-right transition-transform group-hover:-rotate-6" d="M17.5238 48C15.9048 48 14.4578 48.665 13.4488 49.871C12.8248 50.618 12.1728 51.822 12.1198 53.625C11.4408 53.43 10.7878 53.321 10.1778 53.321C8.6278 53.321 7.2278 53.915 6.2378 54.994C4.9658 56.379 4.4008 58.081 4.6468 59.784C4.7638 60.595 5.0348 61.322 5.4398 61.995C4.5858 62.686 3.9568 63.648 3.6528 64.805C3.4148 65.712 3.1708 67.601 4.4448 69.547C4.3638 69.674 4.2878 69.806 4.2168 69.941C3.4508 71.395 3.4018 73.038 4.0778 74.568C5.1028 76.887 7.6498 78.714 12.5958 80.675C15.6728 81.895 18.4878 82.675 18.5128 82.682C22.5808 83.737 26.2598 84.273 29.4448 84.273C35.2988 84.273 39.4898 82.48 41.9018 78.944C45.7838 73.25 45.2288 68.042 40.2058 63.022C37.4258 60.244 35.5778 56.148 35.1928 55.249C34.4168 52.587 32.3648 49.628 28.9538 49.628H28.9528C28.6658 49.628 28.3758 49.651 28.0898 49.696C26.5958 49.931 25.2898 50.791 24.3568 52.085C23.3498 50.833 22.3718 49.837 21.4868 49.275C20.1528 48.429 18.8198 48 17.5238 48ZM17.5238 52C18.0338 52 18.6568 52.217 19.3438 52.653C21.4768 54.006 25.5928 61.081 27.0998 63.833C27.6048 64.755 28.4678 65.145 29.2448 65.145C30.7868 65.145 31.9908 63.612 29.3858 61.664C25.4688 58.733 26.8428 53.942 28.7128 53.647C28.7948 53.634 28.8758 53.628 28.9538 53.628C30.6538 53.628 31.4038 56.558 31.4038 56.558C31.4038 56.558 33.6018 62.078 37.3778 65.851C41.1538 69.625 41.3488 72.654 38.5968 76.69C36.7198 79.442 33.1268 80.273 29.4448 80.273C25.6258 80.273 21.7108 79.379 19.5168 78.81C19.4088 78.782 6.0658 75.013 7.7558 71.805C8.0398 71.266 8.5078 71.05 9.0968 71.05C11.4768 71.05 15.8058 74.592 17.6668 74.592C18.0828 74.592 18.3758 74.415 18.4958 73.983C19.2888 71.138 6.4388 69.942 7.5218 65.821C7.7128 65.092 8.2308 64.796 8.9588 64.797C12.1038 64.797 19.1598 70.328 20.6388 70.328C20.7518 70.328 20.8328 70.295 20.8768 70.225C21.6178 69.029 21.2118 68.194 15.9888 65.033C10.7658 61.871 7.0998 59.969 9.1848 57.699C9.4248 57.437 9.7648 57.321 10.1778 57.321C13.3488 57.322 20.8408 64.14 20.8408 64.14C20.8408 64.14 22.8628 66.243 24.0858 66.243C24.3668 66.243 24.6058 66.132 24.7678 65.858C25.6348 64.396 16.7148 57.636 16.2118 54.847C15.8708 52.957 16.4508 52 17.5238 52Z" fill="#FF9D0B"></path><path class="origin-bottom-right transition-transform group-hover:-rotate-6" d="M38.5967 76.6898C41.3487 72.6538 41.1537 69.6248 37.3777 65.8508C33.6017 62.0778 31.4037 56.5578 31.4037 56.5578C31.4037 56.5578 30.5827 53.3518 28.7127 53.6468C26.8427 53.9418 25.4697 58.7328 29.3867 61.6638C33.3037 64.5938 28.6067 66.5848 27.0997 63.8328C25.5927 61.0808 21.4777 54.0058 19.3437 52.6528C17.2107 51.2998 15.7087 52.0578 16.2117 54.8468C16.7147 57.6358 25.6357 64.3958 24.7677 65.8588C23.8997 67.3208 20.8407 64.1398 20.8407 64.1398C20.8407 64.1398 11.2687 55.4288 9.18465 57.6988C7.10065 59.9688 10.7657 61.8708 15.9887 65.0328C21.2127 68.1938 21.6177 69.0288 20.8767 70.2248C20.1347 71.4208 8.60465 61.6998 7.52165 65.8208C6.43965 69.9418 19.2887 71.1378 18.4957 73.9828C17.7027 76.8288 9.44465 68.5978 7.75565 71.8048C6.06565 75.0128 19.4087 78.7818 19.5167 78.8098C23.8267 79.9278 34.7727 82.2968 38.5967 76.6898Z" fill="#FFD21E"></path><path class="origin-bottom-left transition-transform group-hover:rotate-6" d="M77.3999 48C79.0189 48 80.4659 48.665 81.4749 49.871C82.0989 50.618 82.7509 51.822 82.8039 53.625C83.4829 53.43 84.1359 53.321 84.7459 53.321C86.2959 53.321 87.6959 53.915 88.6859 54.994C89.9579 56.379 90.5229 58.081 90.2769 59.784C90.1599 60.595 89.8889 61.322 89.4839 61.995C90.3379 62.686 90.9669 63.648 91.2709 64.805C91.5089 65.712 91.7529 67.601 90.4789 69.547C90.5599 69.674 90.6359 69.806 90.7069 69.941C91.4729 71.395 91.5219 73.038 90.8459 74.568C89.8209 76.887 87.2739 78.714 82.3279 80.675C79.2509 81.895 76.4359 82.675 76.4109 82.682C72.3429 83.737 68.6639 84.273 65.4789 84.273C59.6249 84.273 55.4339 82.48 53.0219 78.944C49.1399 73.25 49.6949 68.042 54.7179 63.022C57.4979 60.244 59.3459 56.148 59.7309 55.249C60.5069 52.587 62.5589 49.628 65.9699 49.628H65.9709C66.2579 49.628 66.5479 49.651 66.8339 49.696C68.3279 49.931 69.6339 50.791 70.5669 52.085C71.5739 50.833 72.5519 49.837 73.4369 49.275C74.7709 48.429 76.1039 48 77.3999 48ZM77.3999 52C76.8899 52 76.2669 52.217 75.5799 52.653C73.4469 54.006 69.3309 61.081 67.8239 63.833C67.3189 64.755 66.4559 65.145 65.6789 65.145C64.1369 65.145 62.9329 63.612 65.5379 61.664C69.4549 58.733 68.0809 53.942 66.2109 53.647C66.1289 53.634 66.0479 53.628 65.9699 53.628C64.2699 53.628 63.5199 56.558 63.5199 56.558C63.5199 56.558 61.3219 62.078 57.5459 65.851C53.7699 69.625 53.5749 72.654 56.3269 76.69C58.2039 79.442 61.7969 80.273 65.4789 80.273C69.2979 80.273 73.2129 79.379 75.4069 78.81C75.5149 78.782 88.8579 75.013 87.1679 71.805C86.8839 71.266 86.4159 71.05 85.8269 71.05C83.4469 71.05 79.1179 74.592 77.2569 74.592C76.8409 74.592 76.5479 74.415 76.4279 73.983C75.6349 71.138 88.4849 69.942 87.4019 65.821C87.2109 65.092 86.6929 64.796 85.9649 64.797C82.8199 64.797 75.7639 70.328 74.2849 70.328C74.1719 70.328 74.0909 70.295 74.0469 70.225C73.3059 69.029 73.7119 68.194 78.9349 65.033C84.1579 61.871 87.8239 59.969 85.7389 57.699C85.4989 57.437 85.1589 57.321 84.7459 57.321C81.5749 57.322 74.0829 64.14 74.0829 64.14C74.0829 64.14 72.0609 66.243 70.8379 66.243C70.5569 66.243 70.3179 66.132 70.1559 65.858C69.2889 64.396 78.2089 57.636 78.7119 54.847C79.0529 52.957 78.4729 52 77.3999 52Z" fill="#FF9D0B"></path><path class="origin-bottom-left transition-transform group-hover:rotate-6" d="M56.3271 76.6898C53.5751 72.6538 53.7701 69.6248 57.5461 65.8508C61.3221 62.0778 63.5201 56.5578 63.5201 56.5578C63.5201 56.5578 64.3411 53.3518 66.2111 53.6468C68.0811 53.9418 69.4541 58.7328 65.5371 61.6638C61.6201 64.5938 66.3171 66.5848 67.8241 63.8328C69.3311 61.0808 73.4461 54.0058 75.5801 52.6528C77.7131 51.2998 79.2151 52.0578 78.7121 54.8468C78.2091 57.6358 69.2881 64.3958 70.1561 65.8588C71.0241 67.3208 74.0831 64.1398 74.0831 64.1398C74.0831 64.1398 83.6551 55.4288 85.7391 57.6988C87.8231 59.9688 84.1581 61.8708 78.9351 65.0328C73.7111 68.1938 73.3061 69.0288 74.0471 70.2248C74.7891 71.4208 86.3191 61.6998 87.4021 65.8208C88.4841 69.9418 75.6351 71.1378 76.4281 73.9828C77.2211 76.8288 85.4791 68.5978 87.1681 71.8048C88.8581 75.0128 75.5151 78.7818 75.4071 78.8098C71.0971 79.9278 60.1511 82.2968 56.3271 76.6898Z" fill="#FFD21E"></path></svg></a>
		<div class="max-md:mt-8! font-semibold text-black md:hidden">Website</div>

		<a class="hover:underline" href="/models">Models</a>
		<a class="hover:underline" href="/datasets">Datasets</a>
		<a class="hover:underline" href="/spaces">Spaces</a>
		<a class="hover:underline" href="/pricing">Pricing</a>
		<a class="hover:underline" href="/docs">Docs</a></nav></footer></div>

		<script>
			import("\/front\/build\/kube-68d7aa0\/index.js");
			window.moonSha = "kube-68d7aa0\/";
			window.__hf_deferred = {};
		</script>

		<!-- Stripe -->
		<script>
			if (["hf.co", "huggingface.co"].includes(window.location.hostname)) {
				const script = document.createElement("script");
				script.src = "https://js.stripe.com/v3/";
				script.async = true;
				document.head.appendChild(script);
			}
		</script>
	</body>
</html>
